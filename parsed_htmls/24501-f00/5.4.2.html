<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>3GPP TS 24.501</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"DengXian Light";}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"MS PGothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Geneva;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@Malgun Gothic";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-70.9pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.05pt;
	text-indent:-85.05pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:99.25pt;
	text-indent:-99.25pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:99.25pt;
	text-indent:-99.25pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoIndex2, li.MsoIndex2, div.MsoIndex2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:14.2pt;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:6.0pt;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:28.35pt;
	margin-bottom:.0001pt;
	text-indent:-28.35pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:42.55pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:56.7pt;
	margin-bottom:.0001pt;
	text-indent:-56.7pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:70.9pt;
	margin-bottom:.0001pt;
	text-indent:-70.9pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:85.05pt;
	margin-bottom:.0001pt;
	text-indent:-85.05pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:99.25pt;
	margin-bottom:.0001pt;
	text-indent:-99.25pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:113.4pt;
	margin-bottom:.0001pt;
	text-indent:-113.4pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:9.0pt;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:134.65pt;
	margin-bottom:.0001pt;
	text-indent:-134.65pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:9.0pt;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:70.9pt;
	margin-bottom:.0001pt;
	text-indent:-70.9pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-link:"Footnote Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:22.7pt;
	margin-bottom:.0001pt;
	text-indent:-22.7pt;
	font-size:8.0pt;
	font-family:"Times New Roman",serif;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;
	font-style:italic;}
p.MsoIndexHeading, li.MsoIndexHeading, div.MsoIndexHeading
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:13.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;
	font-style:italic;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
span.MsoFootnoteReference
	{position:relative;
	top:-3.0pt;
	font-weight:bold;}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListNumber, li.MsoListNumber, div.MsoListNumber
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList2, li.MsoList2, div.MsoList2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList3, li.MsoList3, div.MsoList3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList4, li.MsoList4, div.MsoList4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList5, li.MsoList5, div.MsoList5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet3, li.MsoListBullet3, div.MsoListBullet3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet4, li.MsoListBullet4, div.MsoListBullet4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet5, li.MsoListBullet5, div.MsoListBullet5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListNumber2, li.MsoListNumber2, div.MsoListNumber2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-link:"Body Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-link:"Document Map Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	background:navy;
	font-size:10.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-link:"Plain Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoRMPane, li.MsoRMPane, div.MsoRMPane
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Cambria",serif;
	color:#365F91;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Arial",sans-serif;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Arial",sans-serif;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Arial",sans-serif;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Arial",sans-serif;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Arial",sans-serif;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Arial",sans-serif;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Arial",sans-serif;}
p.EQ, li.EQ, div.EQ
	{mso-style-name:EQ;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.ZGSM
	{mso-style-name:ZGSM;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZD, li.ZD, div.ZD
	{mso-style-name:ZD;
	margin:0in;
	margin-bottom:.0001pt;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Arial",sans-serif;
	font-weight:bold;
	font-style:italic;}
p.TT, li.TT, div.TT
	{mso-style-name:TT;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;}
p.NF, li.NF, div.NF
	{mso-style-name:NF;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:56.75pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.NO, li.NO, div.NO
	{mso-style-name:NO;
	mso-style-link:"NO Zchn";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.NOZchn
	{mso-style-name:"NO Zchn";
	mso-style-link:NO;}
p.PL, li.PL, div.PL
	{mso-style-name:PL;
	mso-style-link:"PL Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Courier New";}
span.PLChar
	{mso-style-name:"PL Char";
	mso-style-link:PL;
	font-family:"Courier New";}
p.TAR, li.TAR, div.TAR
	{mso-style-name:TAR;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.TAL, li.TAL, div.TAL
	{mso-style-name:TAL;
	mso-style-link:"TAL Char";
	margin:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
span.TALChar
	{mso-style-name:"TAL Char";
	mso-style-link:TAL;
	font-family:"Arial",sans-serif;}
p.TAH, li.TAH, div.TAH
	{mso-style-name:TAH;
	mso-style-link:"TAH Car";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.TAC, li.TAC, div.TAC
	{mso-style-name:TAC;
	mso-style-link:"TAC Char";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
span.TACChar
	{mso-style-name:"TAC Char";
	mso-style-link:TAC;
	font-family:"Arial",sans-serif;}
span.TAHCar
	{mso-style-name:"TAH Car";
	mso-style-link:TAH;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.LD, li.LD, div.LD
	{mso-style-name:LD;
	margin:0in;
	margin-bottom:.0001pt;
	line-height:9.0pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Courier New";}
p.EX, li.EX, div.EX
	{mso-style-name:EX;
	mso-style-link:"EX Car";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-70.9pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.EXCar
	{mso-style-name:"EX Car";
	mso-style-link:EX;}
p.FP, li.FP, div.FP
	{mso-style-name:FP;
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.NW, li.NW, div.NW
	{mso-style-name:NW;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:56.75pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.EW, li.EW, div.EW
	{mso-style-name:EW;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:85.1pt;
	margin-bottom:.0001pt;
	text-indent:-70.9pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.B1, li.B1, div.B1
	{mso-style-name:B1;
	mso-style-link:"B1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.B1Char
	{mso-style-name:"B1 Char";
	mso-style-link:B1;}
p.EditorsNote, li.EditorsNote, div.EditorsNote
	{mso-style-name:"Editor\0027s Note\,EN";
	mso-style-link:"Editor\0027s Note Char\,EN Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	color:red;}
span.EditorsNoteChar
	{mso-style-name:"Editor\0027s Note Char\,EN Char";
	mso-style-link:"Editor\0027s Note\,EN";
	color:red;}
p.TH, li.TH, div.TH
	{mso-style-name:TH;
	mso-style-link:"TH Char";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
span.THChar
	{mso-style-name:"TH Char";
	mso-style-link:TH;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZA, li.ZA, div.ZA
	{mso-style-name:ZA;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	border:none;
	padding:0in;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.ZB, li.ZB, div.ZB
	{mso-style-name:ZB;
	margin-top:0in;
	margin-right:1.4pt;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-style:italic;}
p.ZT, li.ZT, div.ZT
	{mso-style-name:ZT;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:17.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZU, li.ZU, div.ZU
	{mso-style-name:ZU;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.TAN, li.TAN, div.TAN
	{mso-style-name:TAN;
	mso-style-link:"TAN Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:42.55pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
span.TANChar
	{mso-style-name:"TAN Char";
	mso-style-link:TAN;
	font-family:"Arial",sans-serif;}
p.ZH, li.ZH, div.ZH
	{mso-style-name:ZH;
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.TF, li.TF, div.TF
	{mso-style-name:TF;
	mso-style-link:"TF Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
span.TFChar
	{mso-style-name:"TF Char";
	mso-style-link:TF;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZG, li.ZG, div.ZG
	{mso-style-name:ZG;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.B2, li.B2, div.B2
	{mso-style-name:B2;
	mso-style-link:"B2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.B2Char
	{mso-style-name:"B2 Char";
	mso-style-link:B2;}
p.B3, li.B3, div.B3
	{mso-style-name:B3;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.B4, li.B4, div.B4
	{mso-style-name:B4;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.B5, li.B5, div.B5
	{mso-style-name:B5;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.ZTD, li.ZTD, div.ZTD
	{mso-style-name:ZTD;
	margin-top:0in;
	margin-right:1.4pt;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.ZV, li.ZV, div.ZV
	{mso-style-name:ZV;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.TAJ, li.TAJ, div.TAJ
	{mso-style-name:TAJ;
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.Guidance, li.Guidance, div.Guidance
	{mso-style-name:Guidance;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	color:blue;
	font-style:italic;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma",sans-serif;}
span.FootnoteTextChar
	{mso-style-name:"Footnote Text Char";
	mso-style-link:"Footnote Text";
	font-family:"Times New Roman",serif;}
p.INDENT1, li.INDENT1, div.INDENT1
	{mso-style-name:INDENT1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.INDENT2, li.INDENT2, div.INDENT2
	{mso-style-name:INDENT2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.INDENT3, li.INDENT3, div.INDENT3
	{mso-style-name:INDENT3;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.05pt;
	text-indent:-28.35pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.FigureTitle, li.FigureTitle, div.FigureTitle
	{mso-style-name:Figure_Title;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:24.0pt;
	margin-left:0in;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.CouvRecTitle, li.CouvRecTitle, div.CouvRecTitle
	{mso-style-name:"Couv Rec Title";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
span.DocumentMapChar
	{mso-style-name:"Document Map Char";
	mso-style-link:"Document Map";
	font-family:"Tahoma",sans-serif;
	background:navy;}
span.PlainTextChar
	{mso-style-name:"Plain Text Char";
	mso-style-link:"Plain Text";
	font-family:"Courier New";}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-link:"Body Text";
	font-family:"Times New Roman",serif;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";
	font-family:"Times New Roman",serif;}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.H6, li.H6, div.H6
	{mso-style-name:H6;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:99.25pt;
	text-indent:-99.25pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
 /* Page Definitions */
 @page WordSection1
	{size:595.35pt 842.0pt;
	margin:113.4pt 42.55pt 538.65pt 42.55pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.35pt 842.0pt;
	margin:70.8pt 56.65pt 56.65pt 56.65pt;}
div.WordSection2
	{page:WordSection2;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:14.2pt'>
<h3><a name="_Toc516843101"><span lang=EN-GB>5.4.2      Security mode control
procedure</span></a></h3><h4><a name="_Toc516843102"><span lang=EN-GB>5.4.2.1          General</span></a></h4><p class=MsoNormal><span lang=EN-GB>The purpose of the NAS security mode
control procedure is to take a 5G NAS security context into use, and initialise
and start NAS signalling security between the UE and the AMF with the corresponding
5G NAS keys and 5G NAS security algorithms.</span></p><p class=MsoNormal><span lang=EN-GB>Furthermore, the </span><span lang=EN-GB>network
may also initiate the security mode control procedure in the following cases:</span></p><p class=B1><span lang=EN-GB>a)- in order to change the 5G NAS security
algorithms for a current 5G NAS security context already in use; and</span></p><p class=B1><span lang=EN-GB>b)  in order to change the value of uplink NAS
COUNT used in the latest SECURITY MODE COMPLETE message as described in
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24],&nbsp;subclause&nbsp;6.9.4.4.</span></p><p class=MsoNormal><span lang=EN-GB>For restrictions concerning the concurrent
running of a </span><span lang=EN-GB>security mode control</span><span
lang=EN-GB> procedure with other security related procedures in the AS or
inside the core network see 3GPP&nbsp;TS&nbsp;33.501&nbsp;</span>[24], subclause<span
lang=EN-GB>&nbsp;6.9.5.</span></p><h4><a name="_Toc516843103"><span lang=EN-GB>5.4.2.2          NAS security mode
control initiation by the network</span></a></h4><p class=MsoNormal><span lang=EN-GB>The AMF initiates the NAS security mode
control procedure by sending a SECURITY MODE COMMAND message to the UE and
starting timer T3560 (see example in figure&nbsp;5.4.2.2).</span></p><p class=MsoNormal><span lang=EN-GB>The AMF shall reset the downlink NAS COUNT
counter and use it to integrity protect the initial SECURITY MODE COMMAND
message if the security mode control procedure is initiated:</span></p><p class=B1><span lang=EN-GB>a)   to take into use the security context created
after a successful execution of the 5G AKA based primary authentication and key
agreement procedure or the EAP based primary authentication and key agreement
procedure; or</span></p><p class=B1><span lang=EN-GB>b)  upon receipt of REGISTRATION REQUEST message,
if the AMF wants to create a mapped 5G NAS security context (i.e. the type of
security context flag is set to &quot;mapped security context&quot; in the NAS
key set identifier IE included in the SECURITY MODE COMMAND message).</span></p><p class=MsoNormal><span lang=EN-GB>The AMF shall send the SECURITY MODE
COMMAND message unciphered, but shall integrity protect the message with the 5G
NAS integrity key based on K<sub>AMF</sub> or mapped K'<sub>AMF</sub> indicated
by the ngKSI included in the message. The AMF shall set the security header
type of the message to &quot;integrity protected with new 5G NAS security
context&quot;.</span></p><p class=EditorsNote><span lang=EN-GB>Editor</span>'<span lang=EN-GB>s note: Handling
at emergency registration and emergency PDU sessions is FFS.</span></p><p class=MsoNormal><span lang=EN-GB>Upon receipt of a REGISTRATION REQUEST
message, if the AMF does not have the valid current 5G NAS security context
indicated by the UE, the AMF shall indicate the use of the new mapped 5G NAS security
context to the UE by setting the type of security context flag</span><span
lang=EN-GB> in the </span><span lang=EN-GB>NAS key set identifier</span><span
lang=EN-GB> IE</span><span lang=EN-GB> to &quot;mapped security context&quot;
and the KSI value related to the security context of the source system.</span></p><p class=EditorsNote><span lang=EN-GB>Editor</span>'<span lang=EN-GB>s note: Handling
at non-existing 5G NAS security context indicated by the UE when an emergency
PDU session exists is FFS.</span></p><p class=MsoNormal><span lang=EN-GB>While having a </span><span lang=EN-GB>current
mapped 5G</span><span lang=EN-GB> NAS security context with the UE, if the AMF wants
to take the native 5G NAS security context into use, the AMF shall include the ngKSI
that indicates the native 5G NAS security context in the SECURITY MODE COMMAND
message.</span></p><p class=MsoNormal><span lang=EN-GB>The AMF shall include the replayed security
capabilities of the UE (including the security capabilities with regard to NAS,
RRC and UP (user plane) ciphering as well as NAS and RRC integrity, and other
possible target network security capabilities, i.e. E-UTRAN if the UE included
them in the message to network) and if the UE included it in the message to the
network, the selected 5GS ciphering and integrity algorithms and the ngKSI.</span></p><p class=MsoNormal><span lang=EN-GB>If the UE is connected to the same AMF and the
same PLMN through both 3GPP access and non 3GPP access, then after the UE
performs the authentication procedure over:</span></p><p class=B1><span lang=EN-GB>a)   the 3GPP access, the AMF may include the
ngKSI in the SECURITY MODE COMMAND message identifying the 5GS NAS security
context currently used over the non-3GPP access; and</span></p><p class=B1><span lang=EN-GB>b)  the non 3GPP access, the AMF may include the
ngKSI in the SECURITY MODE COMMAND message identifying the 5GS NAS security
context currently used over the 3GPP access.</span></p><p class=MsoNormal><span lang=EN-GB>The AMF may initiate a SECURITY MODE
COMMAND in order to change the 5G security algorithms for a current 5G NAS security
context already in use. The AMF re-derives the 5G NAS keys from </span><span
lang=EN-GB>K<sub>AMF</sub></span><span lang=EN-GB> with the new 5G algorithm
identities as input and provides the new 5GS algorithm identities within the
SECURITY MODE COMMAND message. </span><span lang=EN-GB>The AMF shall set the
security header type of the message to &quot;integrity protected with new 5G NAS
security context&quot;.</span></p><p class=MsoNormal><span lang=EN-GB>If, during an ongoing registration
procedure, the AMF is initiating a SECURITY MODE COMMAND (i.e. after receiving
the REGISTRATION REQUEST message, but before sending a response to that
message) and the REGISTRATION REQUEST message does not successfully pass the
integrity check at the AMF, the AMF shall calculate the HASH<sub>AMF</sub> of
the entire plain REGISTRATION REQUEST message as described in </span><span
lang=EN-GB>3GPP&nbsp;TS&nbsp;33.501&nbsp;</span>[24]<span lang=EN-GB> and shall
include the HASH<sub>AMF</sub> in the SECURITY MODE COMMAND message.</span></p><p class=MsoNormal><span lang=EN-GB>Additionally, the AMF may request the UE to
include its IMEISV in the SECURITY MODE COMPLETE message.</span></p><p class=MsoNormal><span lang=EN-GB>If </span><span lang=EN-GB>the AMF does not
support interworking procedures without N26 interface</span><span lang=EN-GB> and
the UE </span><span lang=EN-GB>set the S1 mode bit to </span><span lang=EN-GB>&quot;S1
mode supported&quot; in the 5GMM capability IE of</span><span lang=EN-GB> </span><span
lang=EN-GB>the REGISTRATION REQUEST message, the AMF shall select ciphering and
integrity algorithms to be used in the EPS and indicate them to the UE via the Selected
EPS NAS security algorithms IE in the SECURITY MODE COMMAND message.</span></p><p class=NO><span lang=EN-GB>NOTE&nbsp;2:  The AS and NAS security capabilities
will be the same, i.e. if the UE supports one algorithm for NAS, the same
algorithm is also supported for AS.</span></p><p class=TH><span lang=EN-GB><img width=556 height=239
src="24501-f00_files/image010.png"></span></p><p class=TF><span lang=EN-GB>Figure&nbsp;5.4.2.2: Security mode control
procedure</span></p><h4><a name="_Toc516843104"><span lang=EN-GB>5.4.2.3          NAS security mode
command accepted by the UE</span></a></h4><p class=MsoNormal><span lang=EN-GB>Upon receipt of the SECURITY MODE COMMAND
message, the UE shall check whether the security mode command can be accepted
or not. This is done by performing the integrity check of the message and by
checking that the received replayed UE security capabilities have not been
altered compared to the latest values that the UE sent to the network.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's note: Handling at emergency PDU
sessions is FFS.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's note: Handling of &quot;null
algorithms&quot; is FFS.</span></p><p class=MsoNormal><span lang=EN-GB>If the type of security context flag
included in the SECURITY MODE COMMAND message is set to &quot;native security
context&quot; and if the KSI matches a valid non-current native 5G NAS security
context held in the UE while the UE has a mapped 5G NAS security context as the
current 5G NAS security context, the UE shall take the non-current native 5G NAS
security context into use which then becomes the current native 5G NAS security
context and delete the mapped 5G NAS security context.</span></p><p class=MsoNormal><span lang=EN-GB>If the SECURITY MODE COMMAND message can be
accepted, the UE shall take the 5G NAS security context indicated in the
message into use. The UE shall in addition reset the uplink NAS COUNT counter
if:</span></p><p class=B1><span lang=EN-GB>a)   the SECURITY MODE COMMAND message is received
in order to take a 5G NAS security context into use created after a successful
execution of the 5G AKA based primary authentication and key agreement procedure
or the EAP based primary authentication and key agreement procedure; or</span></p><p class=B1><span lang=EN-GB>b)  the SECURITY MODE COMMAND message received
includes the type of security context flag set to &quot;mapped security
context&quot; in the NAS key set identifier IE the ngKSI does not match the current
5G NAS security context, if it is a mapped 5G NAS security context.</span></p><p class=MsoNormal><span lang=EN-GB>If the SECURITY MODE COMMAND message can be
accepted and a new 5G NAS security context is taken into use and SECURITY MODE
COMMAND message does not indicate the &quot;null integrity protection
algorithm&quot;5G-IA0 as the selected NAS integrity algorithm, the UE shall:</span></p><p class=B1><span lang=EN-GB>-    if the SECURITY MODE COMMAND message has been
successfully integrity checked using an estimated downlink NAS COUNT equal to
0, then the UE shall set the downlink NAS COUNT of this new 5G NAS security
context to 0;</span></p><p class=B1><span lang=EN-GB>-    otherwise the UE shall set the downlink NAS
COUNT of this new 5G NAS security context to the downlink NAS COUNT that has
been used for the successful integrity checking of the SECURITY MODE COMMAND
message.</span></p><p class=MsoNormal><span lang=EN-GB>If the SECURITY MODE COMMAND message can be
accepted, the UE shall send a SECURITY MODE COMPLETE message integrity
protected with the selected 5GS integrity algorithm and the 5G NAS integrity
key based on the K<sub>AMF</sub> or mapped K'<sub>AMF</sub> if the type of
security context flag is set to &quot;mapped security context&quot; indicated
by the ngKSI. When the SECURITY MODE COMMAND message includes the type of
security context flag set to &quot;mapped security context&quot; in the NAS key
set identifier IE, then the UE shall check whether the SECURITY MODE COMMAND
message indicates the ngKSI of the current 5GS security context, if it is a
mapped 5G NAS security context, in order not to re-generate the K'<sub>AMF</sub>.</span></p><p class=MsoNormal><span lang=EN-GB>Furthermore, if the SECURITY MODE COMMAND message
can be accepted, the UE shall cipher the SECURITY MODE COMPLETE message with
the selected 5GS ciphering algorithm and the 5GS NAS ciphering key based on the
K<sub>AMF</sub> or mapped K'<sub>AMF</sub> indicated by the ngKSI. The UE shall
set the security header type of the message to &quot;integrity protected and
ciphered with new 5G NAS security context&quot;.</span></p><p class=MsoNormal><span lang=EN-GB>From this time onward the UE shall cipher
and integrity protect all NAS signalling messages with the selected 5GS
integrity and ciphering algorithms.</span></p><p class=MsoNormal><span lang=EN-GB>If the AMF indicated in the SECURITY MODE
COMMAND message that the IMEISV is requested, the UE shall include its IMEISV
in the SECURITY MODE COMPLETE message.</span></p><p class=MsoNormal><span lang=EN-GB>If, during an ongoing registration
procedure, the SECURITY MODE COMMAND message includes a HASH<sub>AMF</sub>, the
UE shall compare HASH<sub>AMF</sub> with a hash value locally calculated as
described in 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24] from the entire plain REGISTRATION
REQUEST message that the UE had sent to initiate the procedure. If HASH<sub>AMF</sub>
and the locally calculated hash value are different, the UE shall include the
complete REGISTRATION REQUEST message which the UE had previously sent in the Replayed
NAS message container IE of the SECURITY MODE COMPLETE message.</span></p><p class=MsoNormal><span lang=EN-GB>If, prior to receiving the SECURITY MODE
COMMAND message, the UE had sent an initial NAS message containing a limited
set of IEs needed to establish security context, the UE shall include the
complete initial message in the NAS SECURITY MODE COMPLETE message.</span></p><p class=MsoNormal><span lang=EN-GB>If the UE operating in the
single-registration mode receives the Selected EPS NAS security algorithms IE,
the UE shall use the IE according to 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24].</span></p><h4><a name="_Toc516843105"><span lang=EN-GB>5.4.2.4          NAS security mode
control completion by the network</span></a></h4><p class=MsoNormal><span lang=EN-GB>The AMF shall, upon receipt of the SECURITY
MODE COMPLETE message, stop timer T3560. From this time onward the AMF shall
integrity protect and encipher all signalling messages with the selected 5GS
integrity and ciphering algorithms.</span></p><p class=MsoNormal><span lang=EN-GB>If the SECURITY MODE COMPLETE message
contains a Replayed NAS container message IE with an REGISTRATION REQUEST
message, the AMF shall complete the ongoing registration procedure by
considering the REGISTRATION REQUEST message contained in the Replayed NAS
message container IE as the message that triggered the procedure.</span></p><h4><a name="_Toc516843106"><span lang=EN-GB>5.4.2.5          NAS security mode
command not accepted by the UE</span></a></h4><p class=MsoNormal><span lang=EN-GB>If the security mode command cannot be
accepted, the UE shall send a SECURITY MODE REJECT message. The SECURITY MODE
REJECT </span><span lang=EN-GB>message contains a 5GMM cause that typically
indicates one of the following cause values:</span></p><p class=B1><span lang=EN-GB>#23     UE security capabilities mismatch.</span></p><p class=B1><span lang=EN-GB>#24     security mode rejected, unspecified.</span></p><p class=MsoNormal><span lang=EN-GB>Upon receipt of the SECURITY MODE REJECT
message, the AMF shall stop timer T3560. The AMF shall also abort the ongoing
procedure that triggered the initiation of the NAS security mode control
procedure.</span></p><p class=MsoNormal><span lang=EN-GB>Both the UE and the AMF shall apply the 5G NAS
security context in use before the initiation of the security mode control
procedure, if any, to protect the SECURITY MODE REJECT message and any other
subsequent messages according to the rules in subclause&nbsp;4.4.4
and&nbsp;4.4.5.</span></p><h4><a name="_Toc516843107"><span lang=EN-GB>5.4.2.6          Abnormal cases in
the UE</span></a></h4><p class=MsoNormal><span lang=EN-GB>The following abnormal cases can be
identified:</span></p><p class=B1><span lang=EN-GB>a)   Transmission failure of SECURITY MODE
COMPLETE message or SECURITY MODE REJECT message indication from lower layers
(if the security mode control procedure is triggered by a registration procedure).</span></p><p class=B1><span lang=EN-GB>      The UE shall abort the security mode control
procedure and re-initiate the registration procedure.</span></p><p class=B1><span lang=EN-GB>b)  Transmission failure of SECURITY MODE COMPLETE
message or SECURITY MODE REJECT message indication with TAI change from lower
layers (if the security mode control procedure is triggered by a service
request procedure).</span></p><p class=B1><span lang=EN-GB>      If the current TAI is not in the TAI list,
the security mode control procedure shall be aborted and a registration procedure
shall be initiated.</span></p><p class=B1><span lang=EN-GB>      If the current TAI is still part of the TAI
list, the security mode control procedure shall be aborted and it is up to the
UE implementation how to re-run the ongoing procedure that triggered the
security mode control procedure.</span></p><p class=B1><span lang=EN-GB>c)   Transmission failure of SECURITY MODE
COMPLETE message or SECURITY MODE REJECT message indication without TAI change
from lower layers (if the security mode control procedure is triggered by a
service request procedure).</span></p><p class=B1><span lang=EN-GB>      The security mode control procedure shall be
aborted and it is up to the UE implementation how to re-run the ongoing
procedure that triggered the security mode control procedure.</span></p><h4><a name="_Toc516843108"><span lang=EN-GB>5.4.2.7          Abnormal cases on
the network side</span></a></h4><p class=MsoNormal><span lang=EN-GB>The following abnormal cases can be
identified:</span></p><p class=B1><span lang=EN-GB>a)   Lower layer failure before the SECURITY MODE
COMPLETE or SECURITY MODE REJECT message is received.</span></p><p class=B1><span lang=EN-GB>      The network shall abort the security mode
control procedure.</span></p><p class=B1><span lang=EN-GB>b)  Expiry of timer T3560.</span></p><p class=B1><span lang=EN-GB>      The network shall, on the first expiry of
the timer T3560, retransmit the SECURITY MODE COMMAND message and shall reset
and start timer T3560. This retransmission is repeated four times, i.e. on the
fifth expiry of timer T3560, the procedure shall be aborted.</span></p><p class=B1><span lang=EN-GB>c)   Collision between security mode control
procedure and registration, service request or de-registration procedure not
indicating switch off.</span></p><p class=B1><span lang=EN-GB>      The network shall abort the security mode
control procedure and proceed with the UE initiated procedure.</span></p><p class=B1><span lang=EN-GB>d)  Collision between security mode control
procedure and other 5GMM procedures than in item&nbsp;c.</span></p><p class=B1><span lang=EN-GB>      The network shall progress both procedures.</span></p><p class=B1><span lang=EN-GB>e)   Lower layers indication of non-delivered NAS
PDU due to handover:</span></p><p class=B1><span lang=EN-GB>      If the SECURITY MODE COMMAND message could
not be delivered due to an intra AMF handover and the target TA is included in
the TAI list, then upon successful completion of the intra AMF handover the AMF
shall retransmit the SECURITY MODE COMMAND message. If a failure of the
handover procedure is reported by the lower layer and the N1 signalling
connection exists, the AMF shall retransmit the SECURITY MODE COMMAND message.</span></p></body>
</html>