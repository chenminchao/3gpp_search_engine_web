<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>3GPP TS 24.501</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"DengXian Light";}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"MS PGothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Geneva;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@Malgun Gothic";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-70.9pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.05pt;
	text-indent:-85.05pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:99.25pt;
	text-indent:-99.25pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:99.25pt;
	text-indent:-99.25pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoIndex2, li.MsoIndex2, div.MsoIndex2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:14.2pt;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:6.0pt;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:28.35pt;
	margin-bottom:.0001pt;
	text-indent:-28.35pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:42.55pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:56.7pt;
	margin-bottom:.0001pt;
	text-indent:-56.7pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:70.9pt;
	margin-bottom:.0001pt;
	text-indent:-70.9pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:85.05pt;
	margin-bottom:.0001pt;
	text-indent:-85.05pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:99.25pt;
	margin-bottom:.0001pt;
	text-indent:-99.25pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:113.4pt;
	margin-bottom:.0001pt;
	text-indent:-113.4pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:9.0pt;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:134.65pt;
	margin-bottom:.0001pt;
	text-indent:-134.65pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:9.0pt;
	margin-right:21.25pt;
	margin-bottom:0in;
	margin-left:70.9pt;
	margin-bottom:.0001pt;
	text-indent:-70.9pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-link:"Footnote Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:22.7pt;
	margin-bottom:.0001pt;
	text-indent:-22.7pt;
	font-size:8.0pt;
	font-family:"Times New Roman",serif;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;
	font-style:italic;}
p.MsoIndexHeading, li.MsoIndexHeading, div.MsoIndexHeading
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:13.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;
	font-style:italic;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
span.MsoFootnoteReference
	{position:relative;
	top:-3.0pt;
	font-weight:bold;}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListNumber, li.MsoListNumber, div.MsoListNumber
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList2, li.MsoList2, div.MsoList2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList3, li.MsoList3, div.MsoList3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList4, li.MsoList4, div.MsoList4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoList5, li.MsoList5, div.MsoList5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet3, li.MsoListBullet3, div.MsoListBullet3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet4, li.MsoListBullet4, div.MsoListBullet4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListBullet5, li.MsoListBullet5, div.MsoListBullet5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListNumber2, li.MsoListNumber2, div.MsoListNumber2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-link:"Body Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-link:"Document Map Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	background:navy;
	font-size:10.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-link:"Plain Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoRMPane, li.MsoRMPane, div.MsoRMPane
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Cambria",serif;
	color:#365F91;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Arial",sans-serif;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Arial",sans-serif;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Arial",sans-serif;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Arial",sans-serif;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Arial",sans-serif;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Arial",sans-serif;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Arial",sans-serif;}
p.EQ, li.EQ, div.EQ
	{mso-style-name:EQ;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.ZGSM
	{mso-style-name:ZGSM;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZD, li.ZD, div.ZD
	{mso-style-name:ZD;
	margin:0in;
	margin-bottom:.0001pt;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Arial",sans-serif;
	font-weight:bold;
	font-style:italic;}
p.TT, li.TT, div.TT
	{mso-style-name:TT;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.7pt;
	text-indent:-56.7pt;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;}
p.NF, li.NF, div.NF
	{mso-style-name:NF;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:56.75pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.NO, li.NO, div.NO
	{mso-style-name:NO;
	mso-style-link:"NO Zchn";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.NOZchn
	{mso-style-name:"NO Zchn";
	mso-style-link:NO;}
p.PL, li.PL, div.PL
	{mso-style-name:PL;
	mso-style-link:"PL Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Courier New";}
span.PLChar
	{mso-style-name:"PL Char";
	mso-style-link:PL;
	font-family:"Courier New";}
p.TAR, li.TAR, div.TAR
	{mso-style-name:TAR;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.TAL, li.TAL, div.TAL
	{mso-style-name:TAL;
	mso-style-link:"TAL Char";
	margin:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
span.TALChar
	{mso-style-name:"TAL Char";
	mso-style-link:TAL;
	font-family:"Arial",sans-serif;}
p.TAH, li.TAH, div.TAH
	{mso-style-name:TAH;
	mso-style-link:"TAH Car";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.TAC, li.TAC, div.TAC
	{mso-style-name:TAC;
	mso-style-link:"TAC Char";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
span.TACChar
	{mso-style-name:"TAC Char";
	mso-style-link:TAC;
	font-family:"Arial",sans-serif;}
span.TAHCar
	{mso-style-name:"TAH Car";
	mso-style-link:TAH;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.LD, li.LD, div.LD
	{mso-style-name:LD;
	margin:0in;
	margin-bottom:.0001pt;
	line-height:9.0pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Courier New";}
p.EX, li.EX, div.EX
	{mso-style-name:EX;
	mso-style-link:"EX Car";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-70.9pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.EXCar
	{mso-style-name:"EX Car";
	mso-style-link:EX;}
p.FP, li.FP, div.FP
	{mso-style-name:FP;
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.NW, li.NW, div.NW
	{mso-style-name:NW;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:56.75pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.EW, li.EW, div.EW
	{mso-style-name:EW;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:85.1pt;
	margin-bottom:.0001pt;
	text-indent:-70.9pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.B1, li.B1, div.B1
	{mso-style-name:B1;
	mso-style-link:"B1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:28.4pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.B1Char
	{mso-style-name:"B1 Char";
	mso-style-link:B1;}
p.EditorsNote, li.EditorsNote, div.EditorsNote
	{mso-style-name:"Editor\0027s Note\,EN";
	mso-style-link:"Editor\0027s Note Char\,EN Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	color:red;}
span.EditorsNoteChar
	{mso-style-name:"Editor\0027s Note Char\,EN Char";
	mso-style-link:"Editor\0027s Note\,EN";
	color:red;}
p.TH, li.TH, div.TH
	{mso-style-name:TH;
	mso-style-link:"TH Char";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
span.THChar
	{mso-style-name:"TH Char";
	mso-style-link:TH;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZA, li.ZA, div.ZA
	{mso-style-name:ZA;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	border:none;
	padding:0in;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.ZB, li.ZB, div.ZB
	{mso-style-name:ZB;
	margin-top:0in;
	margin-right:1.4pt;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-style:italic;}
p.ZT, li.ZT, div.ZT
	{mso-style-name:ZT;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:17.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZU, li.ZU, div.ZU
	{mso-style-name:ZU;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.TAN, li.TAN, div.TAN
	{mso-style-name:TAN;
	mso-style-link:"TAN Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:42.55pt;
	margin-bottom:.0001pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
span.TANChar
	{mso-style-name:"TAN Char";
	mso-style-link:TAN;
	font-family:"Arial",sans-serif;}
p.ZH, li.ZH, div.ZH
	{mso-style-name:ZH;
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.TF, li.TF, div.TF
	{mso-style-name:TF;
	mso-style-link:"TF Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
span.TFChar
	{mso-style-name:"TF Char";
	mso-style-link:TF;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.ZG, li.ZG, div.ZG
	{mso-style-name:ZG;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.B2, li.B2, div.B2
	{mso-style-name:B2;
	mso-style-link:"B2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.B2Char
	{mso-style-name:"B2 Char";
	mso-style-link:B2;}
p.B3, li.B3, div.B3
	{mso-style-name:B3;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.B4, li.B4, div.B4
	{mso-style-name:B4;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.B5, li.B5, div.B5
	{mso-style-name:B5;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.1pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.ZTD, li.ZTD, div.ZTD
	{mso-style-name:ZTD;
	margin-top:0in;
	margin-right:1.4pt;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.ZV, li.ZV, div.ZV
	{mso-style-name:ZV;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.TAJ, li.TAJ, div.TAJ
	{mso-style-name:TAJ;
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.Guidance, li.Guidance, div.Guidance
	{mso-style-name:Guidance;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	color:blue;
	font-style:italic;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma",sans-serif;}
span.FootnoteTextChar
	{mso-style-name:"Footnote Text Char";
	mso-style-link:"Footnote Text";
	font-family:"Times New Roman",serif;}
p.INDENT1, li.INDENT1, div.INDENT1
	{mso-style-name:INDENT1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.INDENT2, li.INDENT2, div.INDENT2
	{mso-style-name:INDENT2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:56.75pt;
	text-indent:-14.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.INDENT3, li.INDENT3, div.INDENT3
	{mso-style-name:INDENT3;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:85.05pt;
	text-indent:-28.35pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.FigureTitle, li.FigureTitle, div.FigureTitle
	{mso-style-name:Figure_Title;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:24.0pt;
	margin-left:0in;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.CouvRecTitle, li.CouvRecTitle, div.CouvRecTitle
	{mso-style-name:"Couv Rec Title";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:70.9pt;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
span.DocumentMapChar
	{mso-style-name:"Document Map Char";
	mso-style-link:"Document Map";
	font-family:"Tahoma",sans-serif;
	background:navy;}
span.PlainTextChar
	{mso-style-name:"Plain Text Char";
	mso-style-link:"Plain Text";
	font-family:"Courier New";}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-link:"Body Text";
	font-family:"Times New Roman",serif;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";
	font-family:"Times New Roman",serif;}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.H6, li.H6, div.H6
	{mso-style-name:H6;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:99.25pt;
	text-indent:-99.25pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
 /* Page Definitions */
 @page WordSection1
	{size:595.35pt 842.0pt;
	margin:113.4pt 42.55pt 538.65pt 42.55pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.35pt 842.0pt;
	margin:70.8pt 56.65pt 56.65pt 56.65pt;}
div.WordSection2
	{page:WordSection2;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:14.2pt'>
<h3><a name="_Toc516843066"><span lang=EN-GB>5.4.1      Primary authentication
and key agreement procedure</span></a></h3><h4><a name="_Toc516843067"><span lang=EN-GB>5.4.1.1          General</span></a></h4><p class=MsoNormal><span lang=EN-GB>The purpose of the primary authentication
and key agreement procedure is to enable mutual authentication between the UE
and the network and to provide keying material that can be used between the UE
and network in subsequent security procedures, as specified in
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24].</span></p><p class=MsoNormal><span lang=EN-GB>Two methods are defined:</span></p><p class=B1><span lang=EN-GB>a)   EAP based primary authentication and key
agreement procedure.</span></p><p class=B1><span lang=EN-GB>b)  5G AKA based primary authentication and key
agreement procedure.</span></p><p class=MsoNormal><span lang=EN-GB>The UE and the AMF shall support the EAP
based primary authentication and key agreement procedure and the 5G AKA based
primary authentication and key agreement procedure.</span></p><h4><a name="_Toc516843068"><span lang=EN-GB>5.4.1.2          EAP based primary
authentication and key agreement procedure</span></a></h4><h5><a name="_Toc516843069"><span lang=EN-GB>5.4.1.2.1              General</span></a></h5><p class=MsoNormal><span lang=EN-GB>The purpose of the EAP based primary
authentication and key agreement procedure is to provide mutual authentication
between the UE and the network and to agree on a key K<sub>AMF</sub> (see
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]).</span></p><p class=MsoNormal><span lang=EN-GB>Extensible authentication protocol (EAP) as
specified in IETF&nbsp;RFC&nbsp;3748&nbsp;[34] enables authentication using
various EAP methods.</span></p><p class=MsoNormal><span lang=EN-GB>EAP defines four types of EAP messages:</span></p><p class=B1><span lang=EN-GB>a)   an EAP-request message;</span></p><p class=B1><span lang=EN-GB>b)  an EAP-response message;</span></p><p class=B1><span lang=EN-GB>c)   an EAP-success message; and</span></p><p class=B1><span lang=EN-GB>d)  an EAP-failure message.</span></p><p class=MsoNormal><span lang=EN-GB>Several rounds of exchanges of an
EAP-request message and a related EAP-response message can be required to
achieve the authentication (see example in figure&nbsp;5.4.1.2.1.1).</span></p><p class=MsoNormal><span lang=EN-GB>The EAP based primary authentication and
key agreement procedure is always initiated and controlled by the network.</span></p><p class=MsoNormal><span lang=EN-GB>The EAP-request message is transported from
the network to the UE using the AUTHENTICATION REQUEST message of the EAP
message reliable transport procedure.</span></p><p class=MsoNormal><span lang=EN-GB>The EAP-response message is transported
from the UE to the network using the AUTHENTICATION RESPONSE message of the EAP
message reliable transport procedure.</span></p><p class=MsoNormal><span lang=EN-GB>If the authentication of the UE completes
successfully and the serving AMF intends to initiate a security mode control
procedure after the EAP based primary authentication and key agreement
procedure, then the EAP-success message is transported from the network to the
UE using the SECURITY MODE COMMAND message of the security mode control
procedure (see subclause&nbsp;5.4.2).</span></p><p class=MsoNormal><span lang=EN-GB>If the authentication of the UE completes
successfully and the serving AMF does not intend to initiate a security mode
control procedure after the EAP based primary authentication and key agreement
procedure, then the EAP-success message is transported from the network to the
UE using the AUTHENTICATION RESULT message of the EAP result message transport
procedure.</span></p><p class=NO><span lang=EN-GB>NOTE&nbsp;1:  The serving AMF will not initiate a
security mode control procedure after the EAP based primary authentication and
key agreement procedure e.g. in case of AMF relocation during registration
procedure.</span></p><p class=MsoNormal><span lang=EN-GB>If the authentication of the UE completes
unsuccessfully, the EAP-failure message is transported from the network to the
UE using the AUTHENTICATION RESULT message of the EAP result message transport
procedure or in a response of the initial 5GMM procedure as part of which the EAP
based primary authentication and key agreement procedure is performed.</span></p><p class=MsoNormal><span lang=EN-GB>The AMF shall set the authenticator
retransmission timer specified in IETF&nbsp;RFC&nbsp;3748&nbsp;[34]
subclause&nbsp;4.3 to infinite value.</span></p><p class=NO><span lang=EN-GB>NOTE&nbsp;2:  The EAP message reliable transport
procedure provides a reliable transport of EAP messages and therefore
retransmissions at the EAP layer do not occur.</span></p><p class=MsoNormal><span lang=EN-GB>The AUSF and the AMF support exchange of
EAP messages using N12.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's</span><span lang=EN-GB> note: The
ngKSI handling at EAP authentication is FFS.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's</span><span lang=EN-GB> note: establishment
of 5GS security context is FFS.</span></p><p class=TH><span lang=EN-GB><img width=564 height=777
src="24501-f00_files/image005.png"></span></p><p class=TF><span lang=EN-GB>Figure&nbsp;5.4.1.2.1.1: EAP based primary
authentication and key agreement procedure</span></p><h5><a name="_Toc516843070"><span lang=EN-GB>5.4.1.2.2              EAP-AKA'
related procedures</span></a></h5><h6><a name="_Toc516843071"><span lang=EN-GB>5.4.1.2.2.1                 General</span></a></h6><p class=MsoNormal><span lang=EN-GB>The UE shall support acting as EAP-AKA'
peer as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40]. The AUSF may support
acting as EAP-AKA' server as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40].</span></p><p class=MsoNormal><span lang=EN-GB>The EAP-AKA' enables mutual authentication
of the UE and the network.</span></p><p class=MsoNormal><span lang=EN-GB>The UE can reject the
EAP-request/AKA'-challenge message sent by the network. The UE shall proceed with
an EAP-request/AKA'-challenge message only if a USIM is present.</span></p><p class=MsoNormal><span lang=EN-GB>During a successful EAP based primary
authentication and key agreement procedure, the CK and IK are computed by the
USIM. CK and IK are then used by the ME as key material to compute a new key, K<sub>AMF</sub>.
K<sub>AMF</sub> is stored in the 5GS security contexts (see
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]) of both the network and in the volatile
memory of the ME while registered to the network, and is the root for the 5GS
integrity protection and ciphering key hierarchy.</span></p><h6><a name="_Toc516843072"><span lang=EN-GB>5.4.1.2.2.2                 Initiation</span></a></h6><p class=MsoNormal><span lang=EN-GB>In order to initiate the EAP based primary
authentication and key agreement procedure using EAP-AKA', the AUSF shall send
an EAP-request/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40]. The AUSF shall set the AT_KDF_INPUT attribute
of the EAP-request/AKA'-challenge message to the SNN. The SNN is in format
described in subclause&nbsp;9.9.1. The AUSF may include AT_RESULT_IND attribute
in the EAP-request/AKA'-challenge message.</span></p><p class=MsoNormal><span lang=EN-GB>Upon receiving an
EAP-request/AKA'-challenge message, the UE shall check whether the UE has a
USIM, shall check the key derivation function indicated in AT_KDF attributes as
specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40], and if the value of the Key
Derivation Function field within the received AT_KDF attribute, is of value 1, shall
check:</span></p><p class=B1><span lang=EN-GB>a)   whether the network name field of the
AT_KDF_INPUT attribute is the SNN constructed according to subclause&nbsp;9.9.1;
and</span></p><p class=B1><span lang=EN-GB>b)  whether the network name field of the
AT_KDF_INPUT attribute matches the PLMN identity saved in the UE.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's Note: It is FFS what the UE
should do if the K</span><span lang=EN-GB>ey Derivation Funtion field is of a
value not equal to 1.</span></p><p class=MsoNormal><span lang=EN-GB>The PLMN identity the UE uses for the above
network name check is as follows:</span></p><p class=B1><span lang=EN-GB>a)   when the UE moves from 5GMM-IDLE mode to
5GMM-CONNECTED mode, until the first handover, the UE shall use the PLMN
identity of the selected PLMN; and</span></p><p class=B1><span lang=EN-GB>b)  after handover or inter-system change to N1
mode in 5GMM-CONNECTED mode:</span></p><p class=B2><span lang=EN-GB>1)  if the target cell is not a shared network
cell, the UE shall use the PLMN identity received as part of the broadcast
system information;</span></p><p class=B2><span lang=EN-GB>2)  if the target cell is a shared network cell
and the UE has a valid 5G-GUTI, the UE shall use the PLMN identity that is part
of the 5G-GUTI; and</span></p><p class=B2><span lang=EN-GB>3)  if the target cell is a shared network cell
and the UE has a valid 4G-GUTI and TAI, but not a valid 5G-GUTI, the UE shall
use the PLMN identity that is part of the TAI.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's Note: In the eventuality that
RAN2 decides to use different TAI for 4G and for 5G, the above requirements
will need to be revisited.</span></p><h6><a name="_Toc516843073"><span lang=EN-GB>5.4.1.2.2.3                 UE successfully
authenticates network</span></a></h6><p class=MsoNormal><span lang=EN-GB>If a USIM is present and the SNN check is
successful, the UE shall handle the EAP-request/AKA'-challenge message
specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40]. The USIM shall derive CK and IK
and compute the authentication response (RES) using the 5G authentication
challenge data received from the ME, and pass RES to the ME. The ME shall
derive CK’ and IK’ from CK and IK. Furthermore, the ME shall generate K<sub>AUSF</sub>,
K<sub>SEAF</sub>, K<sub>AMF</sub> and MAC as described in
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24] and shall send an EAP-response/AKA'-challenge
message as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40].</span></p><p class=MsoNormal><span lang=EN-GB>If the EAP-request/AKA'-challenge message
contains AT_RESULT_IND attribute, the UE may include AT_RESULT_IND attribute in
the EAP-response/AKA'-challenge message as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40].</span></p><h6><a name="_Toc516843074"><span lang=EN-GB>5.4.1.2.2.4                 Errors
when handling EAP-request/AKA'-challenge message</span></a></h6><p class=MsoNormal><span lang=EN-GB>If a USIM is present, the SNN check fails
or the UE does not accept AUTN during handling of the
EAP-request/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40], the UE shall send an
EAP-response/AKA'-authentication-reject message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40].</span></p><p class=MsoNormal><span lang=EN-GB>If a USIM is present, the SNN check is
successful but the UE detects that the sequence number in AUTN is not correct
during handling of the EAP-request/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40], the UE shall send an
EAP-response/AKA'-synchronization-failure message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40].</span></p><p class=MsoNormal><span lang=EN-GB>If a USIM is present, the SNN check is
successful, the sequence number in AUTN is correct and the UE detects another error
during handling of the EAP-request/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40], the UE shall send an EAP-response/AKA'-client-error
message as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40].</span></p><p class=MsoNormal><span lang=EN-GB>If a USIM is not present, the UE shall send
an EAP-response/AKA'-client-error message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[37].</span></p><h6><a name="_Toc516843075"><span lang=EN-GB>5.4.1.2.2.5                 Network
successfully authenticates UE</span></a></h6><p class=MsoNormal><span lang=EN-GB>Upon reception of the
EAP-response/AKA'-challenge message, if procedures for handling an
EAP-response/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40] are successful, the AUSF may generate K<sub>AUSF</sub>
and shall generate K<sub>SEAF</sub> as described in
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24] and checks whether the AT_RESULT_IND
attribute is included in the EAP-response/AKA'-challenge message and:</span></p><p class=B1><span lang=EN-GB>a)   if the AT_RESULT_IND attribute is included in
the EAP-response/AKA'-challenge message, the AUSF shall send an
EAP-request/AKA'-notification message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40]; and</span></p><p class=B1><span lang=EN-GB>b)  if the AT_RESULT_IND attribute is not included
in the EAP-response/AKA'-challenge message, the AUSF shall send an EAP-success
message as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40] along with the K<sub>SEAF</sub>
and shall consider the procedure complete.</span></p><p class=NO><span lang=EN-GB>NOTE:      SEAF generates K<sub>AMF </sub>based on
the received K<sub>SEAF </sub>immediately following the primary authentication
and key agreement procedure and provides K<sub>AMF</sub> to AMF.</span></p><h6><a name="_Toc516843076"><span lang=EN-GB>5.4.1.2.2.6                 UE
handling EAP-AKA' notification</span></a></h6><p class=MsoNormal><span lang=EN-GB>Upon receiving an
EAP-request/AKA'-notification message, the UE shall send an
EAP-response/AKA'-notification message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[37].</span></p><h6><a name="_Toc516843077"><span lang=EN-GB>5.4.1.2.2.7                 Network
sending EAP-success message</span></a></h6><p class=MsoNormal><span lang=EN-GB>Upon reception of the
EAP-response/AKA'-notification message, if earlier procedures for handling an
EAP-request/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40] were successful, the AUSF shall send an
EAP-success message as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40] along
with the K<sub>SEA</sub> and shall consider the procedure complete.</span></p><p class=NO><span lang=EN-GB>NOTE:      SEAF generates K<sub>AMF </sub>based on
the received K<sub>SEAF </sub>immediately following the primary authentication
and key agreement procedure and provides K<sub>AMF</sub> to AMF.</span></p><h6><a name="_Toc516843078"><span lang=EN-GB>5.4.1.2.2.8                 UE
handling EAP-success message</span></a></h6><p class=MsoNormal><span lang=EN-GB>Upon receiving an EAP-success message, the
UE shall consider the procedure complete.</span></p><h6><a name="_Toc516843079"><span lang=EN-GB>5.4.1.2.2.9                 Network
not successfully authenticates UE</span></a></h6><p class=MsoNormal><span lang=EN-GB>Upon reception of the
EAP-response/AKA'-challenge message, if procedures for handling an
EAP-response/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40] are not successful, the AUSF shall send an
EAP-request/AKA'-notification message that implies failure as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40].</span></p><h6><a name="_Toc516843080"><span lang=EN-GB>5.4.1.2.2.10               Network
sending EAP-failure message</span></a></h6><p class=MsoNormal><span lang=EN-GB>Upon reception of the
EAP-response/AKA'-notification message, if earlier procedures for handling an
EAP-request/AKA'-challenge message as specified in
IETF&nbsp;RFC&nbsp;5448&nbsp;[40] were not successful, the AUSF shall send an
EAP-failure message as specified in IETF&nbsp;RFC&nbsp;5448&nbsp;[40] and shall
consider the procedure complete.</span></p><h6><a name="_Toc516843081"><span lang=EN-GB>5.4.1.2.2.11               UE
handling EAP-success</span></a></h6><p class=MsoNormal><span lang=EN-GB>Upon receiving an EAP-failure message, the
UE shall consider the procedure complete.</span></p><h5><a name="_Toc516843082"><span lang=EN-GB>5.4.1.2.3              EAP-TLS
related procedures</span></a></h5><h6><a name="_Toc516843083"><span lang=EN-GB>5.4.1.2.3.1                 General</span></a></h6><p class=MsoNormal><span lang=EN-GB>The UE may support acting as EAP-TLS peer
as specified in 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]. The AUSF may support acting
as EAP-TLS server as specified in 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24].</span></p><p class=MsoNormal><span lang=EN-GB>The EAP-TLS enables mutual authentication
of the UE and the network.</span></p><p class=MsoNormal><span lang=EN-GB>When EAP-TLS is used, upon generation of
EMSK, the UE shall generate K<sub>AUSF</sub>, K<sub>SEAF</sub>, and K<sub>AMF </sub>as
described in 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24].</span></p><h5><a name="_Toc516843084"><span lang=EN-GB>5.4.1.2.4              EAP message
reliable transport procedure</span></a></h5><h6><a name="_Toc516843085"><span lang=EN-GB>5.4.1.2.4.1                 General</span></a></h6><p class=MsoNormal><span lang=EN-GB>The purpose of the EAP message reliable
transport procedure is to provide a reliable transport of an EAP-request
message from the network to the UE and of an EAP-response message from the UE
to the network.</span></p><p class=MsoNormal><span lang=EN-GB>The EAP message reliable transport
procedure is initiated by an AUTHENTICATION REQUEST </span>message with <span
lang=EN-GB>the EAP message IE.</span></p><h6><a name="_Toc516843086"><span lang=EN-GB>5.4.1.2.4.2                 EAP
message reliable transport procedure initiation by the network</span></a></h6><p class=MsoNormal><span lang=EN-GB>In order to initiate the EAP message
reliable transport procedure, the AMF shall create an AUTHENTICATION REQUEST
message.</span></p><p class=MsoNormal><span lang=EN-GB>The AMF </span><span lang=EN-GB>shall</span><span
lang=EN-GB> </span><span lang=EN-GB>set the EAP message IE of the AUTHENTICATION
REQUEST message to </span><span lang=EN-GB>the EAP-request message </span><span
lang=EN-GB>to be sent to the UE.</span></p><p class=MsoNormal><span lang=EN-GB>The AMF shall send the AUTHENTICATION
REQUEST </span>message to the UE<span lang=EN-GB>, </span>and the AMF <span
lang=EN-GB>shall </span>start timer T3560 <span lang=EN-GB>(see example in
figure&nbsp;5.4.1.2.4.2.1).</span></p><p class=TH><span lang=EN-GB><img width=605 height=276
src="24501-f00_files/image006.png"></span></p><p class=TF><span lang=EN-GB>Figure&nbsp;5.4.1.2.4.2.1: EAP message reliable
transport procedure</span></p><p class=MsoNormal><span lang=EN-GB>Upon receipt of an AUTHENTICATION REQUEST </span>message
with the EAP message IE<span lang=EN-GB>, the UE handles the EAP message
received in the EAP message IE of the AUTHENTICATION REQUEST </span>message<span
lang=EN-GB>.</span></p><h6><a name="_Toc516843087"><span lang=EN-GB>5.4.1.2.4.3                 EAP
message reliable transport procedure accepted by the UE</span></a></h6><p class=MsoNormal><span lang=EN-GB>The UE shall create an AUTHENTICATION
RESPONSE </span>message<span lang=EN-GB>.</span></p><p class=MsoNormal><span lang=EN-GB>If the received EAP message is an
EAP-request</span><span lang=EN-GB> message</span><span lang=EN-GB>, the UE </span><span
lang=EN-GB>shall</span><span lang=EN-GB> </span><span lang=EN-GB>set the EAP
message IE of the AUTHENTICATION RESPONSE message to </span><span lang=EN-GB>the
EAP-response</span><span lang=EN-GB> message</span><span lang=EN-GB> responding
to the received EAP-request</span><span lang=EN-GB> message.</span></p><p class=MsoNormal><span lang=EN-GB>The UE shall send the AUTHENTICATION
RESPONSE message to the AMF.</span></p><p class=MsoNormal><span lang=EN-GB>Upon receipt of an AUTHENTICATION RESPONSE </span>message,
the AMF <span lang=EN-GB>shall </span>stop timer T3560. If the EAP message IE
is included in the <span lang=EN-GB>AUTHENTICATION RESPONSE </span>message, the
AMF handles the EAP message received in the EAP message IE of the <span
lang=EN-GB>AUTHENTICATION RESPONSE </span>message<span lang=EN-GB>.</span></p><h6><a name="_Toc516843088"><span lang=EN-GB>5.4.1.2.4.4                 Abnormal
cases on the network side</span></a></h6><p class=MsoNormal><span lang=EN-GB>The following abnormal cases can be
identified:</span></p><p class=B1><span lang=EN-GB>a)   </span>Expiry of timer <span lang=EN-GB>T3560.</span></p><p class=B1><span lang=EN-GB>      The AMF shall, on the first expiry of the
timer T3560, retransmit the AUTHENTICATION REQUEST message and shall reset and
start timer T3560. This retransmission is repeated four times, i.e. on the
fifth expiry of timer T3560, the AMF shall abort the EAP based primary
authentication and key agreement procedure and any ongoing 5GMM specific
procedure, and release the N1 NAS signalling connection.</span></p><h6><a name="_Toc516843089"><span lang=EN-GB>5.4.1.2.4.5                 Abnormal
cases in the UE</span></a></h6><p class=EditorsNote><span lang=EN-GB>Editor's note: Abnormal cases are FFS</span></p><h5><a name="_Toc516843090"><span lang=EN-GB>5.4.1.2.5              EAP result
message transport procedure</span></a></h5><h6><a name="_Toc516843091"><span lang=EN-GB>5.4.1.2.5.1                 General</span></a></h6><p class=MsoNormal><span lang=EN-GB>The purpose of the EAP result message
transport procedure is to provide an EAP-success message or an EAP-failure
message from the network to the UE, when the EAP message cannot be piggybacked
by another NAS message.</span></p><p class=MsoNormal><span lang=EN-GB>The EAP result message transport procedure
is initiated by an AUTHENTICATION RESULT </span>message with <span lang=EN-GB>the
EAP message IE.</span></p><h6><a name="_Toc516843092"><span lang=EN-GB>5.4.1.2.5.2                 EAP
result message transport procedure initiation by the network</span></a></h6><p class=MsoNormal><span lang=EN-GB>In order to initiate the EAP result message
transport procedure, the AMF shall create an AUTHENTICATION RESULT message.</span></p><p class=MsoNormal><span lang=EN-GB>The AMF </span><span lang=EN-GB>shall</span><span
lang=EN-GB> </span><span lang=EN-GB>set the EAP message IE of the AUTHENTICATION
RESULT message to an EAP-success message or an EAP-failure message</span><span
lang=EN-GB> </span><span lang=EN-GB>to be sent to the UE.</span></p><p class=MsoNormal><span lang=EN-GB>The AMF shall send the AUTHENTICATION
RESULT </span>message to the UE <span lang=EN-GB>(see example in figure&nbsp;5.4.1.2.5.2.1).</span></p><p class=TH><span lang=EN-GB><img width=605 height=276
src="24501-f00_files/image007.png"></span></p><p class=TF><span lang=EN-GB>Figure&nbsp;5.4.1.2.5.2.1: EAP result message
transport procedure</span></p><p class=MsoNormal><span lang=EN-GB>Upon receipt of an AUTHENTICATION RESULT </span>message
with the EAP message IE<span lang=EN-GB>, the UE handles the EAP message
received in the EAP message IE of the AUTHENTICATION RESULT </span>message<span
lang=EN-GB>.</span></p><h4><a name="_Toc516843093"><span lang=EN-GB>5.4.1.3          5G AKA based
primary authentication and key agreement procedure</span></a></h4><h5><a name="_Toc516843094"><span lang=EN-GB>5.4.1.3.1              General</span></a></h5><p class=MsoNormal><span lang=EN-GB>The purpose of the 5G AKA based primary
authentication and key agreement procedure is to provide mutual authentication
between the UE and the network and to agree on a key K<sub>AMF</sub> (see
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]). The cases when the 5G AKA based primary
authentication and key agreement procedure is used are defined in
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24].</span></p><p class=MsoNormal><span lang=EN-GB>The 5G AKA based primary authentication and
key agreement procedure is always initiated and controlled by the network.
However, the UE can reject the 5G authentication challenge sent by the network.</span></p><p class=MsoNormal><span lang=EN-GB>The UE shall proceed with a 5G
authentication challenge only if a USIM is present.</span></p><p class=MsoNormal><span lang=EN-GB>A partial native 5G NAS security context is
established in the UE and the network when a 5G authentication is successfully
performed. During a successful 5G AKA based primary authentication and key
agreement procedure, the CK and IK are computed by the USIM. CK and IK are then
used by the ME as key material to compute a new key, K<sub>AMF</sub>. K<sub>AMF</sub>
is stored in the 5G NAS security contexts (see 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24])
of both the network and in the volatile memory of the ME while registered to
the network, and is the root for the 5GS integrity protection and ciphering key
hierarchy.</span></p><p class=MsoNormal><span lang=EN-GB>The 5G AKA based primary authentication and
key agreement procedure is initiated by an AUTHENTICATION REQUEST </span>message
without <span lang=EN-GB>the EAP message IE.</span></p><h5><a name="_Toc516843095"><span lang=EN-GB>5.4.1.3.2              Authentication
initiation by the network</span></a></h5><p class=MsoNormal><span lang=EN-GB>The network may initiate a 5G AKA based
primary authentication and key agreement procedure for a UE in 5GMM-CONNECTED
mode at any time. For restrictions applicable after handover or inter-system change
to N1 mode in 5GMM-CONNECTED mode, see subclause&nbsp;5.4.1.2.3.</span></p><p class=MsoNormal><span lang=EN-GB>The network initiates the 5G AKA based
primary authentication and key agreement procedure by sending an AUTHENTICATION
REQUEST message to the UE and starting the timer T3560 (see example in
figure&nbsp;5.4.1.3.2.1). The AUTHENTICATION REQUEST message contains the
parameters necessary to calculate the authentication response (see
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]).</span></p><p class=MsoNormal><span lang=EN-GB>If an ngKSI is contained in an initial NAS
message during a 5GMM procedure, the network shall include a different ngKSI
value in the AUTHENTICATION REQUEST message when it initiates a 5G AKA based
primary authentication and key agreement procedure.</span></p><p class=TH><span lang=EN-GB><img width=557 height=224
src="24501-f00_files/image008.png"></span></p><p class=TF><span lang=EN-GB>Figure&nbsp;5.4.1.3.2.1: 5G AKA based primary
authentication and key agreement procedure</span></p><h5><a name="_Toc516843096"><span lang=EN-GB>5.4.1.3.3              Authentication
response by the UE</span></a></h5><p class=MsoNormal><span lang=EN-GB>The UE shall respond to an AUTHENTICATION
REQUEST message. With the exception of the cases described in subclause&nbsp;5.4.1.3.5,
the UE shall process the 5G authentication challenge data and respond with an
AUTHENTICATION RESPONSE message to the network.</span></p><p class=MsoNormal><span lang=EN-GB>Upon a successful 5G authentication
challenge, the UE shall determine the PLMN identity to be used for the
calculation of the new K<sub>AMF</sub> from the 5G authentication challenge
data according to the following rules:</span></p><p class=B1><span lang=EN-GB>a)   When the UE moves from 5GMM-IDLE mode to
5GMM-CONNECTED mode, until the first handover, the UE shall use the PLMN
identity of the selected PLMN; and</span></p><p class=B1><span lang=EN-GB>b)  After handover or inter-system change to N1
mode in 5GMM-CONNECTED mode,</span></p><p class=B2><span lang=EN-GB>1)  if the target cell is not a shared network
cell, the UE shall use the PLMN identity received as part of the broadcast
system information;</span></p><p class=B2><span lang=EN-GB>2)  if the target cell is a shared network cell
and the UE has a valid 5G-GUTI, the UE shall use the PLMN identity that is part
of the 5G-GUTI; and</span></p><p class=B2><span lang=EN-GB>3)  if the target cell is a shared network cell
and the UE has a valid 4G-GUTI and TAI, but not a valid 5G-GUTI, the UE shall
use the PLMN identity that is part of the TAI.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's</span><span lang=EN-GB> note: Security
context coordination between EPS and 5GS is FFS.</span></p><p class=MsoNormal><span lang=EN-GB>Upon a successful 5G authentication
challenge, the new K<sub>AMF</sub> calculated from the 5G authentication
challenge data shall be stored in a new 5G NAS security context in the volatile
memory of the ME.</span></p><p class=MsoNormal><span lang=EN-GB>The USIM will compute the authentication
response (RES) using the 5G authentication challenge data received from the ME,
and pass RES to the ME. From the RES, RES* is then generated according to Annex
A of 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24].</span></p><p class=MsoNormal><span lang=EN-GB>In order to avoid a synchronisation
failure, when the UE receives an AUTHENTICATION REQUEST message, the UE shall
store the received RAND together with the RES*, in the volatile memory of the
ME. When the UE receives a subsequent AUTHENTICATION REQUEST message, if the
stored RAND value is equal to the new received value in the AUTHENTICATION
REQUEST message, then the ME shall not pass the RAND to the USIM, but shall
send the AUTHENTICATION RESPONSE message with the stored RES*. If there is no
valid stored RAND in the ME or the stored RAND is different from the new
received value in the AUTHENTICATION REQUEST message, the ME shall pass the
RAND to the USIM, shall override any previously stored RAND and RES* with the
new ones and start, or reset and restart timer T3516.</span></p><p class=MsoNormal><span lang=EN-GB>The RAND and RES* values stored in the ME
shall be deleted and timer T3516, if running, shall be stopped:</span></p><p class=B1><span lang=EN-GB>a)   upon receipt of a</span></p><p class=B2><span lang=EN-GB>1)  SECURITY MODE COMMAND message,</span></p><p class=B2><span lang=EN-GB>2)  SERVICE REJECT message,</span></p><p class=B2><span lang=EN-GB>3)  REGISTRATION REJECT message,</span></p><p class=B2><span lang=EN-GB>4)  REGISTRATION ACCEPT message, or</span></p><p class=B2><span lang=EN-GB>5)  AUTHENTICATION REJECT message;</span></p><p class=B1><span lang=EN-GB>b)  upon expiry of timer T3516;</span></p><p class=B2><span lang=EN-GB>1)  if the UE enters the 5GMM state 5GMM-DEREGISTERED
or 5GMM-NULL; or</span></p><p class=B2><span lang=EN-GB>2)  if the UE enters 5GMM-IDLE mode.</span></p><h5><a name="_Toc516843097"><span lang=EN-GB>5.4.1.3.4              Authentication
completion by the network</span></a></h5><p class=MsoNormal><span lang=EN-GB>Upon receipt of an AUTHENTICATION RESPONSE
message, the network stops the timer T3560 and checks the correctness of RES*
(see 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]).</span></p><p class=MsoNormal><span lang=EN-GB>If the 5G AKA based primary authentication and
key agreement procedure has been completed successfully and the related ngKSI
is stored in the 5G NAS security context of the network, the network shall
include a different ngKSI value in the AUTHENTICATION REQUEST message when it
initiates a new 5G AKA based primary authentication and key agreement procedure.</span></p><p class=MsoNormal><span lang=EN-GB>Upon receipt of an AUTHENTICATION </span><span
lang=EN-GB>FAILURE</span><span lang=EN-GB> message, the network stop</span><span
lang=EN-GB>s</span><span lang=EN-GB> the timer T3560</span><span lang=EN-GB>.
In the case where the 5GMM cause #21 &quot;</span><span lang=EN-GB>synch
failure&quot; is received</span><span lang=EN-GB>, </span><span lang=EN-GB>the
core network may renegotiate with the UDM/AUSF and provide the UE with new
authentication parameters.</span></p><h5><a name="_Toc516843098"><span lang=EN-GB>5.4.1.3.5              Authentication
not accepted by the network</span></a></h5><p class=EditorsNote><span lang=EN-GB>Editor's</span><span lang=EN-GB> note: Authentication
not accepted for normal services by the network is FFS.</span></p><p class=MsoNormal><span lang=EN-GB>Depending on local requirements or operator
preference for emergency services, if the UE initiates a registration procedure
with 5GS registration type IE set to &quot;emergency registration&quot; and the
AMF is configured to allow emergency registration without user identity, the
AMF needs not follow the procedures specified for the authentication failure in
the present subclause. The AMF may continue a current 5GMM specific procedure.</span></p><h5><a name="_Toc516843099"><span lang=EN-GB>5.4.1.3.6              Authentication
not accepted by the UE</span></a></h5><p class=MsoNormal><span lang=EN-GB>In the 5G authentication challenge, the UE
shall check the 5G authentication challenge data (RAND, AUTN and ngKSI)
received in the AUTHENTICATION REQUEST message to verify authenticity of the 5G
core network.</span></p><p class=MsoNormal><span lang=EN-GB>The ME shall check that ngKSI received in
the AUTHENTICATION REQUEST message is not already in use. The ME shall forward the
RAND and AUTN to the USIM to check.</span></p><p class=MsoNormal><span lang=EN-GB>The UE may reject the core network due to
an incorrect, AUTN or ngKSI parameter. If the UE has to reject the 5G authentication
challenge, the UE shall return AUTHENTICATION FAILURE message to the network
with a cause value indicating the reason for the failure (see
3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]).</span></p><p class=MsoNormal><span lang=EN-GB>Incorrect 5G authentication challenge data
contains four possible causes for authentication failure:</span></p><p class=B1><span lang=EN-GB>a)   MAC code failure:</span></p><p class=B1><span lang=EN-GB>      If the UE finds the MAC code (supplied by
the core network in the AUTN parameter) to be invalid, the UE shall send an
AUTHENTICATION FAILURE message to the network, with the 5GMM cause #20 &quot;MAC
failure&quot;. The UE shall then follow the procedure described in subclause&nbsp;5.4.1.3.7,
item c.</span></p><p class=B1>b)  Non-5G authentication unacceptable:</p><p class=B1>      <span lang=EN-GB>If the UE finds that the &quot;separation
bit&quot; in the AMF field of AUTN supplied by the core network is set to 0,
the UE shall send an AUTHENTICATION FAILURE message to the network, with the 5GMM
cause #26 &quot;non-5G authentication unacceptable&quot; (see subclause&nbsp;6.1.3
in 3GPP&nbsp;TS&nbsp;33.501&nbsp;[24]). The UE shall then follow the procedure
described in subclause&nbsp;5.4.1.3.7, item d.</span></p><p class=B1><span lang=EN-GB>c)   ngKSI already in use:</span></p><p class=B1><span lang=EN-GB>      If the UE detects that ngKSI received in the
AUTHENTICATION REQUEST message is already in use in the UE shall send an
AUTHENTICATION FAILURE message to the network, with the 5GMM cause #29 &quot;ngKSI
already in use&quot;. The UE shall then follow the procedure described in subclause&nbsp;5.4.1.3.7,
item e. </span></p><p class=B1><span lang=EN-GB>d)  SQN failure:</span></p><p class=B1><span lang=EN-GB>      If the UE finds the sequence number SQN
(supplied by the core network in the AUTN parameter) to be out of range, the UE
shall send an AUTHENTICATION FAILURE message to the network, with the 5GMM
cause #21 &quot;synch failure&quot; and a re-synchronization token AUTS
provided by the USIM (see 3GPP&nbsp;TS&nbsp;33.102&nbsp;[23]). The UE shall
then follow the procedure described in subclause&nbsp;5.4.1.3.7, item f.</span></p><p class=MsoNormal><span lang=EN-GB>If the UE returns an AUTHENTICATION FAILURE
message to the network, the UE shall delete any previously stored RAND and RES
and shall stop timer T3516, if running.</span></p><p class=MsoNormal><span lang=EN-GB>If the UE has a PDU session for emergency
services established or is establishing such a PDU session, additional UE
requirements are specified in subclause&nbsp;5.4.1.3.7, under &quot;for items c,
d, e and f&quot;.</span></p><h5><a name="_Toc516843100"><span lang=EN-GB>5.4.1.3.7              Abnormal
cases</span></a></h5><p class=B1><span lang=EN-GB>a)   Lower layer failure.</span></p><p class=B1><span lang=EN-GB>      Upon detection of lower layer failure before
the AUTHENTICATION RESPONSE message is received, the network shall abort the
procedure.</span></p><p class=B1><span lang=EN-GB>b)  Expiry of timer T3560.</span></p><p class=B1><span lang=EN-GB>      The network shall, on the first expiry of
the timer T3560, retransmit the AUTHENTICATION REQUEST message and shall reset
and start timer T3560. This retransmission is repeated four times, i.e. on the
fifth expiry of timer T3560, the network shall abort the 5G AKA based primary
authentication and key agreement procedure and any ongoing 5GMM specific
procedure and release the N1 NAS signalling connection.</span></p><p class=B1>c)   Authentication failure (5GMM cause #20 &quot;MAC
failure&quot;).</p><p class=B1>      <span lang=EN-GB>The UE shall send an AUTHENTICATION FAILURE
message, with 5GMM cause #20 &quot;MAC failure&quot; according to
subclause&nbsp;5.4.1.3.6, to the network and start timer T3520 (see example in
figure&nbsp;5.4.1.3.7.1). Furthermore, the UE shall stop any of the
retransmission timers that are running (e.g. T3510, T3517 or T3521). Upon the
first receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #20
&quot;MAC failure&quot;, the network may initiate the identification procedure
described in subclause&nbsp;5.4.3. This is to allow the network to obtain the
SUCI from the UE. The network may then check that the 5G-GUTI originally used
in the 5G authentication challenge corresponded to the correct SUPI. Upon receipt
of the IDENTITY REQUEST message from the network, the UE shall proceed as
specified in subclause&nbsp;5.4.3.3.</span></p><p class=NO><span lang=EN-GB>NOTE&nbsp;1:  Upon receipt of an AUTHENTICATION
FAILURE message from the UE with 5GMM cause #20 &quot;MAC failure&quot;, the
network may also terminate the 5G AKA based primary authentication and key
agreement procedure (see subclause&nbsp;5.4.1.3.5).</span></p><p class=B1><span lang=EN-GB>      If the mapping of 5G-GUTI to SUPI in the
network was incorrect, the network should respond by sending a new
AUTHENTICATION REQUEST message to the UE. Upon receiving the new AUTHENTICATION
REQUEST message from the network, the UE shall stop the timer T3520, if
running, and then process the 5G challenge information as normal. If the
mapping of 5G-GUTI to SUPI in the network was correct, the network should
terminate the 5G AKA based primary authentication and key agreement procedure by
sending an AUTHENTICATION REJECT message (see subclause&nbsp;5.4.1.3.5).</span></p><p class=B1><span lang=EN-GB>      If the network is validated successfully (an
AUTHENTICATION REQUEST message that contains a valid SQN and MAC is received),
the UE shall send the AUTHENTICATION RESPONSE message to the network and shall
start any retransmission timers (e.g. T3510, T3517 or T3521) if they were
running and stopped when the UE received the first failed AUTHENTICATION
REQUEST message.</span></p><p class=B1><span lang=EN-GB>      If the UE receives the second AUTHENTICATION
REQUEST message while T3520 is running, and the MAC value cannot be resolved,
the UE shall follow the procedure specified in this subclause, item&nbsp;c,
starting again from the beginning, or if the message contains a UMTS authentication
challenge, the UE shall follow the procedure specified in item&nbsp;d. If the
SQN is invalid, the UE shall proceed as specified in item&nbsp;f.</span></p><p class=TH><span lang=EN-GB><img width=568 height=277
src="24501-f00_files/image009.png"></span></p><p class=TF><span lang=EN-GB>Figure&nbsp;5.4.1.3.7.1: Authentication failure
during 5G AKA based primary authentication and key agreement procedure</span></p><p class=B1><span lang=EN-GB>d)  Authentication failure (5GMM cause #26 &quot;non-5G
authentication unacceptable&quot;).</span></p><p class=B1><span lang=EN-GB>      The UE shall send an AUTHENTICATION FAILURE
message, with 5GMM cause #26 &quot;non-5G authentication unacceptable&quot;, to
the network and start the timer T3520 (see example in figure 5.4.1.3.7.1). Furthermore,
the UE shall stop any of the retransmission timers that are running (e.g. T3510,
T3517 or T3521). Upon the first receipt of an AUTHENTICATION FAILURE message
from the UE with 5GMM cause #26 &quot;non-5G authentication unacceptable&quot;,
the network may initiate the identification procedure described in
subclause&nbsp;5.4.3. This is to allow the network to obtain the SUCI from the
UE. The network may then check that the 5G-GUTI originally used in the 5G authentication
challenge corresponded to the correct SUPI. Upon receipt of the IDENTITY
REQUEST message from the network, the UE shall proceed as specified in subclause&nbsp;5.4.3.3.</span></p><p class=NO><span lang=EN-GB>NOTE&nbsp;2:  Upon receipt of an AUTHENTICATION
FAILURE message from the UE with 5GMM cause #26 &quot;non-5G authentication
unacceptable&quot;, the network may also terminate the 5G AKA based primary
authentication and key agreement procedure (see subclause&nbsp;5.4.1.3.5).</span></p><p class=B1><span lang=EN-GB>      If the mapping of 5G-GUTI to SUPI in the
network was incorrect, the network should respond by sending a new
AUTHENTICATION REQUEST message to the UE. Upon receiving the new AUTHENTICATION
REQUEST message from the network, the UE shall stop the timer T3520, if
running, and then process the 5G challenge information as normal. If the
mapping of 5G-GUTI to SUPI in the network was correct, the network should
terminate the 5G AKA based primary authentication and key agreement authentication
procedure by sending an AUTHENTICATION REJECT message (see
subclause&nbsp;5.4.1.3.5).</span></p><p class=B1><span lang=EN-GB>e)   Authentication failure (5GMM cause #29 &quot;ngKSI
already in use&quot;).</span></p><p class=B1><span lang=EN-GB>      The UE shall send an AUTHENTICATION FAILURE
message, with 5GMM cause #29 &quot;ngKSI already in use&quot;, to the network
and start the timer T3520 (see example in figure 5.4.1.3.7.1). Furthermore, the
UE shall stop any of the retransmission timers that are running (e.g. T3510,
T3517 or T3521). Upon the first receipt of an AUTHENTICATION FAILURE message
from the UE with 5GMM cause #29 &quot;ngKSI already in use&quot;, the network performs
necessary actions to select a new ngKSI and send the same 5G authentication
challenge to the UE.</span></p><p class=NO><span lang=EN-GB>NOTE&nbsp;3:  Upon receipt of an AUTHENTICATION
FAILURE message from the UE with 5GMM cause #29 &quot;ngKSI already in use&quot;,
the network may also re-initiate the 5G AKA based primary authentication and
key agreement procedure (see subclause&nbsp;5.4.1.3.2).</span></p><p class=B1><span lang=EN-GB>      Upon receiving the new AUTHENTICATION
REQUEST message from the network, the UE shall stop the timer T3520, if
running, and then process the 5G challenge information as normal.</span></p><p class=B1><span lang=EN-GB>f)   Authentication failure (5GMM cause #21 &quot;synch
failure&quot;).</span></p><p class=B1><span lang=EN-GB>      The UE shall send an AUTHENTICATION FAILURE
message, with 5GMM cause #21 &quot;synch failure&quot;, to the network and
start the timer T3520 (see example in figure&nbsp;5.4.1.3.7.1). Furthermore,
the UE shall stop any of the retransmission timers that are running (e.g. T3510,
T3517 or T3521). Upon the first receipt of an AUTHENTICATION FAILURE message
from the UE with the 5GMM cause #21 &quot;synch failure&quot;, the network
shall use the returned AUTS parameter from the authentication failure parameter
IE in the AUTHENTICATION FAILURE message, to re-synchronise. The
re-synchronisation procedure requires the AMF to delete all unused
authentication vectors for that SUPI and obtain new vectors from the UDM/AUSF.
When re-synchronisation is complete, the network shall initiate the 5G AKA
based primary authentication and key agreement procedure. Upon receipt of the
AUTHENTICATION REQUEST message, the UE shall stop the timer T3520, if running.</span></p><p class=NO><span lang=EN-GB>NOTE&nbsp;4:  Upon receipt of two consecutive
AUTHENTICATION FAILURE messages from the UE with 5GMM cause #21 &quot;synch
failure&quot;, the network may terminate the 5G AKA based primary
authentication and key agreement procedure by sending an AUTHENTICATION REJECT
message.</span></p><p class=B1><span lang=EN-GB>      If the network is validated successfully (a
new AUTHENTICATION REQUEST message is received which contains a valid SQN and
MAC) while T3520 is running, the UE shall send the AUTHENTICATION RESPONSE
message to the network and shall start any retransmission timers (e.g. T3510,
T3517 or T3521), if they were running and stopped when the UE received the
first failed AUTHENTICATION REQUEST message.</span></p><p class=B1><span lang=EN-GB>      Upon receipt of an AUTHENTICATION REJECT
message, the UE shall perform the actions as specified in subclause&nbsp;5.4.1.3.5.</span></p><p class=B1><span lang=EN-GB>g)  Network failing the authentication check.</span></p><p class=B1><span lang=EN-GB>      If the UE deems that the network has failed
the authentication check, then it shall request RRC to locally release the RRC
connection and treat the active cell as barred (see 3GPP&nbsp;TS&nbsp;38.304&nbsp;[28]).
The UE shall start any retransmission timers (e.g. T3510, T3517 or T3521), if
they were running and stopped when the UE received the first AUTHENTICATION
REQUEST message containing an invalid MAC or SQN or if the new ngKSI was
already in use.</span></p><p class=EditorsNote><span lang=EN-GB>Editor's</span><span lang=EN-GB> note: It
is FFS if the RRC will provide the barring service.</span></p><p class=B1><span lang=EN-GB>h)  Transmission failure of AUTHENTICATION
RESPONSE message or AUTHENTICATION FAILURE message indication from lower layers
(if the 5G AKA based primary authentication and key agreement procedure is
triggered by a registration procedure for mobility and periodic registration update).</span></p><p class=B1><span lang=EN-GB>      The UE shall stop the timer T3520, if
running, and re-initiate the registration procedure for mobility and periodic registration
update.</span></p><p class=B1><span lang=EN-GB>i)   Transmission failure of AUTHENTICATION
RESPONSE message or AUTHENTICATION FAILURE message indication with TAI change
from lower layers (if the 5G AKA based primary authentication and key agreement
procedure is triggered by a service request procedure).</span></p><p class=B1><span lang=EN-GB>      The UE shall stop the timer T3520, if
running.</span></p><p class=B1><span lang=EN-GB>      If the current TAI is not in the TAI list,
the 5G AKA based primary authentication and key agreement procedure shall be
aborted and a registration procedure for mobility and periodic registration
update shall be initiated.</span></p><p class=B1><span lang=EN-GB>      If the current TAI is still part of the TAI
list, it is up to the UE implementation how to re-run the ongoing procedure
that triggered the 5G AKA based primary authentication and key agreement
procedure.</span></p><p class=B1><span lang=EN-GB>j)   Transmission failure of AUTHENTICATION
RESPONSE message or AUTHENTICATION FAILURE message indication without TAI
change from lower layers (if the authentication procedure is triggered by a
service request procedure).</span></p><p class=B1><span lang=EN-GB>      The UE shall stop the timer T3520, if
running. It is up to the UE implementation how to re-run the ongoing procedure
that triggered the 5G AKA based primary authentication and key agreement procedure.</span></p><p class=B1><span lang=EN-GB>k)  Lower layers indication of non-delivered NAS
PDU due to handover.</span></p><p class=B1><span lang=EN-GB>      If the AUTHENTICATION REQUEST message could
not be delivered due to an intra AMF handover and the target TA is included in
the TAI list, then upon successful completion of the intra AMF handover the AMF
shall retransmit the AUTHENTICATION REQUEST message. If a failure of handover
procedure is reported by the lower layer and the N1 NAS signalling connection
exists, the AMF shall retransmit the AUTHENTICATION REQUEST message.</span></p><p class=MsoNormal><span lang=EN-GB>For items&nbsp;c, d, e, and f whether or
not the UE is registered for emergency services:</span></p><p class=B1><span lang=EN-GB>      The UE shall stop timer T3520, if the timer
is running and the UE enters 5GMM-IDLE mode, e.g. upon detection of a lower
layer failure, release of the N1 NAS signalling connection, or as the result of
an inter-system changer in 5GMM-CONNECTED mode from N1 mode to S1 mode.</span></p><p class=B1><span lang=EN-GB>      The UE shall deem that the network has
failed the authentication check or assume that the authentication is not
genuine and proceed as described in item&nbsp;g above if any of the following
occurs:</span></p><p class=B2><span lang=EN-GB>-    the timer T3520 expires;</span></p><p class=B2><span lang=EN-GB>-    the UE detects any combination of the 5G authentication
failures: 5GMM causes #20 &quot;MAC failure&quot;, #21 &quot;synch failure&quot;,
#26 &quot;non-5G authentication unacceptable&quot; or #29 “ngKSI already in
use”, during three consecutive authentication challenges. The 5G authentication
challenges shall be considered as consecutive only, if the 5G authentication
challenges causing the second and third 5G authentication failure are received
by the UE, while the timer T3520 started after the previous 5G authentication
failure is running.</span></p><p class=MsoNormal><span lang=EN-GB>For items&nbsp;c, d, e, and f:</span></p><p class=B1><span lang=EN-GB>      Depending on local requirements or operator
preference for emergency services, if the UE </span><span lang=EN-GB>has a PDU
session</span><span lang=EN-GB> for emergency services</span><span lang=EN-GB> established</span><span
lang=EN-GB> or is establishing a PDU session for emergency services, the AMF need
not follow the procedures specified for the authentication failure specified in
the present subclause. The AMF may respond to the AUTHENTICATION FAILURE
message by initiating the security mode control procedure selecting the &quot;null
integrity protection algorithm&quot; 5G-IA0, null ciphering algorithm 5G-EA0 or
may abort the 5G AKA based primary authentication and key agreement procedure
and continue using the current security context, if any. The AMF </span><span
lang=EN-GB>shall </span><span lang=EN-GB>release all non-emergency PDU sessions,
if any, by </span><span lang=EN-GB>initiating a PDU session release procedure</span><span
lang=EN-GB>. </span><span lang=EN-GB>If there is an ongoing PDU session
establishment procedure, the AMF shall </span><span lang=EN-GB>release all
non-emergency PDU sessions upon completion of the PDU session establishment procedure</span><span
lang=EN-GB>. </span><span lang=EN-GB>The network shall consider the UE to be
registered for emergency services.</span></p><p class=B1><span lang=EN-GB>      If a UE </span><span lang=EN-GB>has a PDU
session</span><span lang=EN-GB> for emergency services</span><span lang=EN-GB> established</span><span
lang=EN-GB> or is establishing a PDU session for emergency services and sends
an AUTHENTICATION FAILURE message to the AMF with the 5GMM cause appropriate
for these cases (#20, #21, #26, or #29 respectively) and receives the SECURITY
MODE COMMAND message before the timeout of timer T3520, the UE shall deem that
the network has passed the authentication check successfully, stop timer T3520,
respectively, and execute the security mode control procedure.</span></p><p class=B1><span lang=EN-GB>      If a UE </span><span lang=EN-GB>has a PDU session</span><span
lang=EN-GB> for emergency services</span><span lang=EN-GB> established</span><span
lang=EN-GB> or is establishing a PDU session for emergency services when timer
T3520 expires, the UE shall not deem that the network has failed the
authentication check and not behave as described in item g. Instead the UE
shall continue using the current security context, if any, release all
non-emergency PDU sessions, if any, by initiating UE-requested PDU session
release procedure</span><span lang=EN-GB>. If there is an ongoing </span><span
lang=EN-GB>PDU session establishment procedure</span><span lang=EN-GB>, the UE
shall </span><span lang=EN-GB>release all non-emergency PDU sessions</span><span
lang=EN-GB> u</span><span lang=EN-GB>pon completion of </span><span lang=EN-GB>the
</span><span lang=EN-GB>PDU session establishment procedure</span><span
lang=EN-GB>.</span><span lang=EN-GB> The UE shall start any retransmission
timers (e.g. T3510, T3517 or T3521) if:</span></p><p class=B2><span lang=EN-GB>-    they were running and stopped when the UE
received the AUTHENTICATION REQUEST message and detected an authentication
failure;</span></p><p class=B2><span lang=EN-GB>-    the procedures associated with these timers
have not yet been completed.</span></p><p class=B1><span lang=EN-GB>The </span><span lang=EN-GB>UE</span><span
lang=EN-GB> shall consider itself to be registered for emergency services.</span></p></body>
</html>