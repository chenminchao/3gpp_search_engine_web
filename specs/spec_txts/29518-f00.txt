
                                            3GPP TS 29.518 V15.0.0 (2018-06)
                                                     Technical Specification
                                         3rd Generation Partnership Project;
                   Technical Specification Group Core Network and Terminals;
                         5G System; Access and Mobility Management Services;
                                                                     Stage 3
                                                                (Release 15)
  [pic]  [pic]

The present document has been developed within the 3rd Generation
Partnership Project (3GPP TM) and may be further elaborated for the
purposes of 3GPP..
The present document has not been subject to any approval process by the
3GPP Organizational Partners and shall not be implemented.
This Specification is provided for future development work within 3GPP
only. The Organizational Partners accept no liability for any use of this
Specification.
Specifications and Reports for implementation of the 3GPP TM system should
be obtained via the 3GPP Organizational Partners' Publications Offices.











                                  Keywords
                               3GPP, 5G System


                                    3GPP

                               Postal address



                         3GPP support office address
                  650 Route des Lucioles - Sophia Antipolis
                              Valbonne - FRANCE
               Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16

                                  Internet
                             http://www.3gpp.org


                           Copyright Notification

    No part may be reproduced except as authorized by written permission.
  The copyright and the foregoing restriction extend to reproduction in all
                                   media.

  © 2018, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
                                    TTC).
                            All rights reserved.

UMTS™ is a Trade Mark of ETSI registered for the benefit of its members
3GPP™ is a Trade Mark of ETSI registered for the benefit of its Members and
of the 3GPP Organizational Partners
LTE™ is a Trade Mark of ETSI registered for the benefit of its Members and
of the 3GPP Organizational Partners
GSM® and the GSM logo are registered and owned by the GSM Association

         Contents




1  Scope 12

2  References 12

3  Definitions and abbreviations  13
3.1  Definitions  13
3.2  Abbreviations  13

4  Overview 14
4.1  Introduction 14

5  Services offered by the AMF  14
5.1  Introduction 14
5.2  Namf_Communication Service 15
5.2.1  Service Description 15
5.2.2  Service Operations  15
5.2.2.1  Introduction  15
5.2.2.2  UE Context Operations  16
5.2.2.2.1   UEContextTransfer   16
5.2.2.2.1.1 General 16
5.2.2.2.2   RegistrationCompleteNotify  17
5.2.2.2.2.1 General 17
5.2.2.2.3   CreateUEContext  18
5.2.2.2.3.1 General 18
5.2.2.2.4   ReleaseUEContext 18
5.2.2.2.4.1 General 18
5.2.2.3  UE Specific N1N2 Message Operations 19
5.2.2.3.1   N1N2MessageTransfer 19
5.2.2.3.1.1 General 19
5.2.2.3.1.2 When the UE is in CM-IDLE 20
5.2.2.3.2   N1N2MessageTransfer Failure Notification  21
5.2.2.3.3   N1N2MessageSubscribe  21
5.2.2.3.3.1 General 21
5.2.2.3.4   N1N2MessageUnSubscribe  22
5.2.2.3.4.1 General 22
5.2.2.3.5   N1MessageNotify  22
5.2.2.3.5.1 General 22
5.2.2.3.5.2 Using N1MessageNotify in the Registration with AMF Re-
                allocation Procedure   23
5.2.2.3.5.3 Using N1MessageNotify in the UE Assisted and UE Based
                Positioning Procedure  23
5.2.2.3.6   N2InfoNotify 24
5.2.2.3.6.1 General 24
5.2.2.3.6.2 Using N2InfoNotify during Inter NG-RAN node N2 based handover
                procedure   24
5.2.2.3.6.3 Using N2InfoNotify during Location Services procedures 25
5.2.2.4  Non-UE N2 Message Operations 25
5.2.2.4.1   NonUeN2MessageTransfer  25
5.2.2.4.1.1 General 25
5.2.2.4.1.2 Obtaining Non UE Associated Network Assistance Data Procedure
                25
5.2.2.4.1.3 Warning Request Transfer Procedure 26
5.2.2.4.2   NonUeN2InfoSubscribe  26
5.2.2.4.2.1 General 26
5.2.2.4.3   NonUeN2InfoUnSubscribe  27
5.2.2.4.3.1 General 27
5.2.2.4.4   NonUeN2InfoNotify   27
5.2.2.4.4.1 General 27
5.2.2.4.4.2 Using NonUeN2InfoNotify during Location Services procedures
                28
5.2.2.4.4.3 Use of NonUeN2InfoNotify for PWS related events 28
5.2.2.5  AMF Status Change Operations 28
5.2.2.5.1   AMFStatusChangeSubscribe  28
5.2.2.5.1.1 General 28
5.2.2.5.1.2 Creation of a subscription  28
5.2.2.5.1.3 Modification of a subscription 29
5.2.2.5.2   AMFStatusChangeUnSubscribe  30
5.2.2.5.2.1 General 30
5.2.2.5.3   AMFStatusChangeNotify 30
5.2.2.5.3.1 General 30
5.2.2.6  EBIAssignment 31
5.2.2.6.1   General 31
5.3  Namf_EventExposure Service 32
5.3.1  Service Description 32
5.3.2  Service Operations  34
5.3.2.1  Introduction  34
5.3.2.2  Subscribe  34
5.3.2.2.1   General 34
5.3.2.2.2   Creation of a subscription  34
5.3.2.2.3   Modification of a subscription 36
5.3.2.3  Unsubscribe   36
5.3.2.3.1   General 36
5.3.2.4  Notify 37
5.3.2.4.1   General 37
5.4  Namf_MT Service   37
5.4.1  Service Description 37
5.4.2  Service Operations  37
5.4.2.1  Introduction  37
5.4.2.2  EnableUEReachability   38
5.4.2.2.1   General 38
5.4.2.3  ProvideDomainSelectionInfo 38
5.4.2.3.1   General 38
5.5  Namf_Location Service 39
5.5.1  Service Description 39
5.5.2  Service Operations  39
5.5.2.1  Introduction  39
5.5.2.2  ProvideLocation 39
5.5.2.2.1   General 39
5.5.2.3  EventNotify   40
5.5.2.3.1   General 40

6  API Definitions  41
6.1  Namf_Communication Service API 41
6.1.1  API URI  41
6.1.2  Usage of HTTP   41
6.1.2.1  General  41
6.1.2.2  HTTP standard headers  41
6.1.2.2.1   General 41
6.1.2.2.2   Content type 41
6.1.2.3  HTTP custom headers 42
6.1.2.3.1   General 42
6.1.2.4  HTTP multipart messages  42
6.1.3  Resources  43
6.1.3.1  Overview 43
6.1.3.2  Resource: Individual ueContext 44
6.1.3.2.1   Description  44
6.1.3.2.2   Resource Definition 44
6.1.3.2.3   Resource Standard Methods 45
6.1.3.2.3.1 PUT 45
6.1.3.2.4   Resource Custom Operations  46
6.1.3.2.4.1 Overview   46
6.1.3.2.4.2 Operation: (POST) release 46
6.1.3.2.4.2.1 Description  46
6.1.3.2.4.2.2 Operation Definition  46
6.1.3.2.4.3 Operation: (POST) assignEbi 47
6.1.3.2.4.3.1 Description  47
6.1.3.2.4.3.2 Operation Definition  47
6.1.3.2.4.4 Operation: (POST) transfer  48
6.1.3.2.4.4.1 Description  48
6.1.3.2.4.4.2 Operation Definition  48
6.1.3.3  Resource: N1N2 Subscriptions Collection for Individual UE Contexts
           49
6.1.3.3.1   Description  49
6.1.3.3.2   Resource Definition 49
6.1.3.3.3.1 POST  49
6.1.3.3.4   Resource Custom Operations  49
6.1.3.4  Resource: N1N2 Individual Subscription  50
6.1.3.4.1   Description  50
6.1.3.4.2   Resource Definition 50
6.1.3.4.3.1 DELETE  50
6.1.3.4.4   Resource Custom Operations  50
6.1.3.5  Resource: N1 N2 Messages Collection 50
6.1.3.5.1   Description  50
6.1.3.5.2   Resource Definition 50
6.1.3.5.3   Resource Standard Methods 51
6.1.3.5.3.1 POST  51
6.1.3.6  Resource: subscriptions collection  52
6.1.3.6.1   Description  52
6.1.3.6.2   Resource Definition 52
6.1.3.6.3   Resource Standard Methods 53
6.1.3.6.3.1 POST  53
6.1.3.7  Resource: individual subscription 54
6.1.3.7.1   Description  54
6.1.3.7.2   Resource Definition 54
6.1.3.7.3   Resource Standard Methods 54
6.1.3.7.3.1 DELETE  54
6.1.3.7.3.2 PUT 54
6.1.3.8  Resource: Non UE N2Messages Collection  55
6.1.3.8.1   Description  55
6.1.3.8.2   Resource Definition 55
6.1.3.8.3   Resource Standard Methods 55
6.1.3.8.4   Resource Custom Operations  55
6.1.3.8.4.1 Overview   55
6.1.3.8.4.2 Operation: transfer 56
6.1.3.8.4.2.1 Description  56
6.1.3.8.4.2.2 Operation Definition  56
6.1.3.9  Resource: Non UE N2Messages Subscriptions Collection  56
6.1.3.9.1   Description  56
6.1.3.9.2   Resource Definition 56
6.1.3.9.3   Resource Standard Methods 57
6.1.3.9.3.1 POST  57
6.1.3.9.4   Resource Custom Operations  57
6.1.3.10 Resource: Non UE N2 Message Notification Individual Subscription
           57
6.1.3.10.1  Description  57
6.1.3.10.2  Resource Definition 57
6.1.3.10.3  Resource Standard Methods 58
6.1.3.10.3.1  DELETE   58
6.1.3.10.4  Resource Custom Operations  58
6.1.4  Custom Operations without associated resources 58
6.1.5  Notifications   58
6.1.5.1  General  58
6.1.5.2  AMF Status Change Notification 58
6.1.5.2.1   Description  58
6.1.5.2.2   Notification Definition 58
6.1.5.2.3   Notification Standard Methods  59
6.1.5.2.3.1 POST  59
6.1.5.3  Non UE N2 Information Notification  59
6.1.5.3.1   Description  59
6.1.5.3.2   Notification Definition 59
6.1.5.3.3   Notification Standard Methods  59
6.1.5.3.3.1 POST  59
6.1.5.4  N1 Message Notification  60
6.1.5.4.1   Description  60
6.1.5.4.2   Notification Definition 60
6.1.5.4.3   Notification Standard Methods  60
6.1.5.4.3.1 POST  60
6.1.5.5  UE Specific N2 Information Notification 61
6.1.5.5.1   Description  61
6.1.5.5.2   Notification Definition 61
6.1.5.5.3   Notification Standard Methods  61
6.1.5.5.3.1 POST  61
6.1.5.6  N1N2 Message Transfer Failure Notification 61
6.1.5.6.1   Description  61
6.1.5.6.2   Notification Definition 61
6.1.5.6.3   Notification Standard Methods  61
6.1.5.6.3.1 POST  61
6.1.5.7  Registration Complete Notification  62
6.1.5.7.1   Description  62
6.1.5.7.2   Notification Definition 62
6.1.5.7.3   Notification Standard Methods  62
6.1.5.7.3.1 POST  62
6.1.6  Data Model 62
6.1.6.1  General  62
6.1.6.2  Structured data types  65
6.1.6.2.1   Introduction 65
6.1.6.2.2   Type: SubscriptionData  65
6.1.6.2.3   Type: AmfStatusChangeNotification  65
6.1.6.2.4   Type: AmfStatusInfo 66
6.1.6.2.5   Type: AssignEbiData 66
6.1.6.2.6   Type: AssignedEbiData 66
6.1.6.2.7   Type: AssignEbiFailed 66
6.1.6.2.8   Type: UEContextRelease  67
6.1.6.2.9   Type: N2InformationTransferReqData 67
6.1.6.2.10  Type: NonUeN2InfoSubscriptionCreateData 68
6.1.6.2.11  Type: NonUeN2InfoSubscriptionCreatedData  68
6.1.6.2.12  Type: UeN1N2InfoSubscriptionCreateData  69
6.1.6.2.13  Type: UeN1N2InfoSubscriptionCreatedData 69
6.1.6.2.14  Type: N2InformationNotification  69
6.1.6.2.15  Type: N2InfoContainer 70
6.1.6.2.16  Type: N1MessageNotification 70
6.1.6.2.17  Type: N1MessageContainer  70
6.1.6.2.18  Type: N1N2MessageData 71
6.1.6.2.19  Type: N1N2MessageTransferRspData 71
6.1.6.2.20  Type: RegistrationContextContainer 72
6.1.6.2.21  Type: AreaOfValidity  72
6.1.6.2.22  Type: RefToBinaryData 72
6.1.6.2.23  Type: UeContextTransferReqData 72
6.1.6.2.24  Type: UeContextTransferRspData 73
6.1.6.2.25  Type: UeContext  73
6.1.6.2.26  Type: N2SmInformation 74
6.1.6.2.27  Type: N2InfoContent 74
6.1.6.2.28  Type: NrppaInformation  74
6.1.6.2.29  Type: PwsInformation  75
6.1.6.2.30  Type: N1N2MsgTxfrFailureNotification 75
6.1.6.2.31  Type: N1N2MessageTransferError 75
6.1.6.2.32  Type: N1N2MsgTxfrErrDetail  76
6.1.6.2.33  Type: N2InformationTransferRspData 76
6.1.6.2.34  Type: MmContext  77
6.1.6.2.35  Type: SeafData 77
6.1.6.2.36  Type: NasSecurityMode 78
6.1.6.2.37  Type: PduSessionContext 78
6.1.6.2.38  Type: NssaiMapping  78
6.1.6.2.39  Type: UERegCompleteNotifData   78
6.1.6.2.40  Type: AssignEbiError  79
6.1.6.2.41  Type: UeContextCreateData 79
6.1.6.2.42  Type: UeContextCreatedData  79
6.1.6.2.43  Type: UeContextCreateError  79
6.1.6.2.44  Type: NgRanTargetId 80
6.1.6.2.45  Type: N2InformationTransferError 80
6.1.6.2.46  Type: PWSResponseData 80
6.1.6.2.47  Type: PWSErrorData  80
6.1.6.2.48  Type: GlobalRanNodeId 81
6.1.6.2.49  Type: NgKsi  81
6.1.6.2.50  Type: KeyAmf 81
6.1.6.3  Simple data types and enumerations  81
6.1.6.3.1   Introduction 81
6.1.6.3.2   Simple data types   81
6.1.6.3.3   Enumeration: StatusChange 82
6.1.6.3.4   Enumeration: N2InformationClass  83
6.1.6.3.5   Enumeration: N1MessageClass 83
6.1.6.3.6   Enumeration: N1N2MessageTransferCause   83
6.1.6.3.7   Enumeration: UeContextTransferStatus 83
6.1.6.3.8   Enumeration: N2InformationTransferResult  84
6.1.6.3.9   Enumeration: CipheringAlgorithm  84
6.1.6.3.10  Enumeration: IntegrityAlgorithm  84
6.1.6.3.11  Enumeration: SmsSupport 84
6.1.6.3.12  ScType  84
6.1.6.3.13  KeyAmfType 84
6.1.6.3.14  Enumeration: TransferReason 85
6.1.6.4  Binary data   85
6.1.6.4.1   Introduction 85
6.1.6.4.2   N1 Message Content  85
6.1.6.4.3   N2 Information Content  85
6.1.6.4.3.1 Introduction 85
6.1.6.4.3.2 NGAP IEs   85
6.1.6.4.3.3 NGAP Messages  86
6.1.7  Error Handling  87
6.1.7.1  General  87
6.1.7.2  Protocol Errors 87
6.1.7.3  Application Errors  88
6.1.8  Feature Negotiation 88
6.1.9  Security 89
6.2  Namf_EventExposure Service API 89
6.2.1  API URI  89
6.2.2  Usage of HTTP   89
6.2.2.1  General  89
6.2.2.2  HTTP standard headers  89
6.2.2.2.1   General 89
6.2.2.2.2   Content type 89
6.2.2.3  HTTP custom headers 90
6.2.2.3.1   General 90
6.2.3  Resources  90
6.2.3.1  Overview 90
6.2.3.2  Resource: Subscriptions collection  90
6.2.3.2.1   Description  90
6.2.3.2.2   Resource Definition 90
6.2.3.2.3   Resource Standard Methods 91
6.2.3.2.3.1 POST  91
6.2.3.2.4   Resource Custom Operations  91
6.2.3.3  Resource:  Individual subscription  91
6.2.3.3.1   Description  91
6.2.3.3.2   Resource Definition 91
6.2.3.3.3   Resource Standard Methods 92
6.2.3.3.3.1 PATCH 92
6.2.3.3.3.2 DELETE  92
6.2.3.3.4   Resource Custom Operations  93
6.2.4  Custom Operations without associated resources 93
6.2.5  Notifications   93
6.2.5.1  General  93
6.2.5.2   AMF Event Notification  93
6.2.5.2.1   Notification Definition 93
6.2.5.2.3   Notification Standard Methods  93
6.2.5.2.3.1 POST  93
6.2.6  Data Model 94
6.2.6.2  General  94
6.2.6.2  Structured data types  95
6.2.6.2.1   Introduction 95
6.2.6.2.2   Type: AmfEventSubscription  95
6.2.6.2.3   Type: AmfEvent 96
6.2.6.2.4   Type: AmfEventNotification  96
6.2.6.2.5   Type: AmfEventReport  97
6.2.6.2.6   Type: AmfEventMode  97
6.2.6.2.7   Type: AmfEventState 98
6.2.6.2.8   Type: RmInfo 98
6.2.6.2.9   Type: CmInfo 98
6.2.6.2.10  Type: SubscribedData  98
6.2.6.2.11  Type: CommunicationFailure  99
6.2.6.2.12  Type: AmfCreateEventSubscription 99
6.2.6.2.13  Type: AmfCreatedEventSubscription  99
6.2.6.2.14  Type: AmfUpdateEventSubscriptionItem 100
6.2.6.2.15  Type: AmfUpdatedEventSubscription  100
6.2.6.2.16  Type: AmfEventArea  101
6.2.6.3  Simple data types and enumerations  101
6.2.6.3.1   Introduction 101
6.2.6.3.2   Simple data types   101
6.2.6.3.3   Enumeration: AmfEventType 102
6.2.6.3.4   Enumeration: AmfEventTrigger   102
6.2.6.3.5   Enumeration: LocationFilter 103
6.2.6.3.6   Enumeration: SubscribedDataFilter  103
6.2.6.3.7   Enumeration: UeReachability 103
6.2.6.3.8   Enumeration: PresenceState  103
6.2.6.3.9   Enumeration: RmState  103
6.2.6.3.10  Enumeration: CmState  104
6.2.6.4  Binary data   104
6.2.7  Error Handling  104
6.2.7.1  General  104
6.2.7.2  Protocol Errors 104
6.2.7.3  Application Errors  104
6.2.8  Feature Negotiation 104
6.2.9  Security 105
6.3  Namf_MT Service API 105
6.3.1  API URI  105
6.3.2  Usage of HTTP   105
6.3.2.1  General  105
6.3.2.2  HTTP standard headers  105
6.3.2.2.1   General 105
6.3.2.2.2   Content type 105
6.3.2.3  HTTP custom headers 106
6.3.2.3.1   General 106
6.3.3  Resources  106
6.3.3.1  Overview 106
6.3.3.2  Resource: ueReachInd   106
6.3.3.2.1   Description  106
6.3.3.2.2   Resource Definition 106
6.3.3.2.3   Resource Standard Methods 107
6.3.3.2.3.1 PUT 107
6.3.3.2.4   Resource Custom Operations  108
6.3.3.3  Resource: UeContext 109
6.3.3.3.1   Description  109
6.3.3.3.2   Resource Definition 109
6.3.3.3.3   Resource Standard Methods 109
6.3.3.3.3.1 GET 109
6.3.3.3.4   Resource Custom Operations  110
6.3.4  Custom Operations without associated resources 110
6.3.5  Notifications   110
6.3.6  Data Model 110
6.3.6.1  General  110
6.3.6.2  Structured data types  111
6.3.6.2.1   Introduction 111
6.3.6.2.2   Type: EnableUeReachabilityReqData  111
6.3.6.2.3   Type: EnableUeReachabilityRspData  111
6.3.6.2.4   Type: UeContextInfo 111
6.3.6.3.5   Enumeration: UeContextInfoClass  112
6.3.6.3  Simple data types and enumerations  112
6.3.6.3.1   Introduction 112
6.3.6.3.2   Simple data types   112
6.3.6.4  Binary data   112
6.3.7  Error Handling  112
6.3.7.1  General  112
6.3.7.2  Protocol Errors 112
6.3.7.3  Application Errors  112
6.3.8  Feature Negotiation 113
6.3.9  Security 113
6.4  Namf_Location Service API  113
6.4.1  API URI  113
6.4.2  Usage of HTTP   113
6.4.2.1  General  113
6.4.2.2  HTTP standard headers  114
6.4.2.2.1   General 114
6.4.2.2.2   Content type 114
6.4.2.3  HTTP custom headers 114
6.4.2.3.1   General 114
6.4.3  Resources  114
6.4.3.1  Overview 114
6.4.3.2  Resource: Individual UE Context   115
6.4.3.2.1   Description  115
6.4.3.2.2   Resource Definition 115
6.4.3.2.3   Resource Standard Methods 115
6.4.3.2.4   Resource Custom Operations  115
6.4.3.2.4.1 Overview   115
6.4.3.2.4.2 Operation: (POST) provide 115
6.4.3.2.4.2.1 Description  115
6.4.3.2.4.2.2 Operation Definition  115
6.4.4  Custom Operations without associated resources 116
6.4.5  Notifications   116
6.4.5.1  General  116
6.4.5.2  Event Notify  116
6.4.5.2.1   Description  116
6.4.5.2.2   Notification Definition 116
6.4.5.2.3   Notification Standard Methods  117
6.4.5.2.3.1 POST  117
6.4.6  Data Model 117
6.4.6.1  General  117
6.4.6.2  Structured data types  118
6.4.6.2.1   Introduction 118
6.4.6.2.2   Type: RequestUELocation 118
6.4.6.2.3   Type: ProvideUELocation 119
6.4.6.2.4   Type: NotifiedUELocation  120
6.4.6.3  Simple data types and enumerations  120
6.4.6.3.1   Introduction 120
6.4.6.3.2   Simple data types   120
6.4.6.3.3   Enumeration: LocationType 121
6.4.6.3.4   Enumeration: LocationEvent  121
6.4.7  Error Handling  121
6.4.7.1  General  121
6.4.7.2  Protocol Errors 121
6.4.7.3  Application Errors  121
6.4.8  Feature Negotiation 121
6.4.9  Security 122

Annex A (normative):   OpenAPI specification 122
A.1  General  122
A.2  Namf_Communication API  122
A.3  Namf_EventExposure API  143
A.4  Namf_MT  148
A.5  Namf_Location  150

Annex B (informative): Change history 154




         Foreword

This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).

The contents of the present document are subject to continuing work within
the TSG and may change following formal TSG approval. Should the TSG modify
the contents of the present document, it will be re-released by the TSG
with an identifying change of release date and an increase in version
number as follows:

  Version x.y.z

  where:

    x  the first digit:

       1  presented to TSG for information;

       2  presented to TSG for approval;

       3  or greater indicates TSG approved document under change control.

    y  the second digit is incremented for all changes of substance, i.e.
       technical enhancements, corrections, updates, etc.

    z  the third digit is incremented when editorial only changes have been
       incorporated in the document.



         1  Scope

The present document specifies the stage 3 protocol and data model for the
Namf Service Based Interface. It provides stage 3 protocol definitions and
message flows, and specifies the API for each service offered by the AMF.

The 5G System stage 2 architecture and procedures are specified in
3GPP TS 23.501 [2] and 3GPP TS 23.502 [3].

The Technical Realization of the Service Based Architecture and the
Principles and Guidelines for Services Definition are specified in
3GPP TS 29.500 [4] and 3GPP TS 29.501 [5].


2  References

  [1]  3GPP TR 21.905: "Vocabulary for 3GPP Specifications".

  [2]  3GPP TS 23.501: "System Architecture for the 5G System; Stage 2".

  [3]  3GPP TS 23.502: "Procedures for the 5G System; Stage 2".

  [4]  3GPP TS 29.500: "5G System; Technical Realization of Service Based
             Architecture; Stage 3".

  [5]  3GPP TS 29.501: "5G System; Principles and Guidelines for Services
             Definition; Stage 3".

  [6]  3GPP TS 29.571: "5G System; Common Data Types for Service Based
             Interfaces Stage 3".

  [7]  3GPP TS 23.503: "Policy and Charging Control Framework for the 5G
             System; Stage 2".

  [8]  IETF RFC 8259: "The JavaScript Object Notation (JSON) Data
             Interchange Format".

  [9]  IETF RFC 2387: "The MIME Multipart/Related Content-type".

  [10] IETF RFC 2045: "Multipurpose Internet Mail Extensions (MIME) Part
             One: Format of Internet Message Bodies".

  [11] 3GPP TS 24.501: "Non-Access-Stratum (NAS) Protocol for 5G System
             (5GS); Stage 3".

  [12] 3GPP TS 38.413: "NG Radio Access Network (NG-RAN); NG Application
             Protocol (NGAP)".

  [13] 3GPP TS 36.355: "Evolved Universal Terrestrial Radio Access (E-
             UTRA); LTE Positioning Protocol (LPP)".

  [14] 3GPP TS 29.510: "Network Function Repository Services; Stage 3".

  [15] 3GPP TS 24.007: "Mobile radio interface signalling layer 3; General
             Aspects".

  [16] 3GPP TS 29.502: "5G System, Session Management Services; Stage 3".

  [17] 3GPP TS 38.455: "NR Positioning Protocol A (NRPPa)".

  [18] 3GPP TS 29.531: "Network Slice Selection Services; Stage 3".

  [19] IETF RFC 7540: "Hypertext Transfer Protocol Version 2 (HTTP/2)".

  [20] 3GPP TS 23.041: "Technical realization of Cell Broadcast Service
             (CBS)"

  [21] 3GPP TS 29.168: "Cell Broadcast Centre interfaces with the Evolved
             Packet Core; Stage 3"

  [22] 3GPP TS 24.008: "Mobile radio interface Layer 3 specification; Core
             network protocols; Stage 3"

  [23] OpenAPI Initiative, "OpenAPI 3.0.0 Specification",
             https://github.com/OAI/OpenAPI-
             Specification/blob/master/versions/3.0.0.md

  [24] 3GPP TS 36.413: "Evolved Universal Terrestrial Radio Access Network
             (E-UTRAN); S1 Application Protocol (S1AP)"

  [25] 3GPP TS 29.572: "5G System, Location Management Services; Stage 3".

  [26] 3GPP TS 33.501: "Security architecture and procedures for 5G
             system".

  [27] 3GPP TS 33.501: "Security architecture and procedures for 5G
             system".

  [28] IETF RFC 6749: "The OAuth 2.0 Authorization Framework".

  [29] 3GPP TS 29.510: "Network Function Repository Services; Stage 3".


3  Definitions and abbreviations


3.1  Definitions

For the purposes of the present document, the terms and definitions given
in 3GPP TR 21.905 [1] and the following apply. A term defined in the
present document takes precedence over the definition of the same term, if
any, in 3GPP TR 21.905 [1].

example: text used to clarify abstract rules by applying them literally.


3.2  Abbreviations

For the purposes of the present document, the abbreviations given in
3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in 3GPP TR 21.905 [1].

  5GC  5G Core Network
  5GS  5G System
  5G-AN  5G Access Network
  5G-GUTI  5G Globally Unique Temporary Identifier
  5QI  5G QoS Identifier
  AMF  Access and Mobility Management Function
  EBI  EPS Bearer Identity
  GAD  Universal Geographical Area Description
  GPSI Generic Public Subscription Identifier
  GUAMI  Globally Unique AMF Identifier
  JSON JavaScript Object Notation
  LADN Local Area Data Network
  LMF  Location Management Function
  MM Mobility Management
  N3IWF  Non-3GPP InterWorking Function
  NEF  Network Exposure Function
  NR New Radio
  NRF  Network Repository Function
  NRPPa  NR Positioning Protocol A
  NSI ID Network Slice Instance Identifier
  NSSAI  Network Slice Selection Assistance Information
  PCF  Policy Control Function
  PEI  Permanent Equipment Identifier
  RAT  Radio Access Type
  RFSP RAT/Frequency Selection Priority
  SARI Service Area Restriction Information
  SBI  Service Based Interface
  SM Session Management
  SMF  Session Management Function
  SMSF Short Message Service Function
  S-NSSAI  Single Network Slice Selection Assistance Information
  SUCI Subscription Concealed Identifier
  SUPI Subscription Permanent Identifier
  TA Tracking Area
  TAI  Tracking Area Identity
  UDM  Unified Data Management
  UDSF Unstructured Data Storage Function

4  Overview


4.1  Introduction

Within the 5GC, the AMF offers services to the SMF, other AMF, PCF, SMSF,
LMF, GMLC, CBCF, PWS-IWF and NEF via the Namf service based interface (see
3GPP TS 23.501 [2] and 3GPP TS 23.502 [3]).

Figure 4.1-1 provides the reference model (in service based interface
representation and in reference point representation), with focus on the
AMF and the scope of the present specification.



                                    [pic]

                     Figure 4.1-1: Reference model – AMF

The functionalities supported by the AMF are listed in subclause 6.2.1 of
3GPP TS 23.501 [2].


5  Services offered by the AMF


5.1  Introduction

The table 5.1-1 shows the AMF Services and AMF Service Operations:

                      Table 5.1-1 List of AMF Services

|Service Name   |Service Operations  |Operation     |Example Consumer(s)    |
|               |                    |Semantics     |                       |
|Namf_Communicat|UEContextTransfer   |Request/Respon|Peer AMF               |
|ion            |                    |se            |                       |
|               |RegistrationComplete|Subscribe/Noti|Peer AMF               |
|               |Notify              |fy            |                       |
|               |N1MessageNotify     |Subscribe/Noti|AMF, LMF,              |
|               |                    |fy            |                       |
|               |N1N2MessageSubscribe|              |                       |
|               |N1N2MessageUnSubscri|              |                       |
|               |be                  |              |                       |
|               |N1N2MessageTransfer |Request/Respon|SMF, SMSF, LMF         |
|               |                    |se            |                       |
|               |NonUeN2MessageTransf|Request/Respon|LMF, CBCF, PWS-IWF     |
|               |er                  |se            |                       |
|               |NonUeN2InfoSubscribe|Subscribe/Noti|CBCF, PWS-IWF          |
|               |                    |fy            |                       |
|               |NonUeN2InfoUnSubscri|              |                       |
|               |be                  |              |                       |
|               |N2InfoNotify        |              |LMF, AMF               |
|               |NonUeN2InfoNotify   |              |LMF, CBCF, PWS-IWF     |
|               |EBIAssignment       |Request/Respon|SMF                    |
|               |                    |se            |                       |
|               |AMFStatusChangeSubsc|Subscribe /   |SMF, PCF, NEF, SMSF,   |
|               |ribe                |Notify        |UDM                    |
|               |AMFStatusChangeUnSub|Subscribe /   |SMF, PCF, NEF, SMSF,   |
|               |scribe              |Notify        |UDM                    |
|               |AMFStatusChangeNotif|Subscribe /   |SMF, PCF, NEF, SMSF,   |
|               |y                   |Notify        |UDM                    |
|Namf_EventExpos|Subscribe (see NOTE |Subscribe/Noti|NEF, SMF, PCF, UDM     |
|ure            |1)                  |fy            |                       |
|               |Unsubscribe (see    |Subscribe/Noti|NEF, SMF, PCF, UDM     |
|               |NOTE 1)             |fy            |                       |
|               |Notify              |Subscribe/Noti|NEF, SMF, PCF, UDM     |
|               |                    |fy            |                       |
|Namf_MT        |EnableUEReachability|Request/Respon|SMSF                   |
|               |                    |se            |                       |
|Namf_Location  |ProvideLocation     |Request/Respon|GMLC                   |
|               |                    |se            |                       |
|               |EventNotify         |Subscribe /   |GMLC                   |
|               |                    |Notify        |                       |
|NOTE 1: A subscription applies for one UE, group of UE(s) or any UE.       |



5.2  Namf_Communication Service


5.2.1  Service Description

This service enables an NF to communicate with the UE through N1 NAS
messages or with the AN (both UE and non UE specific). The service
operations defined below allow the NF to communicate with the UE and the
AN. The following are the key functionalities of this NF service.

  -  Provide service operations for transporting N1 messages to the UE;

  -  Allow NFs to subscribe and unsubscribe for notifications of specific
    N1 messages from the UE;

  -  Allow NFs to subscribe and unsubscribe for notifications about
    specific information from AN;

  -  Provide service operations for initiating N2 messages towards the AN;

  -  Security Context Management; and

  -  UE information management and transfer (including its security
    context).


5.2.2  Service Operations


5.2.2.1  Introduction

The Namf_Communication service supports following service operations:

  - UEContextTransfer

  - RegistrationCompleteNotify

  - N1N2MessageTransfer (UE Specific)

  - N1N2MessageSubscribe (UE Specific)

  - N1N2MessageUnsubscribe (UE Specific)

  - N1MessageNotify (UE Specific)

  - N2InfoNotify (UE Specific)

  - NonUeN2MessageTransfer

  - NonUeN2InfoSubscribe

  - NonUeN2INfoUnsubscribe

  - N2InfoNotify

  - EBIAssignment

  - CreateUEContext

  - ReleaseUEContext

  - AMFStatusChangeSubscribe

  - AMFStatusChangeUnsubscribe

  - AMFStatusChangeNotify


5.2.2.2  UE Context Operations


5.2.2.2.1   UEContextTransfer


5.2.2.2.1.1 General

The UEContextTransfer service operation is used during the following
procedure:

  -  General Registration procedure (see 3GPP TS 23.502 [3], subclause
    4.2.2.2.2)

The UEContextTransfer service operation is invoked by a NF Service
Consumer, e.g. a target AMF, towards the AMF (acting as source AMF), when
the target AMF receives a Registration Request with the UE's 5G-GUTI
included and the serving AMF has changed since last registration, to
retrieve the UE Context, e.g. the UE's SUPI and MM Context, in the source
AMF.

The NF Service Consumer (e.g. the target AMF) shall retrieve the UE Context
by invoking the "transfer" custom method on the URI of an "Individual
ueContext" resource, see subclause 6.1.3.2.4. See also Figure 5.2.2.2.1.1-
1.

                                    [pic]

                  Figure 5.2.2.2.1.1-1 UE Context Transfer

  1. The NF Service Consumer, e.g. target AMF, shall send a HTTP POST
    request to invoke "transfer" custom method on an "Individual ueContext"
    resource URI. The payload of the request shall be an object of
    "UeContextTranferReqData" data type.

     If UE Context Transfer is triggered by UE initial registration or
    mobility registration, the NF Service Consumer, e.g. target AMF, shall
    set the reason attribute to "INIT_REG" or "MOBI_REG" and include the
    integrity protected registration request message which triggers the UE
    context transfer in the payload.

     If the UE has already been authenticated, the NF Service Consumer,
    e.g. target AMF, shall set the reason attribute to
    "MOBI_REG_UE_VALIDATED".

  2a.  On success:

    -  if the reason attribute is "INIT_REG" and integrity check is
       successful, the (source) AMF shall respond with the status code "200
       OK". The payload of the response shall be an object of
       "UeContextTransferRspData" data type, containing the representation
       of the requested UE Context without PDU Session Contexts.

    -  If the reason attribute is "MOBI_REG" and integrity check is
       successful, or if the reason attribute is "MOBI_REG_UE_VALIDATED",
       the (source) AMF shall respond with the status code "200 OK". The
       payload of the response shall be an object of
       "UeContextTransferRspData" data type, containing the representation
       of the complete UE Context including available PDU Session Contexts.

     The response payload shall also include a callback URI to receive the
    notification of RegistrationCompleteNotity service operation (see
    subclause 5.2.2.3).

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.1.3.2.4.4.2-2 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.1.3.2.4.4.2-2.


5.2.2.2.2   RegistrationCompleteNotify


5.2.2.2.2.1 General

The RegistrationCompleteNotify service operation is used during the
following procedure:

  -  General Registration procedure (see 3GPP TS 23.502 [3], subclause
    4.2.2.2.2)

  -  Registration with AMF re-allocation procedure (see 3GPP TS 23.502 [3],
    subclause 4.2.2.2.3)

The RegistrationCompleteNotify service operation is invoked by a NF Service
Producer, i.e. the target AMF, towards the NF Service Consumer, e.g. the
source AMF, to notify the status of UE registration at the target AMF,
thereby indicating the result of previous UE Context transfer for a given
UE (see subclause 5.2.2.2.1.1).

The target AMF shall notify the NF Service Consumer (e.g. source AMF) the
status of the UE registration at the target AMF due to a previous UE
Context transfer. The target AMF shall use the HTTP method POST on the
notification callback URI provided by the NF Service Consumer (e.g. source
AMF) during a previous UE context transfer (see subclause 5.2.2.2.1.1). See
also Figure 5.2.2.2.2.1-1.

                                    [pic]

              Figure 5.2.2.2.2.1-1 Registration Complete Notify

1. The target AMF, shall send a POST request on the notification callback
  URI obtained during an earlier UE context transfer request, to notify the
  NF Service Consumer of the status of the UE registration at the target
  AMF. The UE's 5G-GUTI is included as the UE identity, in the notification
  payload. Once the notification is received, the NF Service Consumer (e.g.
  AMF) shall:

   - remove the individual ueContext resource if the ueContextTransferStatus
     attribute included in the notification is set to "TRANSFERRED". The
     source AMF may choose to start a timer to supervise the release of the
     UE context resource and may keep the individual ueContext resource
     until the timer expires.

   - shall keep the UE Context as if the context transfer procedure had not
     happened if the ueContextTransferStatus attribute included in the
     notification is set to "NOT_TRANSFERRED".

  2. The NF Service Consumer (e.g. source AMF) shall respond with the
    status code "204 No Content" if the request is accepted.


5.2.2.2.3   CreateUEContext


5.2.2.2.3.1 General

The CreateUEContext service operation is used during the following
procedure:

  -  Inter NG-RAN node N2 based handover (see 3GPP TS 23.502 [3], subclause
    4.9.1.3)

The CreateUEContext service operation is invoked by a NF Service Consumer,
e.g. a source AMF, towards the AMF (acting as target AMF), when the source
AMF can't serve the UE and selects the target AMF during the handover
procedure, to create the UE Context in the target AMF.

The NF Service Consumer (e.g. the source AMF) shall create the UE Context
by using the HTTP PUT method with the URI of the "Individual UeContext"
resource (See subclause 6.1.3.2.3.1). See also Figure 5.2.2.2.3.1-1.

                                    [pic]

                   Figure 5.2.2.2.3.1-1 Create UE Context

  1. The NF Service Consumer, e.g. source AMF, shall send a PUT request, to
    create the ueContext in the target AMF. The payload body of the PUT
    request shall contain a callback URI.

  2a.  On success, the target AMF shall respond with the status code "201
    Created" if the request is accepted, together with a HTTP Location
    header to provide the location of a newly created resource. The payload
    body of the PUT response shall contain the representation of the
    created UE Context.

   2b. On failure or redirection, one of the HTTP status code listed in
  Table 6.1.3.2.3.1-3 shall be returned. For a 4xx/5xx response, the
  message body shall contain a UeContextCreateError structure, including:

    -  a ProblemDetails structure with the "cause" attribute set to one of
       the application error listed in Table 6.1.3.2.3.1-3;

    -  NgAPCause, if available.


5.2.2.2.4   ReleaseUEContext


5.2.2.2.4.1 General

The ReleaseUEContext service operation is used during the following
procedure:

  -  Inter NG-RAN node N2 based handover, Cancel procedure (see
    3GPP TS 23.502 [3], subclause 4.9.1.4)

The ReleaseUEContext service operation is invoked by a NF Service Consumer,
e.g. a source AMF, towards the AMF (acting as target AMF), when the source
AMF receives the Handover Cancel from the 5G-AN during the handover
procedure, to release the UE Context in the target AMF.

The NF Service Consumer (e.g. the source AMF) shall release the UE Context
by using the HTTP "release" custom operation with the URI of the
"Individual UeContext" resource (See subclause 6.1.3.2.4.2). See also
Figure 5.2.2.2.4.1-1.

                                    [pic]

                   Figure 5.2.2.2.4.1-1 Release UE Context

  1. The NF Service Consumer, e.g. source AMF, shall send a POST request,
    to release the ueContext in the target AMF. The payload body of the
    POST request shall contain any data that needs to be passed to the
    target AMF.

  2a.  On success, the target AMF shall return "204 No Content" with an
    empty payload body in the POST response.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.1.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.1.3.2.4.2.2-2.


5.2.2.3  UE Specific N1N2 Message Operations


5.2.2.3.1   N1N2MessageTransfer


5.2.2.3.1.1 General

The N1N2MessageTransfer service operation is used by a NF Service Consumer
to transfer N1 and/or N2 information to the UE and/or 5G-AN through the AMF
in the following procedures:

  -  Network triggered Service Request (see subclause 4.2.3.4 in
    3GPP TS 23.502 [3]

  -  PDU Session establishment (See subclause 4.3.2 in 3GPP TS 23.502 [3])

  -  PDU Session modification (See subclause 4.3.3 in 3GPP TS 23.502 [3])

  -  PDU Session release (See subclause 4.3.4 in 3GPP TS 23.502 [3])

  -  Session continuity, service continuity and UP path management (See
    subclause 4.3.4 in 3GPP TS 23.502 [3])

  -  SMS over NAS procedures (See subclause 4.13.3 in 3GPP TS 23.502 [3]

  -  UE assisted and UE based positioning procedure (See subclause 4.13.5.4
    in 3GPP TS 23.502 [3])

  -  Network assisted positioning procedure (See subclause 4.13.5.5 in
    3GPP TS 23.502 [3])

The NF Service Consumer shall invoke the service operation by using HTTP
method POST, to request the AMF to transfer N1 and/or N2 information for a
UE and/or 5G-AN, with the URI of "N1 N2 Messages Collection" resource (See
subclause 6.1.3.10.3.1).

The NF Service Consumer may include the following information in the HTTP
Request message body:

  -  SUPI

  -  PDU Session ID or LCS Co-relation ID depending on the N1/N2 message
    class to be transferred

  -  N2 SM Information (PDU Session ID, QoS profile, CN N3 Tunnel Info, S-
    NSSAI)

  -  N1 SM Information

  -  N1 Message Container (e.g. LPP message, SMS)

  -  N2 Information Container (e.g. NRPPa message)

  -  Allocation and Retention Priority (ARP)

  -  Paging Policy Indication

  -  5QI-  Notification URL (used for receiving Paging Failure Indication)

  -  RAT and/or AN type for the PDU Session

  -  Last Message Indication

                                    [pic]

     Figure 5.2.2.3.1.1-1 N1N2MessageTransfer for UE related signalling

  1. The NF Service Consumer shall send a POST request to transfer N1 and
    N2 information. The NF Service Consumer may include a
    N1N2MessageTransfer Notification URI to AMF in the request message.

  2a.  On success, i.e. if the request is accepted and the AMF is able to
    transfer the N1/N2 message to the UE and/or the AN, the AMF shall
    respond with a “200 OK” status code. The AMF shall set the cause IE in
    the N1N2MessageTransferRspData as "N1_N2_TRANSFER_INITIATED" in this
    case.

  2b. On failure or redirection, one of the HTTP status code listed in
    Table 6.1.3.5.3.1-3 shall be returned. For a 4xx/5xx response, the
    message body shall contain a N1N2MessageTransferError structure,
    including:

    -  a ProblemDetails structure with the "cause" attribute set to one of
       the application error listed in Table 6.1.3.5.3.1-3;


5.2.2.3.1.2 When the UE is in CM-IDLE

When the N1N2MessageTransfer service operation is invoked by a NF Service
Consumer for a UE in CM-IDLE state, the requirements specified in subclause
5.2.2.3.1.1 shall apply with the following modifications and definitions:

  -  Same as step 2a of Figure 5.2.2.3.1.1-1, the AMF shall respond with
    the status code "202 Accepted", if the asynchronous type communication
    is invoked and hence the UE is not paged, update the UE context and
    store N1 and/or N2 information and initiate communication with the UE
    and/or 5G-AN when the UE becomes reachable. In this case the AMF shall
    provide the URI of the resource in the AMF in the "Location" header of
    the response, which holds the status of the N1/N2 message transfer and
    a pointer to the stored N1/N2 message. The AMF shall also provide a
    response body containing the cause, "WAITING_FOR_ASYNCHRONOUS_TRANSFER"
    that represents the current status of the N1/N2 message transfer;

  -  Same as step 2a of Figure 5.2.2.3.1.1-1, the AMF shall respond with
    the status code "202 Accepted", if the UE is in 3GPP access and paging
    is issued, with a response body that carries a cause
    ATTEMPTING_TO_REACH_UE as specified in subclause 4.2.3.3 and 5.2.2.2.7
    of 3GPP TS 23.502 [3]. The NF Service Consumer shall not send any
    further signalling for the UE if it receives a POST response body
    ATTEMPTING_TO_REACH_UE unless it has higher priority signalling. The
    response shall include the "Location" header containing the URI of the
    resource created in the AMF, which holds the status of the N1/N2
    message transfer, e.g. ".../n1-n2-messages/{n1N2MessageId}". The AMF:

    -  shall store the N1 and/or N2 information and, when the UE responds
       with a Service Request, shall initiate communication with the UE
       and/or 5G-AN using the stored N1 and/or N2 information; or

    -  shall notify the NF which invoked the service operation, as
       specified in subclause 5.2.2.3.2, when the AMF determines that the
       paging has failed and if the Notification URI is provided,

  -  Same as step 2b of Figure 5.2.2.3.1.1-1, the AMF shall respond with
    status code "409 Conflict", if the UE is in 3GPP access and there is
    already an ongoing paging procedure with higher or same priority. The
    AMF shall set the application error as "
    HIGHER_PRIORITY_REQUEST_ONGOING" in the cause attribute of the
    ProblemDetails structure of the POST response body. The AMF may provide
    a retry timer value to the NF Service Consumer in order for the NF
    Service Consumer to retry the request after the expiry of the timer.
    When the retry timer is provided, the NF Service Consumer shall not
    initiate the downlink messaging until the timer expires. The AMF may
    also provide the ARP value of the QoS flow that has triggered the
    currently ongoing highest priority paging, so that the NF Service
    Consumer (e.g SMF) knows that if any subsequent trigger initiating
    downlink messaging for a QoS flow with the same or lower priority
    happens.

  -  Same as step 2b of Figure 5.2.2.3.1.1-1, the AMF shall respond with
    the status code "504 Gateway Timeout", if the paging is not performed.
    The AMF shall set the POST response body as specified in subclause
    6.1.3.10.3.1.


5.2.2.3.2   N1N2MessageTransfer Failure Notification

The AMF uses this notification to inform the NF service consumer that
initiated an earlier Namf_Communication_N1N2MessageTransfer, that the AMF
failed to deliver the N1 message to the UE as the UE failed to respond to
paging. The HTTP POST method shall be used on the notification callback URI
provided by the NF service consumer as specified in subclause 5.2.2.3.1.2.

                                    [pic]

 Figure 5.2.2.3.2-1 N1N2MessageTransfer Failure Notification for UE related
                                 signalling

  1. When the AMF determines that the paging has failed and if the NF
    service consumer had provided a notification URI (see subclause
    5.2.2.3.1.2), the AMF shall send a POST request to the NF Service
    Consumer on that Notification URI. The AMF shall include the
    N1N2MessageTransfer request resource URI returned earlier (see
    5.2.2.3.1.3) in the POST request body. The AMF shall also include a
    N1/N2 message transfer cause information in the POST request body. The
    NF Service Consumer shall delete any stored representation of the
    N1N2MessageTransfer request resource URI upon receiving this
    notification.

  2. The NF Service Consumer shall send a response with “204 No Content”
    status code.


5.2.2.3.3   N1N2MessageSubscribe


5.2.2.3.3.1 General

The N1N2MessageSubscribe service operation is used by a NF Service Consumer
(e.g. LMF) to subscribe to the AMF for notifying N1 messages of a specific
type (e.g. LPP) or N2 information of a specific type (e.g. NRPPa).

An NF Service Consumer (e.g. LMF) may subscribe to notifications of
specific N1 message type (e,g LPP) or N2 information type (e.g. NRPPa). In
this case the NF Service Consumer shall subscribe by using the HTTP POST
method with the URI of the "N1N2 Subscriptions Collection for Individual UE
Contexts" resource (See subclause 6.1.3.6.3.1). See also Figure 5.2.2.3.3.1-
1.

                                    [pic]

                 Figure 5.2.2.3.3.1-1 N1N2 Message Subscribe

  1. The NF Service Consumer shall send a POST request to create a
    subscription resource in the AMF for a UE specific N1/N2 message
    notification. The payload body of the POST request shall contain:

    -  N1 and/or N2 Message Type, identifying the type of N1 and/or N2
       message to be notified

    -  A callback URI for the notification

  2. If the request is accepted, the AMF shall include a HTTP Location
    header to provide the location of a newly created resource
    (subscription) together with the status code 201 indicating the
    requested resource is created in the response message.


5.2.2.3.4   N1N2MessageUnSubscribe


5.2.2.3.4.1 General

The N1N2MessageUnSubscribe service operation is used by a NF Service
Consumer (e.g. LMF) to unsubscribe to the AMF to stop notifying N1 messages
of a specific type (e.g. LPP).

The NF Service Consumer shall use the HTTP method DELETE with the URI of
the " N1N2 Individual Subscription" resource (See subclause 6.1.3.7.3.1),
to request the deletion of the subscription for the N1 / N2 message towards
the AMF. See also Figure 5.2.2.3.4.1-1.

                                    [pic]

                Figure 5.2.2.3.4.1-1 N1N2 Message UnSubscribe

  1. The NF Service Consumer shall send a DELETE request to delete an
    existing subscription resource in the AMF.

  2. If the request is accepted, the AMF shall reply with the status code
    204 indicating the resource identified by subscription ID is
    successfully deleted, in the response message.


5.2.2.3.5   N1MessageNotify


5.2.2.3.5.1 General

The N1MessageNotify service operation is used by a AMF notifying the N1
message received from the UE to a destination CN NF, and it is used in the
following procedures:

  -  Registration with AMF re-allocation (See subclause 4.2.2.2.3 in
    3GPP TS 23.502 [3])

  -  UE assisted and UE based positioning procedure (See subclause 4.13.5.4
    in 3GPP TS 23.502 [3])

The AMF shall use HTTP POST method to the N1 Notification URI provided by
the NF Service Consumer via N1N2MessageSubscribe service operation (See
subclause 5.2.2.3.3). See also figure 5.2.2.3.5.1-1.

                                    [pic]

                   Figure 5.2.2.3.5.1-1 N1 Message Notify

  1. The AMF shall send a HTTP POST request to the N1 Notification URI, and
    the payload body of the POST request shall contain an
    N1MessageNotificatoin data structure with the subscribed N1 message.

  2a.  On success, "204 No Content" shall be returned and the payload body
    of the POST response shall be empty.

  2b.  On failure, one of the HTTP status code listed in Table 6.1.5.6.3.1-
    2 shall be returned. The message body shall contain a ProblemDetails
    object with "cause" set to one of the corresponding application errors
    listed in Table 6.1.5.6.3.1-2.


5.2.2.3.5.2 Using N1MessageNotify in the Registration with AMF Re-
                allocation Procedure

In the Registration with AMF re-allocation procedure, the N1MessageNotify
service operation is invoked by a NF Service Producer, i.e. an Initial AMF,
towards a NF Service Consumer, e.g. the target AMF, which is selected to
serve the UE, by the initial AMF.

The requirements specified in subclause 5.2.2.3.5.1 shall apply with the
following modifications:

  1. The initial AMF discovers the N1 Notification URI of the NF Service
    Consumer (e.g. the target AMF) from the NRF (See subclause 6.1.6.2.4 of
    3GPP TS 29.510 [14]).

  NOTE: The alternate AMF is expected to have registered a callback URI
         with the NRF.

  2. Same as step 1 of Figure 5.2.2.3.5.1-1, the request payload shall
    include the following information in the HTTP POST Request message
    body:

    -  RAN NGAP ID and; (the information enabling (R)AN to identify the N2
       terminating point)

    -  the N1 message;

    -  the UE's SUPI and MM Context;

    -  the Allowed NSSAI together with the corresponding NSI IDs (if
       network slicing is used and the initial AMF has obtained).


5.2.2.3.5.3 Using N1MessageNotify in the UE Assisted and UE Based
                Positioning Procedure

In the UE assisted and UE based positioning procedure, the N1MessageNotify
service operation is invoked by the AMF, towards the LMF, which had
subscribed for delivering the N1 UE positioning messages for the UE to be
notified.

The requirements specified in subclause 5.2.2.3.5.1 shall apply with the
following modifications:

  1. Same as step 1 of Figure 5.2.2.3.5.1-1, the request payload shall
    include the following information:

    -  the N1 Uplink Positioning Message;

    -  LCS co-relation identifier.



                   Figure 5.2.2.3.5.3-1 N1 Message Notify

  1.


5.2.2.3.6   N2InfoNotify


5.2.2.3.6.1 General

The N2InfoNotify service operation is used during the following procedure:

  -  Inter NG-RAN node N2 based handover procedure (see 3GPP TS 23.502 [3],
    subclause 4.9.1.3.3)

  -  Network assisted positioning procedure (See subclause 4.13.5.5 in
    3GPP TS 23.502 [3])

The N2InfoNotify service operation is invoked by AMF, to notify a NF
Service Consumer that subscribed N2 information has been received from
access network.

The AMF shall use HTTP POST method to the N2Info Notification URI provided
by the NF Service Consumer via N1N2MessageSubscribe service operation (See
subclause 5.2.2.3.3). See also figure 5.2.2.3.6.1-1.

                                    [pic]

                 Figure 5.2.2.3.6.1-1 N2 Information Notify

  1. The AMF shall send a HTTP POST request to the n2InfoNotifyUrl, and the
    payload body of the POST request shall contain a
    N2InformationNotification data structure, containing the N2 information
    that was subscribed by the NF Service Consumer.

  2a.  On success, "204 No Content" shall be returned and the payload body
    of the POST response shall be empty.

  2b.  On failure, one of the HTTP status code listed in Table 6.1.5.6.3.1-
    2 shall be returned. The message body shall contain a ProblemDetails
    object with "cause" set to one of the corresponding application errors
    listed in Table 6.1.5.6.3.1-2.


5.2.2.3.6.2 Using N2InfoNotify during Inter NG-RAN node N2 based handover
                procedure

The N2InfoNotify service operation is invoked by a NF Service Producer,
e.g. the target AMF, towards the NF Service Consumer, i.e. the source AMF,
to notify that the handover procedure has been successful in the target
side, for a given UE.

The requirements specified in subclause 5.2.2.3.6.1 shall apply with the
following modifications:

  1.   During inter AMF handover procedure, the source AMF, which is served
    as a NF Service Consumer, when consuming the CreateUEContext service
    operation (See subclause 5.2.2.2.3), shall include a N2Info
    Notification URI to the target AMF in the HTTP request message.

  2. Same as step 1 of Figure 5.2.2.3.6.1-1, the request payload shall
    contain shall contain the notification payload (see subclause 6.1.5.5),
    with the information that the handover is complete. The
    n2NotifySubscriptionId included in the notification payload shall be
    the UE context Id.

  NOTE:  This notification is due to an implicit subscription and hence no
         explicit subscription Id is created. UE context Id is included as
         the notification subscription Id for the NF Service Consumer (e.g.
         Source AMF) to co-relate the notification to an earlier initiated
         UE context transfer during a handover procedure.


5.2.2.3.6.3 Using N2InfoNotify during Location Services procedures

The N2InfoNotify service operation is invoked by a NF Service Producer,
i.e. the AMF, towards the NF Service Consumer, e.g. the LMF, to notify the
positioning parameters received from the 5G-AN in the NRPPa message.

 The requirements specified in subclause 5.2.2.3.6.1 shall apply with the
following modifications:

  1. Same as step 1 of Figure 5.2.2.3.6.1-1, the request payload shall
    contain N2 information of type NRPPa.


5.2.2.4  Non-UE N2 Message Operations


5.2.2.4.1   NonUeN2MessageTransfer


5.2.2.4.1.1 General

The NonUeN2MessageTransfer service operation is used by a NF Service
Consumer to transfer N2 information to the 5G-AN through the AMF in the
following procedures:

  -  Obtaining non-UE associated network assistance data (See subclause
    4.13.5.6 in 3GPP TS 23.502 [3])

  -  Warning Request Transfer procedures (See subclause 9A in 3GPP TS
    23.041 [20])

The NF Service Consumer shall invoke the service operation by sending POST
to the URI of the "transfer" customer operation on the "Non UE N2Messages
Collection" resource (See subclause 6.1.3.8.4.2) on the AMF. See also
figure 5.2.2.4.1.1-1.

                                    [pic]

               Figure 5.2.2.4.1.1-1 Non-UE N2 Message Transfer

  1. The NF Service Consumer shall invoke the custom operation for non UE
    associated N2 message transfer by sending a HTTP POST request, and the
    request body shall carry the N2 information to be transferred.

  2a.  On success, AMF shall respond a "200 OK" status code with
    N2InformationTransferRspData data structure.

  2b.  On failure, one of the HTTP status code listed in Table
    6.1.3.58.4.2.2-2shall be returned with the message body containing a
    N2InformationTransferError structure, including a ProblemDetails
    attribute with the "cause" attribute set to one of the application
    errors listed in Table 6.1.3.58.4.2.2-2.


5.2.2.4.1.2 Obtaining Non UE Associated Network Assistance Data Procedure

The NonUeN2MessageTransfer service operation shall be invoked by a NF
Service Consumer, e.g. LMF to transfer non UE associated N2 information of
N2 information class LMF to NG-RAN for obtaining the network assistance
data.

The requirements specified in subclause 5.2.2.4.1.1 shall apply with the
following modifications:

  1. Same as step 1 of Figure 5.2.2.4.1.1-1, the POST request body shall
    carry the N2 information to be transferred together with the NG RAN
    node identifier(s) to which the transfer needs to be initiated. The
    POST request body shall also contain a callback URI of the NF Service
    Consumer, which is used by the AMF to later notify the NF Service
    Consumer when a non UE N2 message of class (e.g. NRPPa) that is
    requested to be transferred is received.


5.2.2.4.1.3 Warning Request Transfer Procedure

The NonUeN2MessageTransfer service operation shall be invoked by the NF
Service Consumer, e.g. CBCF/PWS-IWF, to send non-UE specific messages of N2
information class PWS to the NG-RAN.

The requirements specified in subclause 5.2.2.4.1.1 shall apply with the
following modifications:

  1. Same as step 1 of Figure 5.2.2.4.1.1-1, the request body shall include
    the N2 Message Container and optionally the List of TAIs IE, the OMC ID
    IE, the Send-Write-Replace-Warning Indication IE or the Send-Stop-
    Warning Indication IE.

     The AMF shall forward the N2 Message Container to the RAN Nodes that
    serve Tracking Areas as listed in the List of TAIs IE. If the List of
    TAIs IE is not present, the AMF shall forward the N2 Message Container
    to all attached RAN Nodes.

  2a.  Same as step 2a of Figure 5.2.2.4.1.1-1,  and the POST response body
    shall contain the mandatory elements from the Write-Replace-Warning
    Confirm response (see subclause 9.2.17 in TS 23.041 [20]) or the
    mandatory elements and optionally the Unknown Tracking Area List IE
    from the Stop-Warning Confirm response (see subclause 9.2.19 in TS
    23.041 [20]).

  2b.  Same as step 2b of Figure 5.2.2.4.1.1-1, and the POST response body
    shall contain following additional information:

    -  PWS specific information, if any, e.g. PWS Cause information


5.2.2.4.2   NonUeN2InfoSubscribe


5.2.2.4.2.1 General

The NonUeN2InfoSubscribe service operation is used by a NF Service Consumer
(e.g. LMF, CBCF or PWS-IWF) to subscribe to the AMF for notifying non UE
specific N2 information of a specific type (e.g. NRPPa or PWS Indications).


An NF Service Consumer (e.g. LMF, CBCF or PWS-IWF) may subscribe to
notifications of specific N2 information type (e,g NRPPa or PWS
Indications) that are not associated with any UE. In this case, the NF
Service Consumer shall subscribe by using the HTTP POST method with the URI
of the "Non UE N2Messages Subscriptions Collection" resource (See subclause
6.1.3.9.3.1). See also Figure 5.2.2.4.2.1-1.

                                    [pic]

   Figure 5.2.2.4.2.1-1 N2 Information Subscription for Non UE Information

  1. The NF Service Consumer shall send a POST request to create a
    subscription resource in the AMF for a non UE specific N2 information
    notification. The payload body of the POST request shall contain:

    -  N2 Information Type, identifying the type of N2 information to be
       notified

    -  A callback URI for the notification

  2. If the request is accepted, the AMF shall include a HTTP Location
    header to provide the location of a newly created resource
    (subscription) together with the status code 201 indicating the
    requested resource is created in the response message.


5.2.2.4.3   NonUeN2InfoUnSubscribe


5.2.2.4.3.1 General

The NonUeN2InfoUnSubscribe service operation is used by a NF Service
Consumer (e.g. LMF) to unsubscribe to the AMF to stop notifying N2
information of a specific type (e.g. NRPPa).

The NF Service Consumer shall use the HTTP method DELETE with the URI of
the "Non UE N2 Message Notification Individual Subscription" resource (See
subclause 6.1.3.10.3.1), to request the deletion of the subscription for
non UE specific N2 information notification, towards the AMF. See also
Figure 5.2.2.4.3.1-1.

                                    [pic]

 Figure 5.2.2.4.3.1-1 NonUeN2InfoUnSubscribe for Non UE Specific Information

  1. The NF Service Consumer shall send a DELETE request to delete an
    existing subscription resource in the AMF.

  2. If the request is accepted, the AMF shall reply with the status code
    204 indicating the resource identified by subscription ID is
    successfully deleted, in the response message.


5.2.2.4.4   NonUeN2InfoNotify


5.2.2.4.4.1 General

The NonUeN2InfoNotify service operation is used during the following
procedures:

  -  Obtaining non-UE associated network assistance data (See subclause
    4.13.5.6 in 3GPP TS 23.502 [3])

  -  Receiving PWS related events from the NG-RAN

The NonUeN2InfoNotify service operation is invoked by the AMF to notify a
NF Service Consumer that subscribed Non-UE N2 information has been received
from the 5G-AN.

The AMF shall use HTTP POST method to the N2Info Notification URI provided
by the NF Service Consumer via NonUeN2InfoSubscribe service operation (See
subclause 5.2.2.4.2). See also Figure 5.2.2.4.4.1-1.

                                    [pic]

              Figure 5.2.2.4.4.1-1 Non-UE N2 Information Notify

  1. The AMF shall send a HTTP POST request to the N2Info Notification URI,
    and the payload body of the POST request shall contain a
    N2INformationNotification data structure, with the N2 information that
    was subscribed by the NF Service Consumer.

  2a.  On success, "204 No Content" shall be returned and the payload body
    of the POST response shall be empty.

  2b.  On failure, one of the HTTP status code listed in Table 6.1.5.3.3.1-
    2 shall be returned. The message body shall contain a ProblemDetails
    object with "cause" set to one of the corresponding application errors
    listed in Table 6.1.5.3.3.1-2.


5.2.2.4.4.2 Using NonUeN2InfoNotify during Location Services procedures

The NonUeN2InfoNotify service operation is invoked by a NF Service
Producer, i.e. the AMF, towards the NF Service Consumer, e.g. the LMF, to
notify the assistance data received from the 5G-AN.

The requirements specified in subclause 5.2.2.4.4.1 shall apply with the
following modifications:

  1. Same as step 1 of Figure 5.2.2.4.4.1-1, the payload shall contain
    network assistance data.


5.2.2.4.4.3 Use of NonUeN2InfoNotify for PWS related events

The NonUeN2InfoNotify service operation shall be used during the following
PWS related events:

1) The AMF has received a Write-Replace-Warning-Confirm response or a PWS-
  Cancel-Confirm response from the NG-RAN over N2.

  Upon receiving the N2 Message Content the RAN Nodes return a response
  which may include the Broadcast Completed Area List IE or the Broadcast
  Cancelled Area List IE, depending on the Message Type IE. The AMF may
  aggregate the lists it receives from the RAN Nodes for the same request.

  If the Send-Write-Replace-Warning Indication IE was present in the Write-
  Replace-Warning Request message, then the AMF may forward the Broadcast
  Completed Area List IE(s) to the NF Service Consumer.

  If the Send-Stop-Warning Indication IE was present in the Stop-Warning-
  Request message, then the AMF may forward the Broadcast Cancelled Area
  List IE(s) to the NF Service Consumer. If the NG-RAN node has responded
  without including the Broadcast Cancelled Area List IE then the AMF shall
  populate the Broadcast Empty Area List IE with the NG-RAN node ID and
  send the (aggregated) Broadcast Empty Area List to the NF Service
  Consumer.

2) The AMF has received a Restart Indication or a Failure Indication from a
  NG-RAN Node. The AMF shall forward the Restart Indication or Failure
  Indication to the NF Service Consumer.

  The requirements specified in subclause 5.2.2.4.4.1 shall apply with the
    following modifications:

  1. Same as step 1 of Figure 5.2.2.4.4.1-1, the request body shall include
    the PWS related N2 information.


5.2.2.5  AMF Status Change Operations


5.2.2.5.1   AMFStatusChangeSubscribe


5.2.2.5.1.1 General

This service operation is used by a NF Service Consumer to subscribe the
status change of the AMF.

The AMFStatusChangeSubscribe service operation is used during the following
procedure:

  -  AMF planned removal procedure (see 3GPP TS 23.501 [2], subclause
    5.21.2.2)


5.2.2.5.1.2 Creation of a subscription

This service operation creates a subscription so a NF Service Consumer can
request to be notified when the status of the AMF is changed.

It is executed by creating a new individual resource under the collection
resource "subscriptions". The operation shall be invoked by issuing a POST
request on the URI of the "subscriptions collection" resource (See
subclause 6.1.3.6.3.1).

                                    [pic]

   Figure 5.2.2.5.1.1-1 NF Service Consumer Subscription to Notifications

  1. The NF Service Consumer shall send a POST request to the resource URI
    representing the "subscriptions" collection resource. The request body
    shall include the data indicating the GUAMI(s) supported by the AMF
    that the NF Service Consumer is interested in receiving the related
    status change notification. The request body also contains a callback
    URI, where the NF Service Consumer shall be prepared to receive the
    actual notification from the AMF (see AMFStatusChangeNotify operation
    in subclause 5.2.2.5.3).

  2a.  On success, the AMF shall include a HTTP Location header to provide
    the location of a newly created resource (subscription) together with
    the status code 201 indicating the requested resource is created in the
    response message.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.1.3.6.3.1-3 shall be returned. For a 4xx/5xx response, the
    message body containing a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.1.3.6.3.1-3.


5.2.2.5.1.3 Modification of a subscription

This service operation updates the subscription data of an NF Service
Consumer previously subscribed in the AMF by providing the updated
subscription data to the AMF. The update operation shall apply to the whole
subscription data (complete replacement of the existing subscription data
by a new subscription data).

The NF Service Consumer shall issue an HTTP PUT request, towards the URI of
the "individual subscription" resource (See subclause 6.1.3.7.3.2), as
shown in Figure 5.2.2.5.1.3-1:

                                    [pic]

         Figure 5.2.2.5.1.3-1 Subscription Data Complete Replacement

  1. The NF Service Consumer shall send a PUT request to the resource URI
    representing the individual subscription. The request body shall
    include a representation of subscription data to replace the previous
    subscription data in the AMF.

  2a.  On success, "200 OK" shall be returned, the payload body of the PUT
    response shall contain the representation of the replaced resource.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.1.3.7.3.2-3 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.1.3.7.3.2-3.


5.2.2.5.2   AMFStatusChangeUnSubscribe


5.2.2.5.2.1 General

This service operation removes an existing subscription to notifications.

The AMFStatusChangeUnSubscribe service operation is used during the
following procedure:

  -  AMF planned removal procedure (see 3GPP TS 23.501 [2], subclause
    5.21.2.2)

It is executed by deleting a given resource identified by a
"subscriptionId". The operation is invoked by issuing a DELETE request on
the URI of the specific " individual subscription" resource (See subclause
6.1.3.7.3.1).

                                    [pic]

  Figure 5.2.2.5.2.1-1: NF Service Consumer Unsubscription to Notifications

  1. The NF Service Consumer shall send a DELETE request to the resource
    URI representing the individual subscription. The request body shall be
    empty.

  2a.  On success, "204 No Content" shall be returned. The response body
    shall be empty.

  2b. On failure or redirection, one of the HTTP status code listed in
    Table 6.1.3.7.3.1-3 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.1.3.7.3.1-3.


5.2.2.5.3   AMFStatusChangeNotify


5.2.2.5.3.1 General

This service operation notifies each NF Service Consumer that was
previously subscribed to receiving notifications of the status change of
the AMF (e.g. AMF unavailable). The notification is sent to a callback URI
that each NF Service Consumer provided during the subscription (see
AMFStatusChangeSubscribe operation in 5.2.2.5.1).

The AMFStatusChangeNotify service operation is used during the following
procedure:

  -  AMF planned removal procedure (see 3GPP TS 23.501 [2], subclause
    5.21.2.2)

The operation is invoked by issuing a POST request to each callback URI of
the different NF Service Consumer.

                                    [pic]

                   Figure 5.2.2.5.3.1-1: AMF Notifications

  1. The AMF shall send a POST request to the callback URI. The request
    body shall include the GUAMI(s) and the related status change, GUAMI(s)
    is indicated by the NF Service Consumer during the subscription
    operation. For network deployment without UDSF case, the target AMF
    Name which is to serve the user of the indicated GUAMI(s) is also
    included.

  2a.  On success, "204 No content" shall be returned by the NF Service
    Consumer.

  2b.  On failure, one of the HTTP status code listed in Table 6.1.5.2.3.1-
    2-3shall be returned. For a 4xx/5xx response, the message body shall
    contain a ProblemDetails structure with the "cause" attribute set to
    one of the application error listed in Table 6.1.5.2.3.1-2.


5.2.2.6  EBIAssignment


5.2.2.6.1   General

The EBIAssignment service operation is used during the following procedures
(see 3GPP TS 23.502 [3], subclause 4.11.1.4):

  -  UE requested PDU Session Establishment (Non-roaming and Roaming with
    Local Breakout (see 3GPP TS 23.502 [3], subclause 4.3.2.2.1).

  -  UE requested PDU Session Establishment (Home-routed Roaming (see
    3GPP TS 23.502 [3], subclause 4.3.2.2.2).

  -  UE or network requested PDU Session Modification (non-roaming and
    roaming with local breakout) (see 3GPP TS 23.502 [3],
    subclause 4.3.3.2).

  -  UE or network requested PDU Session Modification (home-routed roaming)
    (see 3GPP TS 23.502 [3], subclause 4.3.3.3).

  -  Network requested PDU Session Modification, when the SMF needs to
    release the assigned EBI from a QoS flow (see 3GPP TS 23.502 [3],
    subclause 4.11.1.4.3).

The EBIAssignment service operation is invoked by a NF Service Consumer,
e.g. a SMF, towards the NF Service Producer, i.e. the AMF, to request the
AMF to allocate EPS bearer ID(s) towards EPS bearer(s) mapped from QoS
flow(s) for an existing PDU Session for a given UE.

The NF Service Consumer (e.g. the SMF) shall perform EBIAssignment service
operation by invoking "assignEbi" custom operation on the "individual
ueContext" resource (See subclause 6.1.3.2.4.3). See also Figure 5.2.2.6.1-
1.

                                    [pic]

                      Figure 5.2.2.6.1-1 EBI Assignment

  1. The NF Service Consumer, e.g. the SMF, shall invoke "assignEbi" custom
    method on individual ueContext resource, which is identified by the
    UE's SUPI or PEI in the AMF. The NF Service consumer shall provide PDU
    Session ID, ARP list and S-NSSAI as input for the service operation.

  2a.  On success, the AMF shall assign EBI for each ARP in received ARP
    list, if enough EBI(s) are available. If there is not enough EBI(s)
    available, the AMF may revoke already assigned EBI(s) based on the
    ARP(s) and S-NSSAI received, EBIs information in the UE context and
    local policies. The AMF may only assign a subset of the requested EPS
    Bearer ID(s), e.g. when other PDU Sessions with higher ARP have
    occupied other available EPS Bearer IDs. If AMF has successfully
    assigned all or part of the requested EBI(s), the AMF shall respond
    with the status code 200 OK, together with the assigned EBI to ARP
    mapping(s) and list of ARPs for which the AMF failed to allocate an EBI
    (if any).

     If the request contains "releasedEbiList", the AMF shall release the
    requested EBI(s). The AMF shall respond with the status code 200 OK and
    shall include the EBI(s) released in the "releasedEbiList" IE of the
    POST response body.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.1.3.2.4.3.2-2 shall be returned. For a 4xx/5xx response, the
    message body shall contain a N1N2MessageTransferError structure,
    including:

    -  a ProblemDetails structure with the "cause" attribute set to one of
       the application error listed in Table 6.1.3.2.4.3.2-2;

    -  a failureDetails which describes the detailed cause phrase why the
       request has failed.


5.3  Namf_EventExposure Service


5.3.1  Service Description

The AMF may offer this service as a Service Producer to enable an NF to
subscribe and get notified about an event. The known Service Consumers are
NEF, SMF, PCF, UDM. See also subclauses 4.1.5.3.2, 4.15.4.2 and 5.2.2.3.1
of 3GPP TS 23.502 [3] and subclause 6.1.3.4 of 3GPP TS 23.503 [7].

The following events are provided by Namf_EventExposure Service:

  Event: Location-Report

     A NF subscribes to this event to receive the Last Known Location of a
       UE or a group of UEs, and Updated Location of the UE or any UE in the
       group when AMF becomes aware of a location change of the UE.

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report (See NOTE 1), Continuous Report (See NOTE
       2)

     Input: UE-ID(s), Optionally Filters: TAI, Cell-ID, N3IWF, UE-IP, UDP-
       PORT

     Notification; UE-ID, filtered updated location (TAI, Cell-ID for 3GPP
       access, most recent N3IWF node, UE local IP address and UDP source
       port number for non-3GPP access).

  NOTE 1:  For One-time report, only Last Known Location is supported.

  NOTE 2:  Support of Continuous Report should be controlled by operator
         policy.

  Event: Presence-In-AOI-Report

     A NF subscribe to this event to receive the current present state of a
       UE in a specific Area of Interest (AOI), and notification when a
       specified UE enters or leaves the specified area. The area could be
       identified by a TA list, an area ID or specific interested area name
       like "LADN".

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report, Continuously Report

     Input:  UE ID(s), Area identifier (a TA list, an area Id or "LADN").

     Notification: UE-ID, Area identifier, Presence Status (IN/OUT/UNKNOWN)

  Event: Time-Zone-Report

     A NF subscribes to this event to receive the current time zone of a UE
       or a group of UEs, and updated time zone of the UE or any UE in the
       group when AMF becomes aware of a time zone change of the UE.

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report, Continuous Report

     Input: UE ID(s)

     Notification; UE-ID, most recent time-zone

  Event: Access-Type-Report

     A NF subscribes to this event to receive the current access type(s) of
       a UE or a group of UEs, and updated access type(s) of the UE or any
       UE in the group when AMF becomes aware of the access type change of
       the UE.

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report, Continuous Report

     Input: UE ID(s)

     Notification; UE ID, most recent access-types (3GPP, Non-3GPP)

  Event: Registration-State-Report

     A NF subscribes to this event to receive the current registration
       state of a UE or a group of UEs, and report for updated registration
       state of a UE or any UE in the group when AMF becomes aware of a
       registration state change of the UE.

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report, Continuous Report

     Input: UE ID(s)

     Notification; UE ID, most recent registration state
       (REGISTERED/DEREGISTERED) with access type

  Event: Connectivity-State-Report

     A NF subscribes to this event to receive the current connectivity
       state of a UE or a group of UEs, and report for updated connectivity
       state of a UE or any UE in the group when AMF becomes aware of a
       connectivity state change of the UE.

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report, Continuous Report

     Input: UE ID(s)

     Notification; UE ID, most recent connectivity state (IDLE/CONNECTED)
       with access type

  Event: Reachability-Report

     A NF subscribes to this event to receive the current reachability of a
       UE or a group of UEs, and report for updated reachability of a UE or
       any UE in the group when AMF becomes aware of a reachability change
       of the UE.

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report, Continuous Report

     Input: UE ID(s)

     Notification; UE ID, AMF Id, most recent reachability state
       (REACHABLE/UNRACHABLE/REGULATORY-ONLY); Optionally, list of sessions
       to be activated.

  Event: Subscribed-Data-Report

     A NF subscribes to this event to receive the current Subscribed Data
       for the UE(s) received from UDM, and notification when AMF received
       updated subscribed data for the UE(s) from UDM.

     UE Type: One UE, Group of UEs

     Report Type: One-Time Report, Continuous Report

     Input: UE ID(s), filters (SARI/RFSPI)

     Notification; UE ID, most recent subscribed data according to the
       filter, Service Area Restriction Information/RFSP-Index.

  Event: Communication-Failure-Report

     A NF subscribes to this event to receive the Communication failure
       report of a UE or group of UEs or any UE.

     UE Type: One UE, Group of UEs, any UE

     Report Type: One-Time Report, Continuous Report

     Input: UE ID(s), "ANY_UE"

     Notification; UE ID, RAN/NAS release code.

  Event: UEs-In-Area-Report

     A NF subscribes to this event to receive the number of UEs in a
       specific area. A NF may ask AMF for the UEs within the area based on
       Last Known Location or it may request AMF to actively look for the
       UEs within the area based on Current Location.

     UE Type: any UE

     Report Type: One-Time Report (See NOTE 3), Continuous Report (See NOTE
       4)

     Input: Area identified in a TA List

     Notification: Number of UEs in the area

  NOTE 3:  For One-time Report, UE Last Known Location is used to count the
         UEs within the area

  NOTE 4:  Support of Continuous Report should be controlled by operator.


5.3.2  Service Operations


5.3.2.1  Introduction

For the Namf_EventExposure service the following service operations are
defined:

  -  Subscribe;

  -  Unsubscribe;

  -  Notify.


5.3.2.2  Subscribe


5.3.2.2.1   General

The Service Operation is used by a NF Service Consumer (e.g. NEF) to
subscribe to an event(s) for one UE, group of UE(s) or any UE.


5.3.2.2.2   Creation of a subscription

The Subscribe service operation is invoked by a NF Service Consumer, e.g.
NEF, towards the AMF, when it needs to create a subscription to monitor at
least one event relevant to the AMF. The NF Service Consumer may subscribe
to multiple events in a subscription. A subscription may be associated with
one UE, a group of UEs or any UE.

The NF Service Consumer shall request to create a new subscription by using
HTTP method POST with URI of the subscriptions collection, see subclause
6.2.3.2.

The NF Service Consumer shall include the following information in the HTTP
message body:

  - NF ID, indicates the identity of the network function instance
    initiating the subscription;

  - Subscription Target, indicates the target(s) to be monitored, as one of
    the following types:

    - A specific UE, identified with a SUPI, a PEI or a GPSI;

    - A group of UEs, identified with a group identity;

    - Any UE, identified by the "anyUE" flag.

  - Notification URI, indicates the address to deliver the event
    notifications generated by the subscription;

  - Notification Correlation ID, indicates the correlation identity to be
    carried in the event notifications generated by the subscription;

  - Event Types(s), indicate the event(s) to be subscribed, from supported
    events specified in subclause 5.3.1;

  - Event Trigger per Event Type, indicates how the event to be reported
    (One-time Reporting or Continuously Reporting).

The NF Service Consumer may include the following information in the HTTP
message body:

  - Immediate Report Flag per Event Type, indicates an immediate report to
    be generated with current event status;

  - Maximum Number of Reports per Event Type, defines the maximum number of
    reports after which the event subscription ceases to exist;

  - Maximum Duration of Reporting per Event Type, defines maximum duration
    after which the event subscription ceases to exist;

  - Event Filter per applicable Event Type, defines further options on how
    the event be reported.

                                    [pic]

                  Figure 5.3.2.2.2-1 Subscribe for Creation

  1. The NF Service Consumer shall send a POST request to create a
    subscription resource in the AMF. The payload body of the POST request
    shall contain a representation of the individual subscription resource
    to be created.

  2a.  On success, the request is accepted, the AMF shall include a HTTP
    Location header to provide the location of a newly created resource
    (subscription) together with the status code 201 indicating the
    requested resource is created in the response message. If the NF
    Service Consumer has included the immediateFlag with value as "true" in
    the event subscription, the AMF shall include the current status of the
    events subscribed, if available (e.g. current location information is
    included if the subscribed event is LOCATION_REPORT). If the NF Service
    Consumer has set the event reporting option as ONE_TIME and if the AMF
    has included the current status of the events subscribed in the
    response, then the AMF shall not do any subsequent event notification
    for the events given in the AmfCreateEventSubscription parameter.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.2.3.2.3.1-3 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.2.3.2.3.1-3.


5.3.2.2.3   Modification of a subscription

The Subscribe service operation is invoked by a NF Service Consumer, e.g.
NEF, towards the AMF, when it needs to modify an existing subscription
previously created by itself at the AMF.

The NF Service Consumer shall modify the subscription by using HTTP method
PATCH with the URI of the individual subscription resource (see subclause
6.2.3.3) to be modified.

See also Figure 5.3.2.2.3-1 below.

                                    [pic]

              Figure 5.3.2.2.3-1 Modification of a Subscription

  1. The NF Service Consumer shall send a PATCH request to modify a
    subscription resource in the AMF.

  2a.  On success,  the request is accepted, the AMF shall the
    representation of the modified subscription resource or its sub-
    resource together with the status code 200.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.2.3.3.3.1-3 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.2.3.3.3.1-3.


5.3.2.3  Unsubscribe


5.3.2.3.1   General

The Unsubscribe service operation is invoked by a NF Service Consumer, e.g.
NEF, towards the AMF, to remove an existing subscription previously created
by itself at the AMF.

The NF Service Consumer shall unsubscribe to the subscription by using HTTP
method PATCH with the URI of the individual subscription resource (see
subclause 6.2.3.3) to be deleted.



                                    [pic]

                Figure 5.3.2.3.1-1 Unsubscribe a subscription

  1. The NF Service Consumer shall send a DELETE request to delete an
    existing subscription resource in the AMF.

  2a.  On success, the request is accepted, the AMF shall reply with the
    status code 204 indicating the resource identified by   subscription ID
    is successfully deleted in the response message.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.2.3.3.3.1-3 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.2.3.3.3.1-3.


5.3.2.4  Notify


5.3.2.4.1   General

The Notify service operation is invoked by the AMF, to send a notification,
towards the notification URI, when certain event included in the
subscription has taken place.

The AMF shall use the HTTP method POST, using the notification URI received
in the subscription creation as specified in subclause 5.3.2.2.2, including
e.g. the subscription ID, Event ID(s) for which event has happened,
notification co-relation ID provided by the NF service consumer at the time
of event subscription, to send a notification. See Figure 5.3.2.4.1-1.

Additionally, the Notify service operation shall also be invoked by the
AMF, when there is a change of AMF during UE mobility procedures and if the
subscription Id changes (i.e. Registration procedures and Handover
procedures).

                                    [pic]

                          Figure 5.3.2.4.1-1 Notify

  1. The AMF shall send a POST request to send a notification.

  2. If the notification is received, the NF Service Consumer shall reply
    with the status code 204 indicating the notification is received, in
    the response message.


5.4  Namf_MT Service


5.4.1  Service Description

Namf_MT service allows a NF to request information related to capabilities
to send MT signalling or data to a target UE. The following are the key
functionalities of this NF service

  -  paging UE if UE is in IDLE state and respond other NF after the UE
    enters CM-CONNECTED state.

  -  response to the requester NF if UE is in CONNECTED state.

  -  providing the terminating domain selection information for IMS voice
    to the consumer NF.


5.4.2  Service Operations


5.4.2.1  Introduction

For the Namf_MT Service the following service operations are defined:

  -  EnableUEReachability

  -  ProvideDomainSelectionInfo


5.4.2.2  EnableUEReachability


5.4.2.2.1   General

The EnableUEReachability service operation is used in the following
procedure:

  -  MT SMS over NAS in CM-IDLE state (see 3GPP TS 23.502 [3], subclause
    4.13.3.6)

The EnableUEReachability service operation shall be invoked by the NF
Service Consumer (e.g. SMSF) to enable the reachability of the UE.

The NF Service Consumer shall invoke the service by using the HTTP method
PUT, towards the URI of a "ueReachInd" resource as specified in subclause
6.3.3.2. See also figure 5.4.2.2.1-1.

                                    [pic]


 Figure 5.4.2.2.2-1: NF Service Consumer enables the reachability of the UE

  1. The NF Service Consumer sends a PUT request to the resource
    representing the ueReachInd resource of the AMF. The payload body of
    the PUT request shall contain an "EnableUeReachabilityReqData" object.

  2a.  On success:

    -  if the UE is in CM-CONNECTED state, the AMF shall immediately
       respond using "200 OK" status code, with payload containing an
       "EnableUeReachabilityRspData" object.

    -  if the UE is in CM-IDLE state and the NAS message is to be sent over
       via 3GPP access, the AMF shall page the UE. When UE becomes CM-
       CONNECTED, "200 OK" shall be returned with payload containing an
       "EnableUeReachabilityRspData" object.

  2b.  On failure or redirection, one of the HTTP status code listed in
    Table 6.3.3.2.3.1-3 shall be returned. For a 4xx/5xx response, the
    message body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.3.3.2.3.1-3.


5.4.2.3  ProvideDomainSelectionInfo


5.4.2.3.1   General

The ProvideDomainSelectionInfo service operation shall be invoked by the NF
Service Consumer (e.g. UDM) to get the UE information for terminating
domain selection of IMS voice, including following information:

  -  Indication of supporting IMS voice over PS Session;

  -  Time stamp of the last radio contact with the UE;

  -  Current RAT type

The NF Service Consumer shall invoke the service by using the HTTP GET
towards the URI of the "UeContext" resource (See subclause 6.3.3.x.3.1).
See also figure 5.4.2.x.1-1.

                                    [pic]


 Figure 5.4.2.3.1-1: Provide UE Information for Terminating Domain Selection

  1. The NF Service Consumer shall send a GET request to the URI of the
    "UeContext" resource on the AMF, with query parameter "info-class" set
    to value "TADS".

  2a.  On success, the AMF shall return "200 OK" status code with payload
    containing an "UeContextInfo" data structure including UE information
    for terminating domain selection for IMS voice.

  2b.  On failure, one of the HTTP status code listed in Table 6.1.3.3.3.1-
    3 shall be returned. The message body shall contain a ProblemDetails
    object with "detail" set to one of the corresponding application errors
    listed in Table 6.1.3.3.3.1-3.


5.5  Namf_Location Service


5.5.1  Service Description

The Namf_Location service is used by NF service consumers to request the
AMF for initiating positioning requests and provide the location
information. It is also used to subsequently notify the location change
events towards the NF service consumers.


5.5.2  Service Operations

For the Namf_Location Service the following service operations are defined:

  -  ProvideLocation

  -  EventNotify


5.5.2.1  Introduction


5.5.2.2  ProvideLocation


5.5.2.2.1   General

The ProvideLocation service operation is used in the following procedure:

  -  5GC-MT-LR Procedure without UDM Query (see 3GPP TS 23.502 [3],
    subclause 4.13.5.2)

  -  5GC-MT-LR Procedure (see 3GPP TS 23.502 [3], subclause 4.13.5.3)

  -  Location Continuity for Handover of an Emergency session from NG-RAN
    (see 3GPP TS 23.502 [3], subclause 4.13.5.7)

The ProvideLocation service operation shall be invoked by the NF Service
Consumer (e.g. GMLC) to request the current location of the UE. The service
operation triggers the AMF to invoke the service towards the LMF.

The NF Service Consumer shall invoke the service operation by sending POST
to the URI of the "provide" custom operation on the "Individual UE Context"
resource (See subclause 6.4.3.2.4.2). See also figure 5.5.2.2.1-1.

                                    [pic]


   Figure 5.5.2.2.1-1: NF Service Consumer requests the location of the UE

  1. The NF Service Consumer sends a POST request to the resource
    representing the locationInformation resource of the AMF. The payload
    body of the POST request may contain an indication of a location
    request from an emergency services client, the required QoS and
    Supported GAD shapes. If the NF service consumer wants the location
    change information to be notified (e.g. during a handover procedure),
    it also provides a callback URI on which the EventNotify service
    operation is executed (see clause 5.5.2.3).

  2a.  On success, "200 OK" shall be returned, the payload body containing
    the LCS correlation identifier, the location estimate, its age and
    accuracy and the information about the positioning method. If the
    request is invoked during a handover the response body shall also
    include the target AMF node identifier as specified in clause 4.13.5.7
    of 3GPP TS 23.502 [3].

  2b.  On failure, one of the HTTP status code listed in Table
    6.4.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the message
    body shall contain a ProblemDetails structure with the "cause"
    attribute set to one of the application error listed in Table
    6.4.3.2.4.2.2-2.


5.5.2.3  EventNotify


5.5.2.3.1   General

The EventNotify service operation is used in the following procedure:

  -  5GC-NI-LR Procedure (see 3GPP TS 23.502 [3], subclause 4.13.5.1)

  -  Location Continuity for Handover of an Emergency session from NG-RAN
    (see 3GPP TS 23.502 [3], subclause 4.13.5.7)

The EventNotify service operation notifies the NF Service Consumer (e.g.
GMLC) the UE location related event information related to emergency
sessions, i.e. when the emergency session is initiated, when a handover
procedure takes place and the emergency session is ongoing, or when the
emergency session is released. The notification is delivered on the
callback URI provided by the NF Service Consumer.

  NOTE:  During a handover procedure, both the source AMF and the target
         AMF can invoke the EventNotify service operation, based on the
         local configuration.

The operation is invoked by issuing a POST request to the callback URI of
the NF Service Consumer (See subclause 6.4.5.2.3.1). See also figure
5.5.2.3.1-1.

                                    [pic]


                Figure 5.5.2.3.1-1: UE Location Notification

  1. The AMF shall send a POST request to the callback URI provided by the
    NF service consumer. The request body shall include the type of
    location related event and UE Identification (SUPI or PEI), and may
    include the GPSI, Geodetic Location, Civic Location and the Position
    methods used.

  2. On success, "204 No content" shall be returned by the NF Service
    Consumer.

     On failure, the appropriate HTTP status code (e.g. "403 Forbidden")
    indicating the error shall be returned and appropriate additional error
    information should be returned.


6  API Definitions


6.1  Namf_Communication Service API


6.1.1  API URI

URIs of this API shall have the following root:

{apiRoot}/{apiName}/{apiVersion}/

where the "apiName" shall be set to "namf-comm" and the "apiVersion" shall
be set to "v1" for the current version of this specification.


6.1.2  Usage of HTTP


6.1.2.1  General

HTTP/2, as defined in IETF RFC 7540 [19], shall be used as specified in
clause 5 of 3GPP TS 29.500 [4].

HTTP/2 shall be transported as specified in subclause 5.3 of
3GPP TS 29.500 [4].

HTTP messages and bodies for the Namf_Communication service shall comply
with the OpenAPI [23] specification contained in Annex A.


6.1.2.2  HTTP standard headers


6.1.2.2.1   General

The usage of HTTP standard headers shall be supported as specified in
subclause 5.2.2 of 3GPP TS 29.500 [4].


6.1.2.2.2   Content type

The JSON format shall be supported. The use of the JSON format (IETF RFC
8259 [8]) shall be signalled by the content type "application/json" or
"application/problem+json". See also subclause 5.4 of 3GPP TS 29.500 [4].

Multipart messages shall also be supported (see subclause 6.1.2.4) using
the content type "multipart/related", comprising:

  -  one JSON body part with the "application/json" content type; and

  -  one or two binary body parts with 3gpp vendor specific content
    subtypes.

The 3gpp vendor specific content subtypes defined in Table 6.1.2.2.2-1
shall be supported.

          Table 6.1.2.2.2-1: 3GPP vendor specific content subtypes

|content subtype   |Description                                    |
|vnd.3gpp.ngap     |Binary encoded payload, encoding NG Application|
|                  |Protocol (NGAP) IEs, as specified in subclause |
|                  |9.4 of 3GPP TS 38.413 [12] (ASN.1 encoded).    |
|vnd.3gpp.5gnas    |Binary encoded payload, encoding a 5GS NAS     |
|                  |message, as specified in 3GPP TS 24.501 [11].  |
|NOTE:  Using 3GPP vendor content subtypes allows to describe the   |
|nature of the opaque payload (e.g. NGAP or 5GS NAS information)    |
|without having to rely on metadata in the JSON payload.            |


See subclause 6.1.2.4 for the binary payloads supported in the binary body
part of multipart messages.


6.1.2.3  HTTP custom headers


6.1.2.3.1   General

In this release of this specification, no custom headers specific to the
Namf_Communication service are defined. For 3GPP specific HTTP custom
headers used across all service based interfaces, see clause 5.2.3 of
3GPP TS 29.500 [4].


6.1.2.4  HTTP multipart messages

HTTP multipart messages shall be supported, to transfer opaque N1
Information (e.g. SM, LPP) and/or N2 Information (e.g. SM, NRPPa, PWS), in
the following service operations (and HTTP messages):

  -  N1N2MessageTransfer Request and Response (POST);

  -  NonUeN2MessageTransfer Request and Response (POST);

  -  N1MessageNotify (POST);

  -  N2InfoNotify (POST);

  -  NonUeN2InfoNotify (POST).

HTTP multipart messages shall include one JSON body part and one or two
binary body parts comprising:

  - an N1payload, an N2 payload or both (see subclause 6.1.6.4).

The JSON body part shall be the "root" body part of the multipart message.
It shall be encoded as the first body part of the multipart message. The
"Start" parameter does not need to be included.

The multipart message shall include a "type" parameter (see
IETF RFC 2387 [9]) specifying the media type of the root body part, i.e.
"application/json".

  NOTE:  The "root" body part (or "root" object) is the first body part the
         application processes when receiving a multipart/related message,
         see IETF RFC 2387 [9]. The default root is the first body within
         the multipart/related message. The "Start" parameter indicates the
         root body part, e.g. when this is not the first body part in the
         message.

For each binary body part in a HTTP multipart message, the binary body part
shall include a Content-ID header (see IETF RFC 2045 [10]), and the JSON
body part shall include an attribute, defined with the RefToBinaryData
type, that contains the value of the Content-ID header field of the
referenced binary body part.


6.1.3  Resources


6.1.3.1  Overview

                                    [pic]

   Figure 6.1.3.1-1: Resource URI structure of the Namf_Communication API

Table 6.1.3.1-1 provides an overview of the resources and applicable HTTP
methods.

               Table 6.1.3.1-1: Resources and methods overview

|Resource |Resource URI                           |HTTP  |Description         |
|name     |                                       |method|(Mapped Service     |
|         |                                       |or    |Operations)         |
|         |                                       |custom|                    |
|         |                                       |operat|                    |
|         |                                       |ion   |                    |
|Individua|…/ue-contexts/{ueContextId}            |PATCH |UEContextTransfer,  |
|l        |                                       |      |RegistrationComplete|
|ueContext|                                       |      |Notify, N2InfoNotify|
|         |                                       |PUT   |CreateUEContext     |
|         |…/ue-contexts/{ueContextId}/release    |(POST)|ReleaseUEContext    |
|         |                                       |releas|                    |
|         |                                       |e     |                    |
|         |…/ue-contexts/{ueContextId}/assignEbi  |(POST)|EBIAssignment       |
|         |                                       |assign|                    |
|         |                                       |Ebi   |                    |
|         |…/ue-contexts/{ueContextId}/transfer   |(POST)|UEContextTransfer   |
|         |                                       |transf|                    |
|         |                                       |er    |                    |
|n1N2Messa|…/ue-contexts/{ueContextId}/n1-n2-messa|POST  |N1N2MessageTransfer |
|ge       |ges                                    |      |                    |
|collectio|                                       |      |                    |
|n        |                                       |      |                    |
|N1N2     |../ue-contexts/{ueContextId}/n1-n2-mess|POST  |N1MessageSubscribe, |
|Subscript|ages/subscriptions                     |      |N2InfoSubscribe.    |
|ions     |                                       |      |                    |
|Collectio|                                       |      |                    |
|n for    |                                       |      |                    |
|Individua|                                       |      |                    |
|l UE     |                                       |      |                    |
|Contexts |                                       |      |                    |
|N1N2     |../ue-contexts/{ueContextId}/n1-n2-mess|PUT   |AMFStatusChangeSubsc|
|Individua|ages/subscriptions/{subscriptionId}    |      |ribe                |
|l        |                                       |      |                    |
|Subscript|                                       |      |                    |
|ion      |                                       |      |                    |
|         |                                       |DELETE|N1MessageUnSubscribe|
|         |                                       |      |, N2InfoUnsubscribe |
|n1N2Messa|{n1N2MessageTransferNotificationUrl}   |POST  |Notify              |
|ge       |(NF Service Consumer provided callback |      |n1N2MessageTransfer |
|transfer |reference)                             |      |status              |
|status   |                                       |      |                    |
|notificat|                                       |      |                    |
|ion      |                                       |      |                    |
|callback |                                       |      |                    |
|subscript|…/subscriptions                        |POST  |AMFStatusChangeSubsc|
|ions     |                                       |      |ribe                |
|collectio|                                       |      |                    |
|n        |                                       |      |                    |
|individua|…/subscriptions/{subscriptionId}       |DELETE|AMFStatusChangeUnSub|
|l        |                                       |      |scribe              |
|subscript|                                       |      |                    |
|ion      |                                       |      |                    |
|Non UE   |../non-ue-n2-messages                  |(POST)|NonUEN2MessageTransf|
|N2Message|                                       |transf|er                  |
|s        |                                       |er    |                    |
|collectio|                                       |      |                    |
|n        |                                       |      |                    |
|Non UE   |../non-ue-n2-messages/subscriptions    |POST  |NonUEN2InfoSubscribe|
|N2Message|                                       |      |                    |
|s        |                                       |      |                    |
|Subscript|                                       |      |                    |
|ions     |                                       |      |                    |
|collectio|                                       |      |                    |
|n        |                                       |      |                    |
|Non UE N2|../non-ue-n2-messages/subscriptions/{n2|DELETE|NonUEN2InfoUnsubscri|
|Message  |NotifySubscriptionId}                  |      |be                  |
|Notificat|                                       |      |                    |
|ion      |                                       |      |                    |
|Individua|                                       |      |                    |
|l        |                                       |      |                    |
|Subscript|                                       |      |                    |
|ion      |                                       |      |                    |



6.1.3.2  Resource: Individual ueContext


6.1.3.2.1   Description

This resource represents the an individual ueContext identified by the
ueContextId.

This resource is modelled as the Document resource archetype (see subclause
C.1 of 3GPP TS 29.501 [5]).


6.1.3.2.2   Resource Definition

Resource URI:{apiRoot}/namf-comm/v1/ue-contexts/{ueContextId}

This resource shall support the resource URI variables defined in
table 6.1.3.2.2-1.

         Table 6.1.3.2.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |
|ueContextId   |Represents the 5G Globally Unique Temporary Identifier (See |
|              |3GPP TS 23.501 [2] clause 5.9.4)                            |
|              |Pattern: "5g-guti-[0-9]{5,6}[0-9a-fA-F]{14}"                |
|              |Or represents the Subscription Permanent Identifier (see    |
|              |3GPP TS 23.501 [2] clause 5.9.2)                            |
|              |pattern: "(imsi-[0-9]{5,15}|nai-.+)"                        |
|              |Or represents the Permanent Equipment Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.3)                            |
|              |pattern: "(imei-[0-9]{15})"                                 |


When the ueContextId is composed by UE’s SUPI or PEI, UE's PEI shall be
used for the case:

  -  If the UE is emergency registration and the UE is UICCless;

  -  If the UE is emergency registration but SUPI is not authenticated.

For other cases, UE's SUPI shall be used.


6.1.3.2.3   Resource Standard Methods


6.1.3.2.3.1 PUT

This ueContextId identifies the individual ueContext resource is composed
by UE's SUPI or PEI, See table 6.1.3.2.2-1.

This method shall support the URI query parameters specified in table
6.1.3.2.3.1-1.

  Table 6.1.3.2.3.1-1: URI query parameters supported by the PUT method on
                                this resource

|Name       |Data type |P |Cardinal|Description                            |
|           |          |  |ity     |                                       |


This method shall support the request data structures specified in table
6.1.3.2.3.1-2 and the response data structures and response codes specified
in table 6.1.3.2.3.1-3.

  Table 6.1.3.2.3.1-2: Data structures supported by the PUT Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|UeContextCre|M |1        |Defines the UE Context to be created.            |
|ateData     |  |         |                                                 |


 Table 6.1.3.2.3.1-3: Data structures supported by the PUT Response Body on
                                this resource

|Data type      |P |Cardinal|Respons|Description                            |
|               |  |ity     |e      |                                       |
|               |  |        |codes  |                                       |
|UeContextCreate|M |1       |201    |This case represents the successful    |
|dData          |  |        |Created|creation of a new UE Context.          |
|               |  |        |       |Upon success, a response body is       |
|               |  |        |       |returned containing the newly created  |
|               |  |        |       |UE Context.                            |
|UeContextCreate|M |1       |403    |This case represents the creation of a |
|Error          |  |        |Forbidd|new UE Context is not successful.      |
|               |  |        |en     |                                       |
|               |  |        |       |The "cause" attribute of the           |
|               |  |        |       |ProblemDetails shall be set to:        |
|               |  |        |       |-  HANDOVER_FAILURE                    |



6.1.3.2.4   Resource Custom Operations


6.1.3.2.4.1 Overview

                   Table 6.1.3.2.4.1-1: Custom operations

|Custom operation URI     |Mapped HTTP  |Description                   |
|                         |method       |                              |
|{apiRoot}/namf-comm/v1/ue|POST         |Release an existing individual|
|-contexts/{ueContextId}/r|             |ueContext resource.           |
|elease                   |             |It is used for the Release UE |
|                         |             |Context service operation.    |
|{apiRoot}/namf-comm/v1/ue|POST         |Assign EPS bearer ID(s)       |
|-contexts/{ueContextId}/a|             |towards EPS bearer(s) mapped  |
|ssignEbi                 |             |from QoS Flow(s), for a PDU   |
|                         |             |session for the UE.           |
|                         |             |It is used for EBIAssignment  |
|                         |             |service operation.            |
|{apiRoot}/namf-comm/v1/ue|POST         |Transfer an existing          |
|-contexts/{ueContextId}/t|             |individual ueContext resource |
|ransfer                  |             |from old AMF to new AMF.      |
|                         |             |It is used for the            |
|                         |             |UEContextTransfer service     |
|                         |             |operation.                    |



6.1.3.2.4.2 Operation: (POST) release


6.1.3.2.4.2.1 Description

This ueContextId identifies the individual ueContext resource is composed
by UE's SUPI or PEI, See table 6.1.3.2.2-1.


6.1.3.2.4.2.2 Operation Definition

This operation shall support the request data structures specified in table
6.1.3.2.4.2.2-1 and the response data structure and response codes
specified in table 6.1.3.2.4.2.2-2.

   Table 6.1.3.2.4.2.2-1: Data structures supported by the (POST) release
                        Request Body on this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|UEContextRel|M |1        |The information used for releasing of the UE     |
|ease        |  |         |Context                                          |


   Table 6.1.3.2.4.2.2-2: Data structures supported by the (POST) release
                       Response Body on this resource

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |
|ProblemDeta|M |1        |400 Bad |The "cause" attribute shall be set to   |
|ils        |  |         |Request |one of the following application errors:|
|           |  |         |        |- INVALID_MSG_FORMAT                    |
|           |  |         |        |- MANDAT_IE_INCORRECT                   |
|           |  |         |        |- MANDAT_IE_MISSING                     |
|           |  |         |        |See table 6.1.7.3-1 for the description |
|           |  |         |        |of these errors.                        |
|ProblemDeta|M |1        |403     |                                        |
|ils        |  |         |Forbidde|The "cause" attribute shall be set to   |
|           |  |         |n       |one of the following application errors:|
|           |  |         |        |- UNSPECIFIED                           |
|           |  |         |        |- SUPI_OR_PEI_UNKNOWN                   |
|           |  |         |        |See table 6.1.7.3-1 for the description |
|           |  |         |        |of this error.                          |
|ProblemDeta|M |1        |404 Not |The "cause" attribute shall be set to   |
|ils        |  |         |Found   |the following application error:        |
|           |  |         |        |- CONTEXT_NOT_FOUND                     |
|           |  |         |        |See table 6.1.7.3-1 for the description |
|           |  |         |        |of this error.                          |
|ProblemDeta|M |1        |500     |The "cause" attribute shall be set to   |
|ils        |  |         |Internal|the following application error:        |
|           |  |         |Server  |- SYSTEM_FAILURE                        |
|           |  |         |Error   |See table 6.1.7.3-1 for the description |
|           |  |         |        |of this error.                          |
|ProblemDeta|M |1        |503     |The "cause" attribute shall be set to   |
|ils        |  |         |Service |the following application error:        |
|           |  |         |Unavaila|- NF_CONGESTION                         |
|           |  |         |ble     |See table 6.1.7.3-1 for the description |
|           |  |         |        |of this error.                          |



6.1.3.2.4.3 Operation: (POST) assignEbi


6.1.3.2.4.3.1 Description

This ueContextId identifies the individual ueContext resource is composed
by UE's SUPI or PEI, see Table 6.1.3.2.2-1.


6.1.3.2.4.3.2 Operation Definition

This operation shall support the request data structures specified in table
6.1.3.2.4.3.2-1 and the response data structure and response codes
specified in table 6.1.3.2.4.3.2-2.

  Table 6.1.3.2.4.3.2-1: Data structures supported by the (POST) assignEbi
                        Request Body on this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|AssignEbiDat|M |1        |The information required for AMF to allocate EPS |
|a           |  |         |bearer ID(s).                                    |
|            |  |         |                                                 |


  Table 6.1.3.2.4.3.2-2: Data structures supported by the (POST) assignEbi
                       Response Body on this resource

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |
|AssignEbiEr|M |1        |403     |This represents the case when none of   |
|ror        |  |         |Forbidde|the requested EBI(s) can be assigned by |
|           |  |         |n       |the AMF. The "cause" attribute of the   |
|           |  |         |        |ProblemDetails shall be set to:         |
|           |  |         |        |- EBI_EXHAUSTED, if the number of EBIs  |
|           |  |         |        |allocated for the UE has already reached|
|           |  |         |        |the maximum limit.                      |



6.1.3.2.4.4 Operation: (POST) transfer


6.1.3.2.4.4.1 Description

This ueContextId identifies the individual ueContext resource is composed
by UE's 5G-GUTI, see Table 6.1.3.2.2-1.


6.1.3.2.4.4.2 Operation Definition

This operation shall support the request data structures specified in table
6.1.3.2.4.4.2-1 and the response data structure and response codes
specified in table 6.1.3.2.4.4.2-2.

   Table 6.1.3.2.4.4.2-1: Data structures supported by the (POST) transfer
                        Request Body on this resource

|Data type           |P  |Cardina|Description                              |
|                    |   |lity   |                                         |
|UeContextTransferReq|M  |1      |Represents to start transferring of an   |
|Data                |   |       |individual ueContext resource from old   |
|                    |   |       |AMF to new AMF.                          |


   Table 6.1.3.2.4.4.2-2: Data structures supported by the (POST) transfer
                       Response Body on this resource

|Data type         |P|Cardina|Response  |Description                     |
|                  | |lity   |codes     |                                |
|ProblemDetails    |M|1      |403       |Indicates that AMF can          |
|                  | |       |Forbidden |understand the request but      |
|                  | |       |          |cannot fulfil the request due to|
|                  | |       |          |errors. If the integrity check  |
|                  | |       |          |of the included complete        |
|                  | |       |          |registration message fails at   |
|                  | |       |          |the source AMF the "cause"      |
|                  | |       |          |attribute is set to:            |
|                  | |       |          |- INTEGRITY_CHECK_FAIL.         |
|ProblemDetails    |M|1      |404 Not   |If the AMF does not have the    |
|                  | |       |Found     |requested UE context, the AMF   |
|                  | |       |          |shall return this status code.  |
|                  | |       |          |The "cause" attribute is set to:|
|                  | |       |          |- CONTEXT_NOT_FOUND             |



6.1.3.3  Resource: N1N2 Subscriptions Collection for Individual UE Contexts


6.1.3.3.1   Description

This resource represents the collection under an individual UE context for
storing the subscriptions for notifications of UE specific N1 and N2
message types. This resource is modelled as the Collection resource
archetype (see subclause C.2 of 3GPP TS 29.501 [5]).


6.1.3.3.2   Resource Definition

Resource URI: {apiRoot}/namf-comm/v1/{ueContextId}/n1-n2-
messages/subscriptions

This resource shall support the resource URI variables defined in
table 6.1.3.3.2-1.

         Table 6.1.3.8.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |
|ueContextId   |Represents the Subscription Permanent Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.2)                            |
|              |pattern: "(imsi-[0-9]{5,15}|nai-.+)"                        |
|              |Or represents the Permanent Equipment Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.3)                            |
|              |pattern: "(imei-[0-9]{15})"                                 |



6.1.3.3.3.1 POST

This method creates an individual N1/N2 information subscription resource
for UE related N1/N2 information. This method is used by NF Service
Consumers (e.g. LMF) to subscribe for notifications about UE related N1/N2
Information.

This method shall support the request data structures specified in
table 6.1.3.3.3.1-2 and the response data structures and response codes
specified in table 6.1.3.3.3.1-3.

 Table 6.1.3.3.3.1-2: Data structures supported by the POST Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|UeN1N2InfoSu|C |0..1     |Representation of the subscription for N1 and/or |
|bscriptionCr|  |         |N2 information notification. It shall contain the|
|eateData    |  |         |information regarding N1 and/or N2 information to|
|            |  |         |be notified and the callback URI for the         |
|            |  |         |respective notifications.                        |


 Table 6.1.3.3.3.1-3: Data structures supported by the POST Response Body on
                                this resource

|Data type   |P |Cardinali|Response|Description                              |
|            |  |ty       |codes   |                                         |



6.1.3.3.4   Resource Custom Operations

There are no custom operations supported on this resource.


6.1.3.4  Resource: N1N2 Individual Subscription


6.1.3.4.1   Description

This resource represents the individual subscription for the subscription
for notifications of UE specific N1 and N2 message types. This resource is
modelled as the Document resource archetype (see subclause C.2 of
3GPP TS 29.501 [5]).


6.1.3.4.2   Resource Definition

Resource URI: {apiRoot}/namf-comm/v1/{ueContextId}/n1-n2-
messages/subscriptions/{subscriptionId}

This resource shall support the resource URI variables defined in
table 6.1.3.4.2-1.

         Table 6.1.3.4.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |
|ueContextId   |Represents the Subscription Permanent Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.2)                            |
|              |pattern: "(imsi-[0-9]{5,15}|nai-.+)"                        |
|              |Or represents the Permanent Equipment Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.3)                            |
|              |pattern: "(imei-[0-9]{15})"                                 |
|subscriptionId|Represents the individual subscription to the UE specific   |
|              |N1/N2 message notification.                                 |



6.1.3.4.3.1 DELETE

This method deletes an individual N1/N2 message notification subscription
resource for an individual UE. This method is used by NF Service Consumers
(e.g. LMF) to unsubscribe for notifications about UE related N1/N2
information.

This method shall support the request data structures specified in
table 6.1.3.4.3.1-2 and the response data structures and response codes
specified in table 6.1.3.4.3.1-3.

  Table 6.1.3.4.3.1-2: Data structures supported by the DELETE Request Body
                              on this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|n/a         |  |         |                                                 |


 Table 6.1.3.4.3.1-3: Data structures supported by the DELETE Response Body
                              on this resource

|Data type   |P |Cardinali|Response|Description                              |
|            |  |ty       |codes   |                                         |



6.1.3.4.4   Resource Custom Operations

There are no custom operations supported on this resource.


6.1.3.5  Resource: N1 N2 Messages Collection


6.1.3.5.1   Description

This resource represents the collection on which UE related N1 messages and
N2 information transfer are initiated and the N1 information for the UE is
stored temporarily until the UE is reachable. This resource is modelled
with the Collection resource archetype (see subclause C.2 of
3GPP TS 29.501 [5]).


6.1.3.5.2   Resource Definition

Resource URI: {apiRoot}/namf-comm/v1/ue-contexts/{ueContextId}/n1-n2-
messages

This resource shall support the resource URI variables defined in
table 6.1.3.5.2-1.

         Table 6.1.3.5.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |
|ueContextId   |Represents the Subscription Permanent Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.2)                            |
|              |pattern: "(imsi-[0-9]{5,15}|nai-.+)"                        |
|              |Or represents the Permanent Equipment Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.3)                            |
|              |pattern: "(imei-[0-9]{15})"                                 |



6.1.3.5.3   Resource Standard Methods


6.1.3.5.3.1 POST

This method initiates a N1 message and/or N2 message transfer at the AMF
and may create a resource to store the N1 message if the UE is not
reachable or if the UE is paged.

This method shall support the request data structures specified in table
6.1.3.5.3.1-2 and the response data structures and response codes specified
in table 6.1.3.5.3.1-3.

 Table 6.1.3.5.3.1-1: Data structures supported by the POST Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|N1N2MessageD|M |1        |This contains:                                   |
|ata         |  |         |- N1 message, if the NF Service Consumer requests|
|            |  |         |to transfer an N1 message to the UE or;          |
|            |  |         |- N2 information, if the NF Service Consumer     |
|            |  |         |requests to transfer an N2 information to the    |
|            |  |         |5G-AN or;                                        |
|            |  |         |- both, if the NF Service Consumer requests to   |
|            |  |         |transfer both an N1 message to the UE and an N2  |
|            |  |         |information to the 5G-AN.                        |


 Table 6.1.3.5.3.1-3: Data structures supported by the POST Response Body on
                                this resource

|Data type           |P|Cardina|Respons|Description                         |
|                    | |lity   |e      |                                    |
|                    | |       |codes  |                                    |
|N1N2MessageTransferR|M|1      |200 OK |This represents the case where the  |
|spData              | |       |       |AMF is able to successfully transfer|
|                    | |       |       |the N1/N2 message to the UE and/or  |
|                    | |       |       |the AN. The cause included in the   |
|                    | |       |       |response body shall be              |
|                    | |       |       |"N1_N2_TRANSFER_INITIATED" in this  |
|                    | |       |       |case.                               |
|ProblemDetails      |M|1      |307    |This represents the case when the   |
|                    | |       |Tempora|related UE context is not fully     |
|                    | |       |ry     |available at the target NF Service  |
|                    | |       |Redirec|Consumer (e.g. AMF) during a planned|
|                    | |       |t      |maintenance case (e.g. AMF planned  |
|                    | |       |       |maintenance without UDSF case). The |
|                    | |       |       |"cause" attribute shall be set to   |
|                    | |       |       |one of the following application    |
|                    | |       |       |error:                              |
|                    | |       |       |- NF_CONSUMER_REDIRECT_ONE_TXN      |
|                    | |       |       |See table 6.1.7.3-1 for the         |
|                    | |       |       |description of these errors         |
|                    | |       |       |The Location header of the response |
|                    | |       |       |shall be set to the target NF       |
|                    | |       |       |Service Consumer (e.g. AMF) to which|
|                    | |       |       |the request is redirected.          |
|ProblemDetails      |M|1      |404 Not|This represents the case when the   |
|                    | |       |Found  |related UE is not found in the NF   |
|                    | |       |       |Service Consumer (e.g. AMF). The    |
|                    | |       |       |"cause" attribute shall be set to   |
|                    | |       |       |one of the following application    |
|                    | |       |       |error:                              |
|                    | |       |       |- CONTEXT_NOT_FOUND                 |
|                    | |       |       |See table 6.1.7.3-1 for the         |
|                    | |       |       |description of these errors         |
|N1N2MessageTransferE|M|1      |409    |This represents the case where the  |
|rror                | |       |Conflic|AMF rejects the N1N2MessageTransfer |
|                    | |       |t      |request due to an ongoing paging for|
|                    | |       |       |the same or higher priority request.|
|                    | |       |       |The cause attribute of the          |
|                    | |       |       |ProblemDetails structure shall be   |
|                    | |       |       |set to:                             |
|                    | |       |       |- HIGHER_PRIORITY_REQUEST_ONGOING   |
|N1N2MessageTransferE|M|1      |504    |This represents the case where the  |
|rror                | |       |Gateway|UE is not reachable at the AMF and  |
|                    | |       |Timeout|the AMF is unable to page the UE.   |
|                    | |       |       |The cause attribute of the          |
|                    | |       |       |ProblemDetails structure shall be   |
|                    | |       |       |set to:                             |
|                    | |       |       |- UE_NOT_REACHABLE, if the paging   |
|                    | |       |       |fails or the UE is not reachable for|
|                    | |       |       |paging;                             |
|                    | |       |       |- UE_IN_NON_ALLOWED_AREA, if the UE |
|                    | |       |       |is in a non-allowed area            |



6.1.3.6  Resource: subscriptions collection


6.1.3.6.1   Description

This resource represents a collection of subscriptions of NF service
consumers to the status change of the AMF identified by the GUAMI(s).

This resource is modelled as the Collection resource archetype (see
subclause C.2 of 3GPP TS 29.501 [5]).


6.1.3.6.2   Resource Definition

Resource URI:{apiRoot}/namf-comm/v1/subscriptions

This resource shall support the resource URI variables defined in
table 6.1.3.6.2-1.

         Table 6.1.3.6.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |



6.1.3.6.3   Resource Standard Methods


6.1.3.6.3.1 POST

This method creates a new subscription. This method shall support the URI
query parameters specified in table 6.1.3.6.3.1-1.

  Table 6.1.3.6.3.1-1: URI query parameters supported by the POST method on
                                this resource

|Name       |Data type |P |Cardinal|Description                            |
|           |          |  |ity     |                                       |


This method shall support the request data structures specified in table
6.1.3.6.3.1-2 and the response data structures and response codes specified
in table 6.1.3.3.3.1-3.

 Table 6.1.3.6.3.1-2: Data structures supported by the POST Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|Subscription|M |1        |The request body contains the input parameters   |
|Data        |  |         |for the subscription. These parameters include,  |
|            |  |         |e.g.:                                            |
|            |  |         |- GUAMI(s)                                       |
|            |  |         |- amfStatusUri                                   |


 Table 6.1.3.6.3.1-3: Data structures supported by the POST Response Body on
                                this resource

|Data type       |P|Cardina|Respons|Description                            |
|                | |lity   |e      |                                       |
|                | |       |codes  |                                       |
|ProblemDetails  |M|1      |400 Bad|The "cause" attribute shall be set to  |
|                | |       |Request|one of the following application       |
|                | |       |       |errors:                                |
|                | |       |       |- INVALID_MSG_FORMAT                   |
|                | |       |       |- MANDAT_IE_INCORRECT                  |
|                | |       |       |- MANDAT_IE_MISSING                    |
|                | |       |       |See table 6.1.7.3-1 for the description|
|                | |       |       |of these errors.                       |
|ProblemDetails  |M|1      |403    |The "cause" attribute shall be set to  |
|                | |       |Forbidd|the following application error:       |
|                | |       |en     |- UNSPECIFIED                          |
|                | |       |       |See table 6.1.7.3-1 for the description|
|                | |       |       |of this error.                         |
|ProblemDetails  |M|1      |500    |The "cause" attribute shall be set to  |
|                | |       |Interna|the following application error:       |
|                | |       |l      |- SYSTEM_FAILURE                       |
|                | |       |Server |See table 6.1.7.3-1 for the description|
|                | |       |Error  |of this error.                         |
|ProblemDetails  |M|1      |503    |The "cause" attribute shall be set to  |
|                | |       |Service|the following application error:       |
|                | |       |Unavail|- NF_CONGESTION                        |
|                | |       |able   |See table 6.1.7.3-1 for the description|
|                | |       |       |of this error.                         |



6.1.3.7  Resource: individual subscription


6.1.3.7.1   Description

This resource represents an individual subscription of a NF service
consumer to the status change of the AMF identified by the GUAMI(s).

This resource is modelled as the Document resource archetype (see subclause
C.1 of 3GPP TS 29.501 [5]).


6.1.3.7.2   Resource Definition

Resource URI: {apiRoot}/namf-comm/v1/subscriptions/{subscriptionId}

This resource shall support the resource URI variables defined in
table 6.1.3.7.2-1.

         Table 6.1.3.7.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |
|subscriptionId|Represents a specific subscription                          |



6.1.3.7.3   Resource Standard Methods


6.1.3.7.3.1 DELETE

This method terminates an existing subscription. This method shall support
the URI query parameters specified in table 6.1.3.7.3.1-1.

 Table 6.1.3.4.3.1-1: URI query parameters supported by the DELETE method on
                                this resource

|Name       |Data type |P |Cardinal|Description                            |
|           |          |  |ity     |                                       |


This method shall support the request data structures specified in table
6.1.3.7.3.1-2 and the response data structures and response codes specified
in table 6.1.3.7.3.1-3.

  Table 6.1.3.7.3.1-2: Data structures supported by the DELETE Request Body
                              on this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|n/a         |  |         |                                                 |


 Table 6.1.3.7.3.1-3: Data structures supported by the DELETE Response Body
                              on this resource

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |
|FFS        |  |         |        |                                        |
|ProblemDeta|M |1        |404 Not |If the AMF does not have the requested  |
|ils        |  |         |Found   |subscription, the AMF shall return this |
|           |  |         |        |status code. The "cause" attribute is   |
|           |  |         |        |set to:                                 |
|           |  |         |        |- CONTEXT_NOT_FOUND                     |



6.1.3.7.3.2 PUT

This method replaces an existing subscription completely. This method shall
support the URI query parameters specified in table 6.1.3.7.3.2-1.

  Table 6.1.3.7.3.2-1: URI query parameters supported by the PUT method on
                                this resource

|Name       |Data type |P |Cardinal|Description                            |
|           |          |  |ity     |                                       |


This method shall support the request data structures specified in table
6.1.3.7.3.2-2 and the response data structures and response codes specified
in table 6.1.3.7.3.2-3.

  Table 6.1.3.7.3.2-2: Data structures supported by the PUT Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|Subscription|M |1        |The request body contains the input parameters   |
|Data        |  |         |for the subscription. These parameters include,  |
|            |  |         |e.g.:                                            |
|            |  |         |- GUAMI(s)                                       |
|            |  |         |- amfStatusUri                                   |


 Table 6.1.3.7.3.2-3: Data structures supported by the PUT Response Body on
                                this resource

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |
|ProblemDeta|M |1        |403     |This case represents the failure update |
|ils        |  |         |Forbidde|of an existing subscription.            |
|           |  |         |n       |                                        |



6.1.3.8  Resource: Non UE N2Messages Collection


6.1.3.8.1   Description

This resource represents the collection on which custom operations to
transfer the N2 message towards the 5G-AN are specified. This resource is
modelled with the Collection resource archetype (see subclause C.2 of
3GPP TS 29.501 [5]).


6.1.3.8.2   Resource Definition

Resource URI: {apiRoot}/namf-comm/v1/non-ue-n2-messages

This resource shall support the resource URI variables defined in
table 6.1.3.8.2-1.

         Table 6.1.3.5.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |



6.1.3.8.3   Resource Standard Methods

There are no resource standard methods for the non-ue-n2-messages
collection resource in this release of this specification.


6.1.3.8.4   Resource Custom Operations


6.1.3.8.4.1 Overview

                   Table 6.1.3.8.4.1-1: Custom operations

|Custom operaration URI   |Mapped HTTP  |Description                   |
|                         |method       |                              |
|{resourceUri}/transfer   |POST         |Transfer the N2 message to    |
|                         |             |5G-AN.                        |



6.1.3.8.4.2 Operation: transfer


6.1.3.8.4.2.1 Description

The {resourceUri}/transfer custom operation is used to initiate a non UE
associated N2 information transfer to the identified 5G-AN nodes. This
custom operation uses the HTTP POST method.


6.1.3.8.4.2.2 Operation Definition

This operation shall support the request data structures specified in table
6.1.3.8.4.2.2-1 and the response data structure and response codes
specified in table 6.1.3.8.4.2.2-2.

  Table 6.1.3.8.4.2.2-1: Data structures supported by the POST Request Body
                              on this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|N2Informatio|M |1        |Representation of the data to be sent to the     |
|nTransferReq|  |         |5G-AN node(s) by the AMF.                        |
|Data        |  |         |                                                 |


 Table 6.1.3.8.4.2.2-2: Data structures supported by the POST Response Body
                              on this resource

|Data type   |P |Cardinali|Response|Description                              |
|            |  |ty       |codes   |                                         |
|N2Informatio|M |1        |400 Bad |The "cause" attribute shall be set to one|
|nTransferErr|  |         |Request |of the following application errors:     |
|or          |  |         |        |- INVALID_MSG_FORMAT                     |
|            |  |         |        |- MANDAT_IE_INCORRECT                    |
|            |  |         |        |- MANDAT_IE_MISSING                      |
|            |  |         |        |See table 6.1.7.3-1 for the description  |
|            |  |         |        |of these errors.                         |
|N2Informatio|M |1        |403     |The "cause" attribute shall be set to one|
|nTransferErr|  |         |Forbidde|of the following application errors:     |
|or          |  |         |n       |- UNSPECIFIED                            |
|            |  |         |        |See table 6.1.7.3-1 for the description  |
|            |  |         |        |of these errors.                         |
|N2Informatio|M |1        |404 Not |The "cause" attribute shall be set to one|
|nTransferErr|  |         |Found   |of the following application errors:     |
|or          |  |         |        |- CONTEXT_NOT_FOUND                      |
|            |  |         |        |See table 6.1.7.3-1 for the description  |
|            |  |         |        |of these errors.                         |
|N2Informatio|M |1        |500     |The "cause" attribute shall be set to one|
|nTransferErr|  |         |Internal|of the following application errors:     |
|or          |  |         |Server  |- SYSTEM_FAILURE                         |
|            |  |         |Error   |- INSUFFIC_RES                           |
|            |  |         |        |See table 6.1.7.3-1 for the description  |
|            |  |         |        |of these errors.                         |
|N2Informatio|M |1        |503     |The "cause" attribute shall be set to one|
|nTransferErr|  |         |Service |of the following application errors:     |
|or          |  |         |Unavaila|- NF_CONGESTION                          |
|            |  |         |ble     |See table 6.1.7.3-1 for the description  |
|            |  |         |        |of these errors.                         |



6.1.3.9  Resource: Non UE N2Messages Subscriptions Collection


6.1.3.9.1   Description

This resource represents the collection on which individual subscriptions
for non UE N2 messages from the 5G-AN are stored. This resource is modelled
with the Collection resource archetype (see subclause C.2 of
3GPP TS 29.501 [5]).


6.1.3.9.2   Resource Definition

Resource URI: {apiRoot}/namf-comm/v1/non-ue-n2-messages/subscriptions

This resource shall support the resource URI variables defined in
table 6.1.3.9.2-1.

         Table 6.1.3.9.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |



6.1.3.9.3   Resource Standard Methods


6.1.3.9.3.1 POST

This method creates an individual N2 information subscription resource for
non UE related N2 information. This method is used by NF Service Consumers
(e.g. LMF, CBCF/PWS-IWF) to subscribe for notifications about non UE
related N2 Information from a specific 5G-AN node, or from any 5G-AN node.

This method shall support the request data structures specified in
table 6.1.3.9.3.1-2 and the response data structures and response codes
specified in table 6.1.3.9.3.1-3.

 Table 6.1.3.9.3.1-2: Data structures supported by the POST Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|NonUeN2InfoS|M |1        |Representation of the subscription for N2        |
|ubscriptionC|  |         |information notification.                        |
|reateData   |  |         |                                                 |


 Table 6.1.3.9.3.1-3: Data structures supported by the POST Response Body on
                                this resource

|Data type   |P |Cardinali|Response|Description                              |
|            |  |ty       |codes   |                                         |
|NonUeN2InfoS|M |1        |201     |This case represents the successful      |
|ubscriptionC|  |         |Created |creation of the subscription for N2      |
|reatedData  |  |         |        |information notification.                |
|            |  |         |        |                                         |
|            |  |         |        |Upon success, a response body is returned|
|            |  |         |        |containing the representation describing |
|            |  |         |        |the status of the request. The Location  |
|            |  |         |        |header shall carry the location (URI) of |
|            |  |         |        |the created subscription resource.       |
|ProblemDetai|M |1        |403     |If the NF Service Consumer is not        |
|ls          |  |         |Forbidde|authorized to subscribe for non UE N2    |
|            |  |         |n       |message notifications, the AMF shall     |
|            |  |         |        |return this status code with the         |
|            |  |         |        |ProblemDetails                           |



6.1.3.9.4   Resource Custom Operations

There are no custom operations supported on this resource.


6.1.3.10 Resource: Non UE N2 Message Notification Individual Subscription


6.1.3.10.1  Description

This resource represents the individual subscription for the notifications
of non UE specific N2 message types (e.g. NRPPa, PWS Notifications). This
resource is modelled with the Store resource archetype (see subclause C.3
of 3GPP TS 29.501 [5]).


6.1.3.10.2  Resource Definition

Resource URI: {apiRoot}/namf-comm/v1/non-ue-n2-
messages/subscriptions/{n2NotifySubscriptionId}

This resource shall support the resource URI variables defined in
table 6.1.3.10.2-1.

         Table 6.1.3.7.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.1.1                                         |
|n2NotifySubscr|Represents the individual subscription to the non UE        |
|iptionId      |specific N2 message notification.                           |



6.1.3.10.3  Resource Standard Methods


6.1.3.10.3.1  DELETE

This method deletes an individual N2 message notification subscription
resource for non UE associated N2 information. This method is used by NF
Service Consumers (e.g. LMF) to unsubscribe for notifications about non UE
related N2 information.

This method shall support the request data structures specified in
table 6.1.3.10.3.1-2 and the response data structures and response codes
specified in table 6.1.3.10.3.1-3.

 Table 6.1.3.10.3.1-2: Data structures supported by the DELETE Request Body
                              on this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|n/a         |  |         |                                                 |


 Table 6.1.3.10.3.1-3: Data structures supported by the DELETE Response Body
                              on this resource

|Data type   |P |Cardinali|Response|Description                              |
|            |  |ty       |codes   |                                         |



6.1.3.10.4  Resource Custom Operations

There are no custom operations supported on this resource.


6.1.4  Custom Operations without associated resources

There are no custom operations without associated resources supported on
Namf_Communication Service.


6.1.5  Notifications


6.1.5.1  General

The notifications provided by the Namf_Communication service are specified
in this clause.


6.1.5.2  AMF Status Change Notification


6.1.5.2.1   Description

If a NF service consumer (e.g. SMF) has subscribed to AMF Status Change on
Namf_Communication Service, when AMF aware of a change of its own status,
AMF shall create a notification including the current state, and shall
deliver the notification to the call-back URI, following Subscribe/Notify
mechanism defined in 3GPP TS 29.501 [2].


6.1.5.2.2   Notification Definition

Call-back URI: {amfStatusCallbackUri}

Call-back URI is provided by NF Service Consumer during creation of the
subscription.


6.1.5.2.3   Notification Standard Methods


6.1.5.2.3.1 POST

This method shall support the request data structures specified in table
6.1.5.2.3.1-1 and the response data structures and response codes specified
in table 6.1.5.2.3.1-2.

   Table 6.1.5.2.3.1-1: Data structures supported by the POST Request Body

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|AmfStatusCha|M |1        |Representation of the AMF status change          |
|ngeNotificat|  |         |notification.                                    |
|ion         |  |         |                                                 |


  Table 6.1.5.2.3.1-2: Data structures supported by the POST Response Body

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |
|ProblemDeta|M |1        |404 Not |This case represents the failure of the |
|ils        |  |         |Found   |notification due to the context is not  |
|           |  |         |        |found.                                  |
|           |  |         |        |                                        |
|           |  |         |        |The "cause" attribute shall be set to:  |
|           |  |         |        |- CONTEXT_NOT_FOUND                     |



6.1.5.3  Non UE N2 Information Notification


6.1.5.3.1   Description

This resource represents the callback reference provided by the NF Service
Consumer (e.g. LMF, CBCF/PWS-IWF) to receive notifications about N2
information that are not related to a UE.


6.1.5.3.2   Notification Definition

Callback URI: {n2NotifyCallbackUri}

This notification shall support the resource URI variables defined in
table 6.1.5.2.2-1.

       Table 6.1.5.3.2-1: Resource URI variables for this notification

|Name          |Definition                                                  |
|n2NotifyCallba|Callback reference provided by the NF Service Consumer      |
|ckUri         |during the subscription to this notification.               |



6.1.5.3.3   Notification Standard Methods


6.1.5.3.3.1 POST

This method sends an N2 information notification to the NF Service Consumer
(e.g. LMF, CBCF/PWS-IWF).

This method shall support the request data structures specified in table
6.1.5.3.3.1-2 and the response data structures and response codes specified
in table 6.1.5.3.3.1-3.

   Table 6.1.5.3.3.1-2: Data structures supported by the POST Request Body

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|N2Informatio|M |1        |Representation of the N2 information             |
|nNotificatio|  |         |notification.                                    |
|n           |  |         |                                                 |


  Table 6.1.5.3.3.1-3: Data structures supported by the POST Response Body

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |



6.1.5.4  N1 Message Notification


6.1.5.4.1   Description

This resource represents the callback reference provided by the NF Service
Consumer (e.g. LMF) to receive notifications about N1 message from the UE
(e.g. NRPP messages).


6.1.5.4.2   Notification Definition

Callback URI: { n1NotifyCallbackUri }

Callback URI is provided by the NF Service Consumer during the subscription
to this notification. . The callback URI for N1 message notification may
also be obtained from the NRF, if the NF Service Consumer has registered it
in the NF Profile with the NRF.


6.1.5.4.3   Notification Standard Methods


6.1.5.4.3.1 POST

This method sends an N1 message notification to the NF Service Consumer
(e.g. LMF).

This method shall support the request data structures specified in table
6.1.5.4.3.1-2 and the response data structures and response codes specified
in table 6.1.5.4.3.1-3.

   Table 6.1.5.4.3.1-2: Data structures supported by the POST Request Body

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|N1MessageNot|M |1        |Representation of the N1 message notification.   |
|ification   |  |         |                                                 |


  Table 6.1.5.4.3.1-3: Data structures supported by the POST Response Body

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |
|ProblemDeta|M |1        |403     |This case represents, the NF service    |
|ils        |  |         |Forbidde|consumer failing to accept the          |
|           |  |         |n       |processing of the notified N1 message.  |
|           |  |         |        |The detailed information shall be       |
|           |  |         |        |provided in the ProblemDetails          |
|           |  |         |        |structure.                              |



6.1.5.5  UE Specific N2 Information Notification


6.1.5.5.1   Description

This resource represents the callback reference provided by the NF Service
Consumer (e.g. LMF) to receive notifications about UE specific N2
information.


6.1.5.5.2   Notification Definition

Resource URI: {n2NotifyCallbackUri}

Callback URI is provided by the NF Service Consumer during the subscription
to this notification.


6.1.5.5.3   Notification Standard Methods


6.1.5.5.3.1 POST

This method sends an N2 information notification to the NF Service Consumer
(e.g. LMF).

This method shall support the request data structures specified in table
6.1.5.5.3.1-2 and the response data structures and response codes specified
in table 6.1.5.5.3.1-3.

   Table 6.1.5.5.3.1-2: Data structures supported by the POST Request Body

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|N2Informatio|M |1        |Representation of the N2 information             |
|nNotificatio|  |         |notification.                                    |
|n           |  |         |                                                 |


  Table 6.1.5.5.3.1-3: Data structures supported by the POST Response Body

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |



6.1.5.6  N1N2 Message Transfer Failure Notification


6.1.5.6.1   Description

This resource represents the callback reference provided by the NF Service
Consumer (e.g. SMF) to receive notifications about failure to deliver N1 /
N2 message.


6.1.5.6.2   Notification Definition

Resource URI: {n1n2TransferFailureCallbackUri}

Callback URI is provided by the NF Service Consumer during the UE specific
N1N2MessageTransfer operation (see subclause 6.1.3.5.3.1.


6.1.5.6.3   Notification Standard Methods


6.1.5.6.3.1 POST

This method sends an N1/N2 message transfer failure notification to the NF
Service Consumer (e.g. SMF).

This method shall support the request data structures specified in table
6.1.5.6.3.1-1 and the response data structures and response codes specified
in table 6.1.5.6.3.1-3.

   Table 6.1.5.6.3.1-1: Data structures supported by the POST Request Body

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|N1N2MsgTxfrF|M |1        |Representation of the N1/N2 message transfer     |
|ailureNotifi|  |         |failure notification.                            |
|cation      |  |         |                                                 |


  Table 6.1.5.6.3.1-2: Data structures supported by the POST Response Body

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |



6.1.5.7  Registration Complete Notification


6.1.5.7.1   Description

This resource represents the callback reference provided by the NF Service
Consumer (e.g. Source AMF) to receive notifications about completion of UE
registration at the AMF.


6.1.5.7.2   Notification Definition

Resource URI: {notifyCallbackUri}.

Callback URI is provided by the NF Service Consumer during an earlier UE
context transfer.


6.1.5.7.3   Notification Standard Methods


6.1.5.7.3.1 POST

This method sends an UE context registration complete notification to the
NF Service Consumer (e.g. Source AMF).

This method shall support the request data structures specified in table
6.1.5.7.3.1-2 and the response data structures and response codes specified
in table 6.1.5.7.3.1-3.

   Table 6.1.5.7.3.1-1: Data structures supported by the POST Request Body

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|UERegComplet|M |1        |Information about completed UE context transfer. |
|eNotifData  |  |         |                                                 |


  Table 6.1.5.7.3.1-2: Data structures supported by the POST Response Body

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |



6.1.6  Data Model


6.1.6.1  General

This subclause specifies the application data model supported by the API.

Table 6.1.6.1-1 specifies the data types defined for the Namf_Communication
service based interface protocol.

           Table 6.1.6.1-1: Namf_Communication specific Data Types

|Data type                 |Section   |Description                     |
|                          |defined   |                                |
|SubscriptionData          |6.1.6.2.2 |Information within              |
|                          |          |AMFStatusChangeSubscribe        |
|AmfStatusChangeNotificatio|6.1.6.2.3 |Information within              |
|n                         |          |AMFStatusChangeNotify           |
|AmfStatusInfo             |6.1.6.2.4 |Information within              |
|                          |          |AMFStatusChangeNotify           |
|AssignEbiData             |6.1.6.2.5 |Represents information needed   |
|                          |          |for AMF to assign EBIs.         |
|AssignedEbiData           |6.1.6.2.6 |Represents successful assignment|
|                          |          |of EBI(s).                      |
|AssignEbiFailed           |6.1.6.2.7 |Represents failed assignment of |
|                          |          |EBI(s)                          |
|UEContextRelease          |6.1.6.2.8 |Information within              |
|                          |          |ReleaseUeContext                |
|N2InformationTransferReqDa|6.1.6.2.9 |N2 information requested to be  |
|ta                        |          |transferred to 5G AN.           |
|NonUeN2InfoSubscriptionCre|6.1.6.2.10|Subscription information for non|
|ateData                   |          |UE specific N2 information      |
|                          |          |notification.                   |
|NonUeN2InfoSubscriptionCre|6.1.6.2.11|The created subscription for non|
|atedData                  |          |UE specific N2 information      |
|                          |          |notification.                   |
|UeN1N2InfoSubscriptionCrea|6.1.6.2.12|Subscription information for UE |
|teData                    |          |specific N1 and/or N2           |
|                          |          |information notification.       |
|UeN1N2InfoSubscriptionCrea|6.1.6.2.13|The created subscription for UE |
|tedData                   |          |specific N1 and/or N2           |
|                          |          |information notification.       |
|N2InformationNotification |6.1.6.2.14|N2 information for notification.|
|N2InfoContainer           |6.1.6.2.15|N2 information container.       |
|N1MessageNotification     |6.1.6.2.16|N1 message notification data    |
|                          |          |structure.                      |
|N1MessageContainer        |6.1.6.2.17|N1 Message Container            |
|N1N2MessageData           |6.1.6.2.18|N1/N2 message container         |
|N1N2MessageTransferRspData|6.1.6.2.19|N1/N2 message transfer response |
|RegistrationContextContain|6.1.6.2.20|Registration Context Container  |
|er                        |          |used to send the UE context     |
|                          |          |information, N1 message from UE,|
|                          |          |AN address etc during           |
|                          |          |Registration with AMF           |
|                          |          |re-allocation procedure.        |
|AreaOfValidity            |6.1.6.2.21|Area of validity information for|
|                          |          |N2 information transfer         |
|RefToBinaryData           |6.1.6.2.22|Cross-Reference to binary data  |
|                          |          |encoded within a binary body    |
|                          |          |part in an HTTP multipart       |
|                          |          |message.                        |
|UeContextTransferReqData  |6.1.6.2.23|Represents to start transferring|
|                          |          |of an individual ueContext      |
|                          |          |resource from old AMF to new    |
|                          |          |AMF.                            |
|UeContextTransferRspData  |6.1.6.2.24|Indicates the transferring of   |
|                          |          |the individual ueContext        |
|                          |          |resource is started             |
|                          |          |successfully.                   |
|UeContext                 |6.1.6.2.25|Represents an individual        |
|                          |          |ueContext resource              |
|N2SmInformation           |6.1.6.2.26|Represents the session          |
|                          |          |management SMF related N2       |
|                          |          |information data part.          |
|N2InfoContent             |6.1.6.2.27|Represents a transparent N2     |
|                          |          |information content to be       |
|                          |          |relayed by AMF.                 |
|NrppaInformation          |6.1.6.2.28|Represents a NRPPa related N2   |
|                          |          |information data part.          |
|PwsInformation            |6.1.6.2.29|Represents a PWS related        |
|                          |          |information data part.          |
|N1N2MsgTxfrFailureNotifica|6.1.6.2.30|N1/N2 Message Transfer Failure  |
|tion                      |          |Notification                    |
|N1N2MessageTransferError  |6.1.6.2.31|N1/N2 Message Transfer Error    |
|N2N2MsgTxfrErrDetail      |6.1.6.2.32|N1/N2 Message Transfer Error    |
|                          |          |Details                         |
|N2InformationTransferRspDa|6.1.6.2.33|Indicates a successful delivery |
|ta                        |          |of N2 Information to the AN.    |
|MmContext                 |6.1.6.2.34|Represents a Mobility Management|
|                          |          |Context in UE Context           |
|SeafData                  |6.1.6.2.35|Represents SEAF data derived    |
|                          |          |from data received from AUSF    |
|NasSecurityMode           |6.1.6.2.36|Indicates the NAS Security Mode |
|PduSessionContext         |6.1.6.2.37|Represents a PDU Session Context|
|                          |          |in UE Context                   |
|NssaiMapping              |6.1.6.2.38|Represents a map of a S-NSSAI in|
|                          |          |serving PLMN to a S-NSSAI in    |
|                          |          |home PLMN.                      |
|UERegCompleteNotifData    |6.1.6.2.39|Provides information on the UE  |
|                          |          |registration completion at a    |
|                          |          |target AMF.                     |
|AssignEbiError            |6.1.6.3.40|Represents the details regarding|
|                          |          |EBI assignment failure.         |
|UeContextCreateData       |6.1.6.2.41|Indicates a request to create an|
|                          |          |individual ueContext resource   |
|UeContextCreatedData      |6.1.6.2.42|Indicates a successful creation |
|                          |          |of an individual ueContext      |
|                          |          |resource                        |
|UeContextCreateError      |6.1.6.2.43|Represents an error when        |
|                          |          |creating a UE context           |
|NgRanTargetId             |6.1.6.2.44|Indicates a NG RAN as target of |
|                          |          |the handover                    |
|N2InformationTransferError|6.1.6.2.45|Error within                    |
|                          |          |NonUeN2MessageTransfer response |
|PWSResponseData           |6.1.6.2.46|Represents the type of PWS      |
|PWSErrorData              |6.1.6.2.47|Represents the type of PWS error|
|GlobalRanNodeId           |6.1.6.2.48|Represents the type of Global   |
|                          |          |Ran Node Id                     |
|NgKsi                     |6.1.6.2.49|Represents the ngKSI (see       |
|                          |          |3GPP TS 33.501 [x1])            |
|KeyAmf                    |6.1.6.2.50|Represents the Kamf or K’amf.   |
|                          |          |(see 3GPP TS 33.501 [x1]).      |
|EpsBearerId               |6.1.6.3.2 |EPS Bearer Identifier           |
|NgApCause                 |6.1.6.3.2 |Represents the NG AP cause code |
|                          |          |values                          |
|                          |          |                                |
|GlobalRanNodeId           |6.1.6.2.51|Represents the identifier of the|
|                          |          |NG RAN node                     |
|                          |          |                                |
|Ppi                       |6.1.6.3.2 |Paging Policy Indicator         |
|NasCount                  |6.1.6.3.2 |Represents a NAS COUNT          |
|5gmmCapability            |6.1.6.3.2 |Represents a 5GMM capability    |
|UeSecurityCapability      |6.1.6.3.2 |Represents a UE Security        |
|                          |          |Capability                      |
|S1UeNetworkCapability     |6.1.6.3.2 |Represents a S1 UE Network      |
|                          |          |Capability                      |
|DrxParameter              |6.1.6.3.2 |Indicates the UE DRX Parameters |
|OmcIdentifier             |6.1.6.3.2 |Represents the OMC Identifier   |
|StatusChange              |6.1.6.3.3 |                                |
|N2InformationClass        |6.1.6.3.4 |                                |
|N1MessageClass            |6.1.6.3.5 |                                |
|N1N2MessageTransferCause  |6.1.6.3.6 |                                |
|UeContextTransferStatus   |6.1.6.3.7 |Describes the status of an      |
|                          |          |individual ueContext resource in|
|                          |          |UE Context Transfer procedures  |
|N2InformationTransferResul|6.1.6.3.8 |Describes the result of N2      |
|t                         |          |information transfer by AMF to  |
|                          |          |the AN.                         |
|CipheringAlgorithm        |6.1.6.3.9 |Indicates the supported         |
|                          |          |Ciphering Algorithm             |
|IntegrityAlgorithm        |6.1.6.3.10|Indicates the supported         |
|                          |          |Integrity Algorithm             |
|SmsSupport                |6.1.6.3.11|Indicates the supported SMS     |
|                          |          |delivery of a UE.               |
|ScType                    |6.1.6.3.12|Indicates the security context  |
|                          |          |type.                           |
|KeyAmfType                |6.1.6.3.13|Indicates the Kamf type.        |
|TransferReason            |6.1.6.3.14|Indicates UE Context Transfer   |
|                          |          |Reason                          |


Table 6.1.6.1-2 specifies data types re-used by the Namf service based
interface protocol from other specifications, including a reference to
their respective specifications and when needed, a short description of
their use within the Namf service based interface.

                  Table 6.1.6.1-2: Namf re-used Data Types

|Data type      |Reference    |Comments                                 |
|Snssai         |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Arp            |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|PduSesisonId   |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Guami          |3GPP TS 29.57|Globally Unique AMF Identifier           |
|               |1 [6]        |                                         |
|AmfName        |3GPP TS 29.57|The name of the AMF                      |
|               |1 [6]        |                                         |
|Supi           |3GPP TS 29.57|Subscription Permanent Identifier        |
|               |1 [6]        |                                         |
|IndicationFlags|3GPP TS 29.50|Indication Flags                         |
|               |2 [16]       |                                         |
|Cause          |3GPP TS 29.57|5G-AN Cause                              |
|               |1 [6]        |                                         |
|ProblemDetails |3GPP TS 29.57|Detailed problems in failure case        |
|               |1 [6]        |                                         |
|supportedFeatur|3GPP TS 29.57|Supported Features                       |
|es             |1 [6]        |                                         |
|TimeZone       |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|UserLocation   |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|AccessType     |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|AllowedNssai   |3GPP TS 29.53|                                         |
|               |1 [18]       |                                         |
|NfInstanceId   |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Uri            |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Ecgi           |3GPP TS 29.57|EUTRA Cell Identifier                    |
|               |1 [6]        |                                         |
|Ncgi           |3GPP TS 29.57|NR Cell Identifier                       |
|               |1 [6]        |                                         |
|Uint16         |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|5qi            |3GPP TS 29.57|5G QoS Identifier                        |
|               |1 [6]        |                                         |
|CorrelationID  |3GPP TS 29.57|LCS Correlation ID                       |
|               |2 [25]       |                                         |
|Pei            |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Dnn            |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Gpsi           |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|GroupId        |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|PlmnId         |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|MobilityRestric|3GPP TS 29.57|                                         |
|tions          |1 [6]        |                                         |
|RfspIndex      |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|EbiArpMapping  |3GPP TS 29.50|EBI - ARP mapping                        |
|               |2 [16]       |                                         |
|NsiId          |3GPP TS 29.53|                                         |
|               |1 [18]       |                                         |



6.1.6.2  Structured data types


6.1.6.2.1   Introduction

Structured data types used in Namf_Communication service are specified in
this clause.


6.1.6.2.2   Type: SubscriptionData

           Table 6.1.6.2.2-1: Definition of type SubscriptionData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|guamis         |Guami      |C |0..N    |This IE shall be absent for      |
|               |           |  |        |subscribing to status change for |
|               |           |  |        |any GUAMI supported by the AMF,  |
|               |           |  |        |it shall be present for          |
|               |           |  |        |subscribing to specific GUAMIs   |
|               |           |  |        |supported by the AMF.            |



6.1.6.2.3   Type: AmfStatusChangeNotification

      Table 6.1.6.2.3-1: Definition of type AmfStatusChangeNotification

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |



6.1.6.2.4   Type: AmfStatusInfo

             Table 6.1.6.2.4-1: Definition of type AmfStatusInfo

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|statusChange   |StatusChang|M |1       |This IE shall contain the Status |
|               |e          |  |        |change of the related GUAMIs     |
|targetamfName  |AmfName    |C |0..1    |This IE shall contain the target |
|               |           |  |        |AMF name in the AMF planned      |
|               |           |  |        |removal without UDSF scenario    |



6.1.6.2.5   Type: AssignEbiData

               Table 6.1.6.2.5-1: Definition of type AssignEbi

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|arps           |array(Arp) |C |1..N    |Represents a ARP list mapped to  |
|               |           |  |        |the QoS flow(s)                  |
|               |           |  |        |                                 |
|releasedEbiList|array(EpsBe|C |0..N    |This IE shall be present if the  |
|               |arerId)    |  |        |SMF needs to release the assigned|
|               |           |  |        |EBI(s) from QoS flows (e.g. when |
|               |           |  |        |the QoS flow is released).       |



6.1.6.2.6   Type: AssignedEbiData

              Table 6.1.6.2.6-1: Definition of type AssignedEbi

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|assignedEbis   |array(EbiAr|M |0..N    |This IE shall be present if the  |
|               |pMapping)  |  |        |AMF assigned the requested       |
|               |           |  |        |EBI(s). This IE shall contain the|
|               |           |  |        |successfully assigned EBIs.      |
|failedArpList  |array(Arp) |C |0..N    |This IE shall be present if the  |
|               |           |  |        |AMF fails to allocate EBIs for a |
|               |           |  |        |set of ARP(s).                   |
|releasedEbiList|array(EpsBe|C |0..N    |This IE shall be present if the  |
|               |arerId)    |  |        |NF Service Consumer requested the|
|               |           |  |        |release of EBI(s). This IE shall |
|               |           |  |        |contain the list of EBI(s)       |
|               |           |  |        |released at the AMF.             |



6.1.6.2.7   Type: AssignEbiFailed

            Table 6.1.6.2.7-1: Definition of type AssignEbiFailed

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|failedArpList  |array(Arp) |C |0..N    |This IE shall be present if the  |
|               |           |  |        |AMF fails to allocate EBIs for a |
|               |           |  |        |set of ARPs.                     |



6.1.6.2.8   Type: UEContextRelease

           Table 6.1.6.2.8-1: Definition of type UEContextRelease

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|unauthenticated|boolean    |C |0..1    |When present, this IE shall be   |
|Supi           |           |  |        |set as follows:                  |
|               |           |  |        |- true: unauthenticated SUPI;    |
|               |           |  |        |- false (default): authenticated |
|               |           |  |        |SUPI.                            |
|               |           |  |        |This IE shall be present if the  |
|               |           |  |        |SUPI is present in the message   |
|               |           |  |        |but is not authenticated and is  |
|               |           |  |        |for an emergency registered UE.  |
|ngapCause      |NgApCause  |M |1       |This IE shall contain the cause  |
|               |           |  |        |value received from the source   |
|               |           |  |        |5G-AN in the handover Cancel     |
|               |           |  |        |message received over the NGAP   |
|               |           |  |        |interface.                       |



6.1.6.2.9   Type: N2InformationTransferReqData

 Table 6.1.6.2.9-1: Definition of type N2InformationTransferReqDataTransfer

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|ecgi           |Ecgi       |C |0..N    |This IE shall be included if the |
|               |           |  |        |N2 information needs to be sent  |
|               |           |  |        |to the 5G-AN nodes that          |
|               |           |  |        |correspond to the list of EUTRA  |
|               |           |  |        |cell Ids provided.               |
|ncgi           |Ncgi       |C |0..N    |This IE shall be included if the |
|               |           |  |        |N2 information needs to be sent  |
|               |           |  |        |to the 5G-AN nodes that          |
|               |           |  |        |correspond to the list of NR cell|
|               |           |  |        |Ids provided.                    |
|globalRanNodeId|array(Globa|C |0..N    |This IE shall be included if the |
|               |lRanNodeId)|  |        |N2 information needs to be sent  |
|               |           |  |        |to the list of RAN nodes         |
|               |           |  |        |provided.                        |
|n2Information  |N2InfoConta|M |1       |This IE includes the information |
|               |iner       |  |        |to be sent on the N2 interface to|
|               |           |  |        |the identified 5G-AN nodes and   |
|               |           |  |        |additional information required  |
|               |           |  |        |for the processing of the message|
|               |           |  |        |by the AMF.                      |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.10  Type: NonUeN2InfoSubscriptionCreateData

  Table 6.1.6.2.10-1: Definition of type NonUeN2InfoSubscriptionCreateData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|anType         |array(Acces|C |0..N    |This IE shall be included, if the|
|               |sType)     |  |        |globalRanNodeId IE is not        |
|               |           |  |        |included and if the N2           |
|               |           |  |        |information from a specific      |
|               |           |  |        |access network needs to be       |
|               |           |  |        |subscribed. When included this IE|
|               |           |  |        |shall contain the access type of |
|               |           |  |        |the access network from which Non|
|               |           |  |        |UE specific N2 information is to |
|               |           |  |        |be notified.                     |
|n2InformationCl|N2Informati|M |1       |This IE represents the class of  |
|ass            |onClass    |  |        |N2 information that the NF       |
|               |           |  |        |Service Consumer requires to be  |
|               |           |  |        |notified.                        |
|n2NotifyCallbac|Uri        |M |1       |This IE represents the callback  |
|kUri           |           |  |        |URI on which the N2 information  |
|               |           |  |        |shall be notified.               |
|lmfId          |NfInstanceI|C |0..1    |This IE shall be present if the  |
|               |d          |  |        |subscription is for "NRPPa" N2   |
|               |           |  |        |information class and/or "LPP" N1|
|               |           |  |        |information class. When present, |
|               |           |  |        |this IE shall carry the value to |
|               |           |  |        |be used for NGAP "Routing ID" IE,|
|               |           |  |        |which identifies the LMF handling|
|               |           |  |        |the NRPPa and/or LPP data.       |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.11  Type: NonUeN2InfoSubscriptionCreatedData

  Table 6.1.6.2.11-1: Definition of type NonUeN2InfoSubscriptionCreatedData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.12  Type: UeN1N2InfoSubscriptionCreateData

   Table 6.1.6.2.12-1: Definition of type UeN1N2InfoSubscriptionCreateData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|n2NotifyCallbac|Uri        |C |1       |This IE shall be present if the  |
|kUri           |           |  |        |NF service consumer subscribes   |
|               |           |  |        |for a N2 information             |
|               |           |  |        |notification. This IE represents |
|               |           |  |        |the callback URI on which the N2 |
|               |           |  |        |information shall be notified.   |
|n1MessageClass |N1MessageCl|C |1       |This IE shall be present if the  |
|               |ass        |  |        |NF service consumer subscribes   |
|               |           |  |        |for a N1 message notification.   |
|               |           |  |        |This IE represents the class of  |
|               |           |  |        |N1 message that the NF Service   |
|               |           |  |        |Consumer requires to be notified.|
|n1NotifyCallbac|Uri        |C |1       |This IE shall be present if the  |
|kUri           |           |  |        |NF service consumer subscribes   |
|               |           |  |        |for a N1 message notification.   |
|               |           |  |        |This IE represents the callback  |
|               |           |  |        |URI on which the N1 message shall|
|               |           |  |        |be notified.                     |
|lmfId          |NfInstanceI|C |0..1    |This IE shall be present if the  |
|               |d          |  |        |subscription is for "NRPPa" N2   |
|               |           |  |        |information class and/or "LPP" N1|
|               |           |  |        |information class. When present, |
|               |           |  |        |this IE shall carry the value to |
|               |           |  |        |be used for NGAP "Routing ID" IE,|
|               |           |  |        |which identifies the LMF handling|
|               |           |  |        |the NRPPa and/or LPP data.       |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.13  Type: UeN1N2InfoSubscriptionCreatedData

  Table 6.1.6.2.13-1: Definition of type UeN1N2InfoSubscriptionCreatedData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.14  Type: N2InformationNotification

      Table 6.1.6.2.14-1: Definition of type N2InformationNotification

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|n2InfoContainer|N2InfoConta|M |1       |Contains the N2 information      |
|               |iner       |  |        |related to the corresponding N2  |
|               |           |  |        |information class.               |
|lcsCorrelationI|CorelationI|O |0..1    |If the N2 information notified is|
|d              |D          |  |        |for LCS procedures, the NF       |
|               |           |  |        |Service Producer (e.g. AMF) may  |
|               |           |  |        |include an LCS co-relation       |
|               |           |  |        |identifier.                      |



6.1.6.2.15  Type: N2InfoContainer

           Table 6.1.6.2.15-1: Definition of type N2InfoContainer

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|               |           |  |        |                                 |
|smInfo         |array(N2SmI|C |0..N    |This IE shall be present if      |
|               |nformation)|  |        |session management N2 information|
|               |           |  |        |is to be transferred. When       |
|               |           |  |        |present, it represents a session |
|               |           |  |        |management SMF related N2        |
|               |           |  |        |information data part.           |
|nrppaInfo      |NrppaInform|C |0..1    |This IE shall be present if      |
|               |ation      |  |        |location service related N2      |
|               |           |  |        |information is to be transferred.|
|               |           |  |        |When present, it represents a    |
|               |           |  |        |NRPPa related N2 information data|
|               |           |  |        |part.                            |
|pwsInfo        |PwsInformat|C |0..1    |This IE shall be present if PWS  |
|               |ion        |  |        |related N2 information is to be  |
|               |           |  |        |transferred.                     |
|areaOfValidity |AreaOfValid|O |0..1    |This IE represents the list of   |
|               |ity        |  |        |TAs where the provided N2        |
|               |           |  |        |information is valid. See        |
|               |           |  |        |subclause 5.2.2.2.7 and 4.2.3.3  |
|               |           |  |        |of 3GPP TS 23.502 [3].           |



6.1.6.2.16  Type: N1MessageNotification

        Table 6.1.6.2.16-1: Definition of type N1MessageNotification

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|n1MessageContai|N1MessageCo|M |1       |Contains the N1 message class and|
|ner            |ntainer    |  |        |N1 message content.              |
|lcsCorrelationI|CorelationI|O |0..1    |If the N1 message notified is for|
|d              |D          |  |        |LCS procedures, the NF Service   |
|               |           |  |        |Producer (e.g. AMF) may include  |
|               |           |  |        |an LCS co-relation identifier.   |
|registrationCtx|Registratio|C |0..1    |If the N1 message notified is of |
|tContainer     |nContextCon|  |        |type 5GMM (i.e. during           |
|               |tainer     |  |        |Registration with AMF            |
|               |           |  |        |re-allocation procedure), the NF |
|               |           |  |        |Service Producer (e.g. AMF) shall|
|               |           |  |        |include this IE, if available.   |



6.1.6.2.17  Type: N1MessageContainer

          Table 6.1.6.2.17-1: Definition of type N1MessageContainer

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|n1MessageConten|RefToBinary|M |1       |This IE shall reference the N1   |
|t              |Data       |  |        |message binary data corresponding|
|               |           |  |        |to the n1MessageClass. See       |
|               |           |  |        |3GPP TS 24.501 [11]. See         |
|               |           |  |        |subclause 6.1.6.4.2.             |
|lmfId          |NfInstanceI|C |0..1    |This IE shall be present when the|
|               |d          |  |        |n1MessageClass IE is set to      |
|               |           |  |        |"LPP".                           |
|               |           |  |        |When present, this IE shall carry|
|               |           |  |        |the identifier of the LMF sending|
|               |           |  |        |or receiving the LPP data.       |



6.1.6.2.18  Type: N1N2MessageData

           Table 6.1.6.2.18-1: Definition of type N1N2MessageData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|n2InfoContainer|N2InfoConta|C |0..1    |This IE shall be included if a N2|
|               |iner       |  |        |information needs to be          |
|               |           |  |        |transferred.                     |
|lastMsgIndicati|boolean    |O |0..1    |This flag when present shall     |
|on             |           |  |        |indicate that the message        |
|               |           |  |        |transferred is the last message. |
|               |           |  |        |(See subclause 4.13.3.3 of       |
|               |           |  |        |3GPP TS 23.502 [2].              |
|sessionId      |string     |O |0..1    |This IE when present shall       |
|               |           |  |        |indicate the session Id for which|
|               |           |  |        |the N1 / N2 message is initiated.|
|               |           |  |        |The Session Id shall be set to   |
|               |           |  |        |the following depending on type  |
|               |           |  |        |of N1 / N2 message class:        |
|               |           |  |        |- PDU Session ID if the N1 / N2  |
|               |           |  |        |message class is SM;             |
|               |           |  |        |- LCS Co-relation ID if the N1   |
|               |           |  |        |message class is LPP (see        |
|               |           |  |        |subclause 4.13.5.4 of            |
|               |           |  |        |3GPP TS 23.502 [2]);             |
|anType         |AccessType |O |0..1    |This IE when present shall       |
|               |           |  |        |indicate the access network      |
|               |           |  |        |towards which the N1 / N2 message|
|               |           |  |        |need to be transferred.          |
|ppi            |Ppi        |O |0..1    |This IE when present shall       |
|               |           |  |        |indicate the Paging policy to be |
|               |           |  |        |applied. The paging policies are |
|               |           |  |        |configured at the AMF. This IE   |
|               |           |  |        |shall not be present if the      |
|               |           |  |        |anType IE is “NON_3GPP_ACCESS”.  |
|arp            |Arp        |O |0..1    |This IE when present shall       |
|               |           |  |        |indicate the Allocation and      |
|               |           |  |        |Retention Priority of the PDU    |
|               |           |  |        |session for which the N1/N2      |
|               |           |  |        |message transfer is initiated.   |
|               |           |  |        |This IE shall not be present when|
|               |           |  |        |the N1/N2 message class is not   |
|               |           |  |        |SM.                              |
|5qi            |5qi        |O |0..1    |This IE when present shall       |
|               |           |  |        |indicate the 5QI associated with |
|               |           |  |        |the PDU session for which the N1 |
|               |           |  |        |/ N2 message transfer is         |
|               |           |  |        |initiated. This IE shall not be  |
|               |           |  |        |present when the N1/N2 message   |
|               |           |  |        |class is not SM.                 |
|n1n2FailureTxfN|Uri        |O |0..1    |If included, this IE represents  |
|otifURI        |           |  |        |the callback URI on which the AMF|
|               |           |  |        |shall notify the N1/N2 message   |
|               |           |  |        |transfer failure.                |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.19  Type: N1N2MessageTransferRspData

      Table 6.1.6.2.19-1: Definition of type N1N2MessageTransferRspData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.20  Type: RegistrationContextContainer

     Table 6.1.6.2.20-1: Definition of type RegistrationContextContainer

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|localTimeZone  |TimeZone   |O |0..1    |This IE contains the time zone UE|
|               |           |  |        |is currently located.            |
|anType         |AccessType |M |0..1    |This IE shall contain the current|
|               |           |  |        |access type of the UE.           |
|anN2IPv4Address|Ipv4Addr   |C |0..1    |If the Access Network N2         |
|               |           |  |        |interface is using IPv4 address, |
|               |           |  |        |this IE shall be included.       |
|anN2IPv6Addr   |Ipv6Addr   |C |0..1    |If the Access Network N2         |
|               |           |  |        |interface is using IPv6 address, |
|               |           |  |        |this IE shall be included.       |
|allowedNssai   |AllowedNssa|O |0..1    |This IE contains the allowed     |
|               |i          |  |        |NSSAI of the UE. This IE also    |
|               |           |  |        |contains the mapped home network |
|               |           |  |        |S-NSSAI for each allowed S-NSSAI.|



6.1.6.2.21  Type: AreaOfValidity

            Table 6.1.6.2.21-1: Definition of type AreaOfValidity

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |



6.1.6.2.22  Type: RefToBinaryData

           Table 6.1.6.2.22-1: Definition of type RefToBinaryData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |



6.1.6.2.23  Type: UeContextTransferReqData

       Table 6.1.6.2.23-1: Definition of type UeContextTransferReqData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|reason         |TransferRea|M |1       |Indicate the reason for the      |
|               |son        |  |        |UEContextTransfer service request|
|regRequest     |N1MessageCo|O |0..1    |If present, this IE shall refer  |
|               |ntainer    |  |        |to the registration request      |
|               |           |  |        |message which triggers the UE    |
|               |           |  |        |Context Transfer. The message    |
|               |           |  |        |class shall be "5GMM" and message|
|               |           |  |        |content shall be reference to N1 |
|               |           |  |        |Message Content binary data, See |
|               |           |  |        |subclause 6.1.6.4.2.             |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.24  Type: UeContextTransferRspData

       Table 6.1.6.2.24-1: Definition of type UeContextTransferRspData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|regCompleteNoti|Uri        |M |1       |Indicates the callback URI to    |
|fyUri          |           |  |        |deliver the notification for     |
|               |           |  |        |completion of UE registration on |
|               |           |  |        |new AMF, which indicates UE      |
|               |           |  |        |context transfer is successful.  |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.25  Type: UeContext

              Table 6.1.6.2.25-1: Definition of type UeContext

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supiUnauthInd  |boolean    |C |0..1    |This IE shall be present if SUPI |
|               |           |  |        |is present. When present, it     |
|               |           |  |        |shall indicate whether the SUPI  |
|               |           |  |        |is unauthenticated.              |
|gpsi           |array(Gpsi)|C |0..N    |This IE shall be present if      |
|               |           |  |        |available. When present, this IE |
|               |           |  |        |shall contain the GPSI(s)  of the|
|               |           |  |        |UE.                              |
|pei            |Pei        |C |0..1    |This IE shall be present if      |
|               |           |  |        |available. When present, this IE |
|               |           |  |        |shall contain Mobile Equipment   |
|               |           |  |        |Identity of the UE.              |
|groups         |array(Group|C |0..N    |This IE shall be present if the  |
|               |Id)        |  |        |UE belongs to any subscribed     |
|               |           |  |        |internal group(s). When present, |
|               |           |  |        |this IE shall list the subscribed|
|               |           |  |        |internal group(s) to which the UE|
|               |           |  |        |belongs to.                      |
|drxParameter   |DrxParamete|C |0..1    |This IE shall be present if      |
|               |r          |  |        |available. When present, this IE |
|               |           |  |        |shall contain the DRX parameter  |
|               |           |  |        |of the UE.                       |
|subRfsp        |RfspIndex  |C |0..1    |This IE shall be present if      |
|               |           |  |        |available. When present, it shall|
|               |           |  |        |indicate the subscribed RFSP     |
|               |           |  |        |Index of the UE.                 |
|usedRfsp       |RfspIndex  |C |0..1    |This IE shall be present if      |
|               |           |  |        |available. When present, it shall|
|               |           |  |        |indicate the used RFSP Index of  |
|               |           |  |        |the UE.                          |
|smsSupport     |SmsSupport |M |1       |Indicates whether the UE supports|
|               |           |  |        |SMS delivery over NAS via 3GPP   |
|               |           |  |        |access, or via non-3GPP access,  |
|               |           |  |        |or via both the 3GPP and non-3GPP|
|               |           |  |        |access.                          |
|smsfId         |NfInstanceI|C |0..1    |This IE shall be present if the  |
|               |d          |  |        |SMS service for UE is activated. |
|               |           |  |        |When present, it indicates the   |
|               |           |  |        |identifier of the SMSF network   |
|               |           |  |        |function instance serving the UE.|
|seafData       |SeafData   |C |0..1    |This IE shall be present if      |
|               |           |  |        |available. When present, this IE |
|               |           |  |        |contains the security data       |
|               |           |  |        |derived from data received from  |
|               |           |  |        |AUSF of the UE.                  |
|pcfId          |NfInstanceI|C |0..1    |This IE shall be present if      |
|               |d          |  |        |available. When present, this IE |
|               |           |  |        |indicates the identity PCF for AM|
|               |           |  |        |Policy.                          |
|hpcfId         |NfInstanceI|O |0..1    |This IE indicates the identity of|
|               |d          |  |        |PCF for AM Policy in home PLMN,  |
|               |           |  |        |when the UE is roaming.          |
|eventSubscripti|array(AmfEv|C |0..N    |This IE shall be present if      |
|ons            |entSubscrip|  |        |available. When present, it shall|
|               |tion)      |  |        |indicate the event               |
|               |           |  |        |subscription(s) targeting the UE.|
|mmContexts     |array(MmCon|C |0..2    |This IE shall be present if      |
|               |text)      |  |        |available. When present, this IE |
|               |           |  |        |contains the MM Contexts of the  |
|               |           |  |        |UE.                              |
|sessionContexts|array(PduSe|C |0..N    |This IE shall be present if      |
|               |ssionContex|  |        |available. When present, this IE |
|               |t)         |  |        |contains the PDU Session Contexts|
|               |           |  |        |of the UE.                       |



6.1.6.2.26  Type: N2SmInformation

           Table 6.1.6.2.26-1: Definition of type N2SmInformation

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|n2InfoContent  |N2InfoConte|C |0..1    |This IE shall be present if a SMF|
|               |nt         |  |        |related IE should be transferred.|
|               |           |  |        |When present, the IE contains one|
|               |           |  |        |of NGAP SMF related IEs specified|
|               |           |  |        |in subclause 9.3.4 of            |
|               |           |  |        |3GPP TS 38.413 [12].             |
|nasPdu         |N1MessageCo|C |0..1    |This IE shall be present if NAS  |
|               |ntainer    |  |        |messages should be transfer      |
|               |           |  |        |between UE and SMF for session   |
|               |           |  |        |management function. When        |
|               |           |  |        |present, it represents the NAS   |
|               |           |  |        |PDU to be carried over N2 between|
|               |           |  |        |SMF and AN/UE.                   |
|sNssai         |Snssai     |C |0..1    |This IE shall be present if      |
|               |           |  |        |network slice information to be  |
|               |           |  |        |transferred for session          |
|               |           |  |        |management. When present, the IE |
|               |           |  |        |indicates the network slice the  |
|               |           |  |        |PDU session belongs to.          |
|subjectToHo    |boolean    |C |0..1    |This IE shall be present if      |
|               |           |  |        |n2InfoContent carries a "        |
|               |           |  |        |Handover Required Transfer" IE.  |
|               |           |  |        |When present, it Indicates       |
|               |           |  |        |whether the PDU session shall be |
|               |           |  |        |subject to handover to the target|
|               |           |  |        |node.                            |



6.1.6.2.27  Type: N2InfoContent

            Table 6.1.6.2.27-1: Definition of type N2InfoContent

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|ngapData       |RefToBinary|M |1       |This IE reference the N2         |
|               |Data       |  |        |information binary data          |
|               |           |  |        |corresponding to the N2          |
|               |           |  |        |information class. See subclause |
|               |           |  |        |6.1.6.4.3.                       |



6.1.6.2.28  Type: NrppaInformation

           Table 6.1.6.2.28-1: Definition of type NrppaInformation

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|nrppaPdu       |N2InfoConte|M |1       |This IE represents the encoded   |
|               |nt         |  |        |NGAP NRPPa-PDU IE, which is      |
|               |           |  |        |transparent to AMF.              |



6.1.6.2.29  Type: PwsInformation

            Table 6.1.6.2.29-1: Definition of type PwsInformation

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|serialNumber   |Uint16     |M |1       |identifies a particular message  |
|               |           |  |        |from the source and type         |
|               |           |  |        |indicated by the Message         |
|               |           |  |        |Identifier                       |
|pwsContainer   |N2InfoConte|M |1       |This IE represents the PWS N2    |
|               |nt         |  |        |information data part to be      |
|               |           |  |        |relayed between CBCF and AN.     |
|sendN2Container|boolean    |O |0..1    |This IE shall be present if the  |
|               |           |  |        |AMF is expected to send the      |
|               |           |  |        |n2Information it has received    |
|               |           |  |        |from the RAN nodes to the Service|
|               |           |  |        |Consumer. When present, it       |
|               |           |  |        |represents the value of          |
|               |           |  |        |Send-Broadcast-Completed-Area-Lis|
|               |           |  |        |t IE or the                      |
|               |           |  |        |Send-Broadcast-Cancelled-Area-Lis|
|               |           |  |        |t IE.                            |
|omcId          |OmcIdentifi|O |0..1    |IE shall be present if the AMF is|
|               |er         |  |        |required to write the            |
|               |           |  |        |n2Information it has received    |
|               |           |  |        |from the RAN nodes into trace    |
|               |           |  |        |records on the OMC. When present,|
|               |           |  |        |it indicates the identifier of   |
|               |           |  |        |OMC.                             |



6.1.6.2.30  Type: N1N2MsgTxfrFailureNotification

    Table 6.1.6.2.30-1: Definition of type N1N2MsgTxfrFailureNotification

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|n1n2MsgDataUri |Uri        |M |1       |This IE shall contain the        |
|               |           |  |        |N1N2MessageTransfer request      |
|               |           |  |        |resource URI returned in Location|
|               |           |  |        |header when the message transfer |
|               |           |  |        |was initiated (See subclause     |
|               |           |  |        |6.1.3.6.1.3), This IE shall be   |
|               |           |  |        |used by the NF Service Consumer  |
|               |           |  |        |to co-relate the notification    |
|               |           |  |        |against the UE / session for     |
|               |           |  |        |which the earlier N1/N2 message  |
|               |           |  |        |transfer was initiated.          |



6.1.6.2.31  Type: N1N2MessageTransferError

       Table 6.1.6.2.31-1: Definition of type N1N2MessageTransferError

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|errInfo        |N2N2MsgTxfr|O |0..1    |This IE may be included to       |
|               |ErrDetail  |  |        |provide additional information   |
|               |           |  |        |related to the error.            |



6.1.6.2.32  Type: N1N2MsgTxfrErrDetail

         Table 6.1.6.2.32-1: Definition of type N2N2MsgTxfrErrDetail

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|highestPrioArp |Arp        |O |0..1    |This IE may be included if the   |
|               |           |  |        |"cause" attribute in the         |
|               |           |  |        |ProblemDetails is set to         |
|               |           |  |        |"HIGHER_PRIORITY_REQUEST_ONGOING"|
|               |           |  |        |. When included this IE shall    |
|               |           |  |        |contain the ARP value of the     |
|               |           |  |        |highest priority QoS flow for    |
|               |           |  |        |which currently paging is        |
|               |           |  |        |ongoing.                         |
|               |           |  |        |The NF Service Consumer shall not|
|               |           |  |        |initiate an                      |
|               |           |  |        |Namf_Communication_N1N2MessageTra|
|               |           |  |        |nsfer operation for the same UE  |
|               |           |  |        |with an ARP value having a lower |
|               |           |  |        |priority than this or the same   |
|               |           |  |        |priority as this, until the      |
|               |           |  |        |retryAfter timer expires.        |



6.1.6.2.33  Type: N2InformationTransferRspData

     Table 6.1.6.2.33-1: Definition of type N2InformationTransferRspData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |
|pwsRspData     |PWSResponse|C |0..1    |This IE shall be present if the  |
|               |Data       |  |        |n2InformationClass is  "PWS" in  |
|               |           |  |        |N2InformationTransferReqData.    |



6.1.6.2.34  Type: MmContext

              Table 6.1.6.2.34-1: Definition of type MmContext

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|nasSecurityMode|NasSecurity|C |0..1    |This IE shall be present if      |
|               |Mode       |  |        |available in 3GPP access MM      |
|               |           |  |        |context. When present, this IE   |
|               |           |  |        |shall contain the used NAS       |
|               |           |  |        |security mode of the UE.         |
|nasDownlinkCoun|NasCount   |C |0..1    |This IE shall be present if      |
|t              |           |  |        |available in 3GPP access MM      |
|               |           |  |        |context. When present, this IE   |
|               |           |  |        |shall contain the NAS downlink   |
|               |           |  |        |count of the UE.                 |
|nasUplinkCount |NasCount   |C |0..1    |This IE shall be present if      |
|               |           |  |        |available in 3GPP access MM      |
|               |           |  |        |context. When present, this IE   |
|               |           |  |        |shall contain the NAS uplink     |
|               |           |  |        |count of the UE.                 |
|5gmmCapability |5gmmCapabil|C |0..1    |This IE shall be present if      |
|               |ity        |  |        |available in 3GPP access MM      |
|               |           |  |        |context. When present, this IE   |
|               |           |  |        |shall contain 5G MM capability of|
|               |           |  |        |the UE.                          |
|mobilityRestric|MobilityRes|C |0..1    |This IE shall be present if      |
|tions          |trictions  |  |        |available. When present, this IE |
|               |           |  |        |shall contain the mobility       |
|               |           |  |        |restrictions information of the  |
|               |           |  |        |UE.                              |
|ueSecurityCapab|UeSecurityC|C |0..1    |This IE shall be present if      |
|ility          |apability  |  |        |available in 3GPP access MM      |
|               |           |  |        |context. When present, this IE   |
|               |           |  |        |shall contain the UE security    |
|               |           |  |        |capability                       |
|s1UeNetworkCapa|S1UeNetwork|C |0..1    |This IE shall be present if      |
|bility         |Capability |  |        |available in 3GPP access MM      |
|               |           |  |        |context. When present, this IE   |
|               |           |  |        |shall contain the S1 UE network  |
|               |           |  |        |capabilities.                    |
|allowedNssai   |array(Snssa|C |0..N    |This IE shall be present if      |
|               |i)         |  |        |available. When present, this IE |
|               |           |  |        |shall contain the allowed NSSAI  |
|               |           |  |        |for the access type.             |
|nssaiMapping   |array(Nssai|C |0..N    |This IE shall be present if      |
|               |Mapping)   |  |        |available. When present, this IE |
|               |           |  |        |shall contain the mapping of the |
|               |           |  |        |allowed NSSAI for the UE.        |
|nsInstances    |array(NsiId|C |0..N    |This IE shall be present if      |
|               |)          |  |        |available. When present, it shall|
|               |           |  |        |indicate the Network Slice       |
|               |           |  |        |Instances selected for the UE.   |



6.1.6.2.35  Type: SeafData

               Table 6.1.6.2.35-1: Definition of type SeafData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|nh             |string     |M |1       |Indicates the Next Hop value used|
|               |           |  |        |for the key derivation. The value|
|               |           |  |        |is encoded as a string of        |
|               |           |  |        |hexadecimal characters.          |
|               |           |  |        |Pattern: '^[A-Fa-f0-9]$'         |
|ncc            |Uinteger   |M |1       |Indicates the NH Chaining        |
|               |           |  |        |Counter. Minimum is 0 and Maximum|
|               |           |  |        |is 7.                            |
|keyAmf         |KeyAmf     |M |1       |Indicates the Kamf or K’amf      |
|keyAmfChangeInd|boolean    |C |0..1    |This IE shall be included, with a|
|               |           |  |        |value "true", if the source AMF  |
|               |           |  |        |has activated a new 5G NAS       |
|               |           |  |        |security context with a new KAMF,|
|               |           |  |        |different from the 5G NAS        |
|               |           |  |        |security context on which the    |
|               |           |  |        |currently active 5G AS security  |
|               |           |  |        |context is based, but has not yet|
|               |           |  |        |successfully performed a UE      |
|               |           |  |        |Context Modification procedure.  |
|Input (FFS)    |Input (FFS)|C |0..1    |Indicates the <Input> when keyAmf|
|               |           |  |        |is K’amf                         |


  Editor's Note: The <Input> parameter should be aligned with 33.501[x]
         which is FFS.


6.1.6.2.36  Type: NasSecurityMode

           Table 6.1.6.2.36-1: Definition of type NasSecurityMode

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|cipheringAlgori|CipheringAl|M |1       |Indicates the ciphering algorithm|
|thm            |gorithm    |  |        |                                 |



6.1.6.2.37  Type: PduSessionContext

          Table 6.1.6.2.37-1: Definition of type PduSessionContext

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|smContextRef   |Uri        |M |1       |Indicates the SM context         |
|               |           |  |        |reference.                       |
|sNssai         |Snssai     |M |1       |Indicates the associated S-NSSAI |
|               |           |  |        |for the PDU Session.             |
|dnn            |Dnn        |M |1       |Indicates the Data Network Name. |
|accessType     |AccessType |M |1       |Indicates the access type of the |
|               |           |  |        |PDU session.                     |
|allocatedEbiLis|array(EpsAr|M |1..N    |This IE shall contain the EBIs   |
|t              |pMapping)  |  |        |currently allocated to the PDU   |
|               |           |  |        |session.                         |
|hsmfId         |NfInstanceI|C |0..1    |This IE shall be present for     |
|               |d          |  |        |non-roaming and home-routed PDU  |
|               |           |  |        |sessions. When present, it shall |
|               |           |  |        |indicate the associated home SMF |
|               |           |  |        |for the PDU Session.             |
|vsmfId         |NfInstanceI|C |0..1    |This IE shall be present if      |
|               |d          |  |        |roaming PDU sessions. When       |
|               |           |  |        |present, it shall indicate the   |
|               |           |  |        |associated visit SMF for the PDU |
|               |           |  |        |Session.                         |
|nsInstance     |NsiId      |C |1       |This IE shall be present if      |
|               |           |  |        |available. When present, this IE |
|               |           |  |        |shall Indicate Network Slice     |
|               |           |  |        |Instance for the PDU Session     |



6.1.6.2.38  Type: NssaiMapping

             Table 6.1.6.2.38-1: Definition of type NssaiMapping

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|hSnssai        |Snssai     |M |1       |Indicates the S-NSSAI in home    |
|               |           |  |        |PLMN                             |



6.1.6.2.39  Type: UERegCompleteNotifData

        Table 6.1.6.2.39-1: Definition of type UERegCompleteNotifData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |



6.1.6.2.40  Type: AssignEbiError

            Table 6.1.6.2.40-1: Definition of type AssignEbiError

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|failureDetails |AssignEbiFa|M |1       |Describes the  details of the    |
|               |iled       |  |        |failure including the list of    |
|               |           |  |        |ARPs for which the EBI assignment|
|               |           |  |        |failed.                          |



6.1.6.2.41  Type: UeContextCreateData

         Table 6.1.6.2.41-1: Definition of type UeContextCreateData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|targetId       |NgRanTarget|M |1       |Represents the identification of |
|               |Id         |  |        |target RAN                       |
|sourceToTargetD|N2InfoConta|M |1       |This IE shall be included to     |
|ata            |iner       |  |        |contain the "Source to Target    |
|               |           |  |        |Transparent Container" if the    |
|               |           |  |        |message is used for N2 based     |
|               |           |  |        |handover procedure               |
|pduSessions    |N2SmInforma|M |1..N    |This IE shall represent the      |
|               |tion       |  |        |information of PDN session(s) for|
|               |           |  |        |handover                         |
|ngapCause      |NgApCause  |C |0..1    |This IE shall be present, if     |
|               |           |  |        |available. When present, it shall|
|               |           |  |        |represent the NGAP Cause received|
|               |           |  |        |from RAN.                        |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.42  Type: UeContextCreatedData

         Table 6.1.6.2.42-1: Definition of type UeContextCreatedData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|targetToSourceD|N2InfoConta|M |1       |This IE shall contain the "Target|
|ata            |iner       |  |        |to Source Transparent Container".|
|pduSessions    |array(N2SmI|M |1..N    |This IE shall indicate the       |
|               |nformation)|  |        |information of PDN Session(s) for|
|               |           |  |        |handover.                        |
|ngapCause      |NgApCause  |C |0..1    |This IE shall be present, if     |
|               |           |  |        |available. When present, it shall|
|               |           |  |        |represent the NGAP cause received|
|               |           |  |        |from RAN.                        |
|failedSessions |array(PduSe|C |0..N    |This IE shall be included to     |
|               |ssionId)   |  |        |contain the PDN Session Id list  |
|               |           |  |        |of PDU Sessions failed to be     |
|               |           |  |        |setup, if any.                   |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.1.8 is    |
|               |           |  |        |supported.                       |



6.1.6.2.43  Type: UeContextCreateError

         Table 6.1.6.2.43-1: Definition of type UeContextCreateError

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|ngapCause      |NgApCause  |C |0..1    |This IE shall be present, if     |
|               |           |  |        |available. When present, it shall|
|               |           |  |        |represent the NGAP Cause received|
|               |           |  |        |from RAN.                        |



6.1.6.2.44  Type: NgRanTargetId

            Table 6.1.6.2.44-1: Definition of type NgRanTargetId

|Attribute name |Data type   |P |Cardinal|Description                      |
|               |            |  |ity     |                                 |


  Editor's Note: Regular expression pattern should be provided for
         "ranNodeId".


6.1.6.2.45  Type: N2InformationTransferError

      Table 6.1.6.2.45-1: Definition of type N2InformationTransferError

|Attribute    |Data type    |P |Cardinal|Description                      |
|name         |             |  |ity     |                                 |
|pwsErrorInfo |PWSErrorData |C |0..1    |This IE shall be present if the  |
|             |             |  |        |n2InformationClass is  "PWS" in  |
|             |             |  |        |N2InformationTransferReqData.    |



6.1.6.2.46  Type: PWSResponseData

           Table 6.1.6.2.46-1: Definition of type PWSResponseData

|Attribute    |Data type    |P |Cardinal|Description                      |
|name         |             |  |ity     |                                 |
|serialNumber |Uint16       |M |1       |This IE shall contain the Serial |
|             |             |  |        |Number of the associated PWS     |
|             |             |  |        |response message.                |
|messageIdenti|Integer      |M |1       |This IE shall contain the Message|
|fier         |             |  |        |Identifier of the associated PWS |
|             |             |  |        |response message.                |
|unknownTAILis|array(Tai)   |O |0..N    |This IE shall contain the Unknown|
|t            |             |  |        |Tracking Area List which may be  |
|             |             |  |        |present in the associated PWS    |
|             |             |  |        |response message.                |



6.1.6.2.47  Type: PWSErrorData

             Table 6.1.6.2.47-1: Definition of type PWSErrorData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |



6.1.6.2.48  Type: GlobalRanNodeId

           Table 6.1.6.2.48-1: Definition of type GlobalRanNodeId

|Attribute name |Data type   |P |Cardinal|Description                      |
|               |            |  |ity     |                                 |
|n3IwfId        |string      |C |0..1    |This IE shall be included if the |
|               |            |  |        |RAN node belongs to non 3GPP     |
|               |            |  |        |access (i.e a N3IWF).            |
|               |            |  |        |                                 |
|               |            |  |        |If included, this IE shall       |
|               |            |  |        |contain the FQDN of the N3IWF.   |
|ngRanNodeId    |NgRanIdentif|C |0..1    |This IE shall be included if the |
|               |ier         |  |        |RAN node belongs to 3GPP access  |
|               |            |  |        |type (i.e gNB / Ng-eNB).         |
|               |            |  |        |                                 |
|               |            |  |        |If included, this IE shall       |
|               |            |  |        |include the identity of the RAN  |
|               |            |  |        |node.                            |



6.1.6.2.49  Type: NgKsi

                Table 6.1.6.2.49-1: Definition of type NgKsi

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|ksi            |Uinteger   |M |1       |Indicates the key set identifier |
|               |           |  |        |value. Minimum is 0 and Maximum  |
|               |           |  |        |is 6.                            |



6.1.6.2.50  Type: KeyAmf

                Table 6.1.6.2.50-1: Definition of type KeyAmf

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|keyVal         |string     |M |1       |Indicates the key value. The key |
|               |           |  |        |value is encoded as a string of  |
|               |           |  |        |hexadecimal characters.          |
|               |           |  |        |Pattern: '^[A-Fa-f0-9]$'         |



6.1.6.3  Simple data types and enumerations


6.1.6.3.1   Introduction

This subclause defines simple data types and enumerations that can be
referenced from data structures defined in the previous subclauses.


6.1.6.3.2   Simple data types

The simple data types defined in table 6.1.6.3.2-1 shall be supported.

                    Table 6.1.6.3.2-1: Simple data types

|Type Name       |Type        |Description                            |
|                |Definition  |                                       |
|EpsBearerId     |Uinteger    |Unsigned integer identifying an EPS    |
|                |            |bearer, within the range 0 to 15, as   |
|                |            |specified in 3GPP TS 24.007 [15].      |
|NgApCause       | Uinteger   |This represents the NG AP cause code   |
|                |            |values as specified in                 |
|                |            |3GPP TS 38.413 [12].                   |
|NgRanIdentifier |string      |This represents the identifier of the  |
|                |            |NG RAN node.                           |
|                |            |                                       |
|                |            |The string shall be formatted with     |
|                |            |following pattern:                     |
|                |            |'gNB-[A-Fa-f0-9]{6,8}|                 |
|                |            |Macro-[A-Fa-f0-9]{5}|                  |
|                |            |LMacro-[A-Fa-f0-9]{6}|                 |
|                |            |SMacro-[A-Fa-f0-9]{5}'                 |
|                |            |                                       |
|                |            |The value of the RAN Node ID shall be  |
|                |            |encoded in hexadecimal representation. |
|                |            |Each character in the string shall take|
|                |            |a value of "0" to "9" or "A" to "F" and|
|                |            |shall represent 4 bits. The most       |
|                |            |significant character representing the |
|                |            |4 most significant bits of the RAN Node|
|                |            |ID shall appear first in the string,   |
|                |            |and the character representing the 4   |
|                |            |least significant bit of the RAN Node  |
|                |            |ID shall appear last in the string.    |
|                |            |                                       |
|                |            |Examples:                              |
|                |            |"gNB-382A3F47" indicates a gNB ID with |
|                |            |value 0x382A3F47                       |
|                |            |"sMacro-F4B89" indicates a Short Macro |
|                |            |Ng-eNB ID with value 0xF4B89           |
|Ppi             |Uinteger    |This represents the Paging Policy      |
|                |            |Indication. The value is within the    |
|                |            |range 0 – 63.                          |
|NasCount        |Uinteger    |Unsigned integer identifying the NAS   |
|                |            |COUNT as specified in 3GPP TS 33.501[x]|
|5gmmCapability  |Bytes       |String with format "byte" as defined in|
|                |            |OpenAPI Specification [23], i.e.       |
|                |            |base64-encoded characters, encoding the|
|                |            |"5GMM capability" IE as specified in   |
|                |            |subclause 9.8.3.1 of                   |
|                |            |3GPP TS 24.501 [11].                   |
|UeSecurityCapabi|Bytes       |String with format "byte" as defined in|
|lity            |            |OpenAPI Specification [23], i.e.       |
|                |            |base64-encoded characters, encoding the|
|                |            |" UE security capability" IE as        |
|                |            |specified in subclause 9.8.3.55 of     |
|                |            |3GPP TS 24.501 [11].                   |
|S1UeNetworkCapab|Bytes       |String with format "byte" as defined in|
|ility           |            |OpenAPI Specification [23], i.e.       |
|                |            |base64-encoded characters, encoding the|
|                |            |" S1 UE network capability" IE as      |
|                |            |specified in subclause 9.8.3.44 of     |
|                |            |3GPP TS 24.501 [11].                   |
|DrxParameter    |Bytes       |String with format "byte" as defined in|
|                |            |OpenAPI Specification [23], i.e.       |
|                |            |base64-encoded characters, encoding the|
|                |            |"DRX Parameters" IE as specified in    |
|                |            |subclause 10.5.5.6 of                  |
|                |            |3GPP TS 24.008 [22]                    |
|OmcIdentifier   |String      |The OMC Identifier indicates the       |
|                |minLength: 1|identity of an Operation and           |
|                |maxLength:  |Maintenance Centre to which Trace      |
|                |20          |Records shall be sent.                 |



6.1.6.3.3   Enumeration: StatusChange

                 Table 6.1.6.3.3-1: Enumeration StatusChange

|Enumeration value         |Description                                |
|"AMF_UNAVAILABLE"         |The AMF is unavailable to serve the UEs    |
|                          |identified by the GUAMI(s).                |
|"AMF_AVAILABLE"           |The AMF is available to serve the UEs      |
|                          |identified by the GUAMI(s).                |



6.1.6.3.4   Enumeration: N2InformationClass

              Table 6.1.6.3.4-1: Enumeration N2InformationClass

|Enumeration value         |Description                                |
|"SM"                      |N2 SM information.                         |
|"NRPPa"                   |N2 NRPPa information.                      |
|"PWS"                     |N2 PWS information of PWS type.            |
|"PWS-BCAL"                |N2 Broadcast Completed Area List or the    |
|                          |Broadcast Cancelled Area List.             |
|"PWS-RF"                  |N2 Restart Indication or Failure Indication|





6.1.6.3.5   Enumeration: N1MessageClass

                Table 6.1.6.3.5-1: Enumeration N1MessageClass

|Enumeration value         |Description                                |
|"5GMM"                    |The whole NAS message as received (for e.g.|
|                          |used in forwarding the Registration message|
|                          |to target AMF during Registration procedure|
|                          |with AMF redirection).                     |
|"SM"                      |The N1 message of SM type                  |
|"LPP"                     |The N1 message of LPP type.                |
|"SMS"                     |The N1 message of SMS type.                |



6.1.6.3.6   Enumeration: N1N2MessageTransferCause

           Table 6.1.6.3.6-1: Enumeration N1N2MessageTransferCause

|Enumeration value                |Description                          |
|"ATTEMPTING_TO_REACH_UE"         |This cause code represents the case  |
|                                 |where the AMF has initiated paging to|
|                                 |reach the UE in order to deliver the |
|                                 |N1 message.                          |
|"N1_N2_TRANSFER_INITIATED"       |This cause code represents the case  |
|                                 |where the AMF has initiated the N1/N2|
|                                 |message transfer towards the UE      |
|                                 |and/or the AN.                       |
|"WAITING_FOR_ASYNCHRONOUS_TRANSFE|This cause code represents the case  |
|R"                               |where the AMF has stored the N1/N2   |
|                                 |message due to Asynchronous Transfer.|



6.1.6.3.7   Enumeration: UeContextTransferStatus

           Table 6.1.6.3.7-1: Enumeration UeContextTransferStatus

|Enumeration value         |Description                                |
|"TRANSFERRED"             |Indicates a UE Context Transfer procedure  |
|                          |is completed successful for the individual |
|                          |ueContext resource                         |
|"NOT_TRANSFERRED"         |Indicates a UE Context Transfer procedure  |
|                          |either did not complete successfully or the|
|                          |Registration request from the UE is        |
|                          |redirected to another NF Service Consumer  |
|                          |(e.g. AMF).                                |



6.1.6.3.8   Enumeration: N2InformationTransferResult

         Table 6.1.6.3.8-1: Enumeration N2InformationTransferResult

|Enumeration value         |Description                                |
|"N2_INFO_TRANSFER_INITIATE|This cause code represents the case where  |
|D"                        |the AMF has initiated the N2 information   |
|                          |transfer towards the AN.                   |



6.1.6.3.9   Enumeration: CipheringAlgorithm

              Table 6.1.6.3.9-1: Enumeration CipheringAlgorithm

|Enumeration value         |Description                                |
|"NEA0"                    |Null ciphering algorithm                   |
|"NEA1"                    |128-bit SNOW 3G based algorithm            |
|"NEA2"                    |128-bit AES based algorithm                |
|"NEA3"                    |128-bit ZUC based algorithm                |



6.1.6.3.10  Enumeration: IntegrityAlgorithm

             Table 6.1.6.3.10-1: Enumeration IntegrityAlgorithm

|Enumeration value         |Description                                |
|"NIA0"                    |Null Integrity Protection algorithm        |
|"NIA1"                    |128-bit SNOW 3G based algorithm            |
|"NIA2"                    |128-bit AES based algorithm                |
|"NIA3"                    |128-bit ZUC based algorithm                |



6.1.6.3.11  Enumeration: SmsSupport

                 Table 6.1.6.3.11-1: Enumeration SmsSupport

|Enumeration value         |Description                                |
|"3GPP"                    |Support SMS delivery over NAS in 3GPP      |
|                          |access                                     |
|"NON_3GPP"                |Support SMS delivery via non-3GPP access   |
|"BOTH"                    |Support SMS delivery over NAS or via       |
|                          |non-3GPP access                            |
|"NONE"                    |Don’t support SMS delivery                 |



6.1.6.3.12  ScType

                   Table 6.1.6.3.y1-1: Enumeration ScType

|Enumeration value         |Description                                |
|"NATIVE"                  |Native security context (for KSIAMF)       |
|"MAPPED"                  |Mapped security context (for KSIASME)      |



6.1.6.3.13  KeyAmfType

                 Table 6.1.6.3.y2-1: Enumeration KeyAmfType

|Enumeration value         |Description                                |
|"KAMF"                    |The Kamf value is sent.                    |
|"KPRIMEAMF"               |The K’amf. value is sent.                  |



6.1.6.3.14  Enumeration: TransferReason

                Table 6.1.6.3.x-1: Enumeration TransferReason

|Enumeration value         |Description                                |
|"INIT_REG"                |It indicates the AMF requests UE context   |
|                          |for initial registration.                  |
|"MOBI_REG"                |It indicates the AMF requests UE context   |
|                          |for mobility registration.                 |
|"MOBI_REG_UE_VALIDATED"   |It indicates the AMF requests UE context   |
|                          |for mobility registration of a validated   |
|                          |UE.                                        |



6.1.6.4  Binary data


6.1.6.4.1   Introduction

This subclause defines the binary data that shall be supported in a binary
body part in an HTTP multipart message (see subclauses 6.1.2.2.2 and
6.1.2.4).


6.1.6.4.2   N1 Message Content

N1 Message shall encode a 5GS NAS message of a specified type (e.g. SM,
LPP) as specified in 3GPP TS 24.501 [11], using the vnd.3gpp.5gnas content-
type.

N1 Message may encode e.g. the following 5GS NAS messages:

  -  For message class SM

    -  PDU Session Modification Command (see subclause 8.3.8 of
       3GPP TS 24.501 [11]) during network initiated PDU session
       modification procedure (see subclause 4.3.3 of 3GPP TS 23.502 [3]);

    -  PDU Session Release Command (see subclause 8.3.13 of
       3GPP TS 24.501 [11]) during network initiated PDU session release
       procedure (see subclause 4.3.4 of 3GPP TS 23.502 [3]).

  -  For message class LPP

    -  UE Positioning Request messages as specified in 3GPP TS 36.355 [13]
       during UE assisted and UE based positioning procedure (see subclause
       4.13.5.4 of 3GPP TS 23.502 [3]).

  -  For message class 5GMM

    -  REGISTRATION REQUEST message as specified in see subclause 8.2.5 of
       3GPP TS 24.501 [11], during registration procedures (see subclause
       4.2.2.2 of 3GPP TS 23.502 [3]).


6.1.6.4.3   N2 Information Content


6.1.6.4.3.1 Introduction

N2 Information shall encode NG Application Protocol (NGAP) IEs, as
specified in subclause 9.4 of 3GPP TS 38.413 [12] (ASN.1 encoded), using
the vnd.3gpp.ngap content-type.


6.1.6.4.3.2 NGAP IEs

For N2 information class SM, N2 Information may encode following NGAP SMF
related IE specified in 3GPP TS 38.413 [12], as summarized in Table
6.1.6.4.3-1.

           Table 6.1.6.4.3-1: N2 Information content for class SM

|NGAP IE             |Reference     |Related NGAP message                  |
|                    |(3GPP TS 38.41|                                      |
|                    |3 [12])       |                                      |
|PDU Session Resource|9.3.4.1       |PDU SESSION RESOURCE SETUP REQUEST    |
|Setup Request       |              |                                      |
|Transfer            |              |                                      |
|PDU Session Resource|9.3.4.3       |PDU SESSION RESOURCE RELEASE COMMAND  |
|Release Command     |              |                                      |
|Transfer            |              |                                      |
|PDU Session Resource|9.3.4.5       |PDU SESSION RESOURCE MODIFY REQUEST   |
|Modify Request      |              |                                      |
|Transfer            |              |                                      |
|PDU Session Resource|9.3.4.9       |PDU SESSION RESOURCE MODIFY CONFIRM   |
|Modify Confirm      |              |                                      |
|Transfer            |              |                                      |
|Path Switch Request |9.3.4.11      |PATH SWITCH REQUEST ACKNOWLEDGE       |
|Acknowledge Transfer|              |                                      |
|Handover Command    |9.3.4.12      |HANDOVER COMMAND                      |
|Transfer            |              |                                      |
|Handover Request    |9.3.4.1       |HANDOVER REQUEST                      |
|Transfer            |              |                                      |


For N2 information class RAN, N2 Information may encode one of the
following NGAP Transparent Container IEs specified in 3GPP TS 38.413 [12],
as summarized in Table 6.1.6.4.3-2.

           Table 6.1.6.4.3-2: N2 Information content for class RAN

|NGAP IE             |Reference     |Related NGAP message                  |
|                    |(3GPP TS 38.41|                                      |
|                    |3 [12])       |                                      |
|Source to Target    |9.3.1.20      |HANDOVER REQUIRED, HANDOVER REQUEST   |
|Transparent         |              |                                      |
|Container           |              |                                      |
|Target to Source    |9.3.1.21      |HANDOVER COMMAND, HANDOVER REQUEST    |
|Transparent         |              |ACKNOWLEDGE                           |
|Container           |              |                                      |


For N2 information class NRPPa, N2 Information may encode the following
NGAP NRPPA Transport related IE specified in 3GPP TS 38.413 [12], as
summarized in Table 6.1.6.4.3-3

          Table 6.1.6.4.3-3: N2 Information content for class NRPPa

|NGAP IE             |Reference     |Related NGAP message                  |
|                    |(3GPP TS 38.41|                                      |
|                    |3 [12])       |                                      |
|NRPPa-PDU           |9.3.3.14      |DOWNLINK UE ASSOCIATED NRPPA TRANSPORT|
|                    |              |UPLINK UE ASSOCIATED NRPPA TRANSPORT  |
|                    |              |DOWNLINK NON UE ASSOCIATED NRPPA      |
|                    |              |TRANSPORT                             |
|                    |              |UPLINK NON UE ASSOCIATED NRPPA        |
|                    |              |TRANSPORT                             |



6.1.6.4.3.3 NGAP Messages

For N2 information class PWS, N2 Information shall encode NGAP Messages
specified in 3GPP TS 38.413 [12].

           Table 6.1.6.4.3.3-1: N2 PWS Request Information content

|NGAP message                         |Reference       |
|                                     |(3GPP TS 38.413 |
|                                     |[12])           |
|WRITE-REPLACE WARNING REQUEST        |9.2.8.1         |
|PWS CANCEL REQUEST                   |9.2.8.3         |


N2 Information received by the AMF for PWS may be processed by the AMF
before re-encoding and transferring to the Service Consumer:

  - If a subscription exists for N2InformationClass "PWS-BCAL" and the
    received N2 Message Type is a WRITE-REPLACE-WARNING-RESPONSE, then the
    AMF may aggregate the Broadcast Completed Area Lists it has received
    from the NG-RAN nodes for a message identified by its Serial Number and
    Message Identifier (see table 6.1.6.4.3-1).

  - If a subscription exists for N2InformationClass "PWS-BCAL" and the
    received N2 Message Type is a  PWS-CANCEL-RESPONSE, then the AMF may
    aggregate the Broadcast Cancelled Area Lists it has received from the
    NG-RAN nodes for a message identified by its Serial Number and Message
    Identifier (see table 6.1.6.4.3-1). If an NG-RAN node has responded
    without a Broadcast Cancelled Area List, then the AMF shall populate
    the Broadcast Empty Area List with the ngRanId of that NG-RAN node.

          Table 6.1.6.4.3.3-2: N2 PWS Response Information content

|NGAP message                         |Reference       |
|                                     |(3GPP TS 38.413 |
|                                     |[12])           |
|WRITE-REPLACE WARNING RESPONSE       |9.2.8.2         |
|PWS CANCEL RESPONSE                  |9.2.8.4         |



If a subscription exists for N2InformationClass "PWS-BCAL" and the received
N2 Message Type is a WRITE-REPLACE-WARNING-RESPONSE, then the AMF may
transfer the ASN.1 (re-)encoded Message Type, Message Identifier, Serial
Number and the (aggregated) Broadcast Completed Area List in the N2 Info
Container in the N2InfoNotify.

If a subscription exists for N2InformationClass "PWS-BCAL" and the received
N2 Message Type is a PWS-CANCEL-RESPONSE, then the AMF may transfer the
ASN.1 (re-)encoded the Message Type, Message Identifier, Serial Number, the
(aggregated) Broadcast Cancelled Area List and Broadcast Empty Area List in
the N2 Info Container in the N2InfoNotify.

For the ASN.1 definition for encoding the WRITE-REPLACE-WARNING-RESPONSE
and the PWS-CANCEL-RESPONSE, see subclause 9.4 of 3GPP TS 38.413 [12].

If a subscription exists for N2InformationClass "PWS-RF" and the received
N2 Message Type is a PWS-RESTART-INDICATION, then the AMF may transfer the
ASN.1 encoded string from the PWS-RESTART-INDICATION (see table 6.1.6.4.3-
2) in the N2 Info Container in the N2InfoNotify.

If a subscription exists for N2InformationClass "PWS-RF" and the received
N2 Message Type is a PWS-FAILURE-INDICATION (see table 6.1.6.4.3-2), then
the AMF may transfer the ASN1 encoded string from the PWS-FAILURE-
INDICATION in the N2 Info Container in the N2InfoNotify.

         Table 6.1.6.4.3.3-3: N2 PWS Indication Information content

|NGAP message                         |Reference       |
|                                     |(3GPP TS 38.413 |
|                                     |[x])            |
|PWS RESTART INDICATION               |9.2.8.5         |
|PWS FAILURE INDICATION               |9.2.8.6         |


The Message Type shall be present and encoded as the first N2 PWS
Indication IE in any NonUeN2InfoNotify for PWS messages to enable the
receiver to decode the N2 PWS IEs


6.1.7  Error Handling


6.1.7.1  General

HTTP error handling shall be supported as specified in subclause 5.2.4 of
3GPP TS 29.500 [4].




6.1.7.2  Protocol Errors

Protocol Error Handling shall be supported as specified in subclause
5.2.7.2 of 3GPP TS 29.500 [4].



6.1.7.3  Application Errors

The common application errors defined in the Table 5.2.7.2-1 in
3GPP TS 29.500 [4] may also be used for the Namf_Communication service. The
following application errors listed in Table 6.1.7.3-1 are specific for the
Namf_Communication service.

                     Table 6.1.7.3-1: Application errors

|Application Error          |HTTP      |Description                       |
|                           |status    |                                  |
|                           |code      |                                  |
|NF_CONSUMER_REDIRECT_ONE_TX|307       |The request has been asked to be  |
|N                          |Temporary |redirected to a specified target. |
|                           |Redirect  |                                  |
|HANDOVER_FAILURE           |403       |Creation of UE context in the     |
|                           |Forbidden |target AMF failed during Handover |
|                           |          |procedure causing a failure of    |
|                           |          |handover.                         |
|INTEGRITY_CHECK_FAIL       |403       |Integrity check of the complete   |
|                           |Forbidden |registration message included in  |
|                           |          |the UE context transfer request   |
|                           |          |failed.                           |
|EBI_EXHAUSTED              |403       |Allocation of EPS Bearer ID failed|
|                           |Forbidden |due to exhaustion of EBI as the   |
|                           |          |maximum number of EBIs has already|
|                           |          |been allocated to the UE.         |
|HIGHER_PRIORITY_REQUEST_ONG|409       |Paging triggered N1/N2 transfer   |
|OING                       |Conflict  |cannot be initiated since already |
|                           |          |there is a paging due to a higher |
|                           |          |priority session ongoing.         |
|UE_NOT_REACHABLE           |504       |Paging failed or the UE is not    |
|                           |Gateway   |reachable for paging.             |
|                           |Timeout   |                                  |
|UE_IN_NON_ALLOWED_AREA     |504       |UE is currently in a non-allowed  |
|                           |Gateway   |area and hence the N1/N2 message  |
|                           |Timeout   |transfer cannot be completed and  |
|                           |          |the N1/N2 message transfer is not |
|                           |          |related to priority associated    |
|                           |          |with a regulatory prioritized     |
|                           |          |service.                          |
|UNSPECIFIED                |403       |The request is rejected due to    |
|                           |Forbidden |unspecified reasons.              |
|CONTEXT_NOT_FOUND          |404 Not   |It is used during the mobility of |
|                           |Found     |an existing PDN connection when no|
|                           |          |corresponding context exist in the|
|                           |          |SMF.                              |
|SUPI_OR_PEI_UNKNOWN        |403       |The SUPI or PEI included in the   |
|                           |Forbidden |message is unknown.               |



6.1.8  Feature Negotiation

The feature negotiation mechanism specified in subclause 6.6 of
3GPP TS 29.500 [4] shall be used to negotiate the optional features
applicable between the AMF and the NF Service Consumer, for the
Namf_Communication service, if any.

The NF Service Consumer shall indicate the optional features it supports
for the Namf_Communication service, if any, by including the
supportedFeatures attribute in payload of the HTTP Request Message for
following service operations:

  -  N1N2MessgeTransfer, as specified in subclause 5.2.2.3.1;

  -  N1N2MessageSubscribe, as specified in subclause 5.2.2.3.3;

  -  NonUeN2InfoSubscribe, as specified in subclause 5.2.2.4.2;

  -  UeContextTransfer, as specified in subclause 5.2.2.2.1;

  -  CreateUEContext, as specified in subclause 5.2.2.2.3

The AMF shall determine the supported features for the service operations
as specified in subclause 6.6 of 3GPP TS 29.500 [4] and shall indicate the
supported features by including the supportedFeatures attribute in payload
of the HTTP response for the service operation.

The syntax of the supportedFeatures attribute is defined in subclause 5.2.2
of 3GPP TS 29.571 [13].

The following features are defined for the Namf_Communication service.

       Table 6.1.8-1: Features of supportedFeatures attribute used by
                         Namf_Communication service

|Feature|Feature|M/O |Description                                       |
|Number |       |    |                                                  |
|       |       |    |                                                  |
|Feature number: The order number of the feature within the             |
|supportedFeatures attribute (starting with 1).                         |
|Feature: A short name that can be used to refer to the bit and to the  |
|feature.                                                               |
|M/O: Defines if the implementation of the feature is mandatory ("M") or|
|optional ("O").                                                        |
|Description: A clear textual description of the feature.               |



6.1.9  Security

As indicated in 3GPP TS 33.501 [27], the access to the Namf_Communication
API shall be authorized by means of the OAuth2 protocol (see
IETF RFC 6749 [28]), using the "Client Credentials" authorization grant,
where the NRF (see 3GPP TS 29.510 [29]) plays the role of the authorization
server.

An NF Service Consumer, prior to consuming services offered by the
Namf_Communication API, shall obtain a "token" from the authorization
server, by invoking the Access Token Request service, as described in
3GPP TS 29.510 [29], subclause 5.4.2.2.

  NOTE:  When multiple NRFs are deployed in a network, the NRF used as
         authorization server is the same NRF that the NF Service Consumer
         used for discovering the Namf_Communication service.

The Namf_Communication API does not define any scopes for OAuth2
authorization.


6.2  Namf_EventExposure Service API


6.2.1  API URI

URIs of this API shall have the following root:

{apiRoot}/{apiName}/{apiVersion}/

where the "apiName" shall be set to "namf-evts" and the "apiVersion" shall
be set to "v1" for the current version of this specification.


6.2.2  Usage of HTTP


6.2.2.1  General

HTTP/2, as defined in IETF RFC 7540 [19], shall be used as specified in
clause 5 of 3GPP TS 29.500 [4].

HTTP/2 shall be transported as specified in subclause 5.3 of
3GPP TS 29.500 [4].

HTTP messages and bodies for the Namf_EventExposure service shall comply
with the OpenAPI [23] specification contained in Annex A.


6.2.2.2  HTTP standard headers


6.2.2.2.1   General

The usage of HTTP standard headers shall be supported as specified in
subclause 5.2.2 of 3GPP TS 29.500 [4].


6.2.2.2.2   Content type

JSON, IETF RFC 8259 [8], shall be used as content type of the HTTP bodies
specified in the present specification as specified in subclause 5.4 of
3GPP TS 29.500 [4].


6.2.2.3  HTTP custom headers


6.2.2.3.1   General

In this release of this specification, no custom headers specific to the
Namf_EventExposure service are defined. For 3GPP specific HTTP custom
headers used across all service based interfaces, see clause 5.2.3 of
3GPP TS 29.500 [4].


6.2.3  Resources


6.2.3.1  Overview

                                    [pic]

   Figure 6.2.3.1-1: Resource URI structure of the Namf_EventExposure API

Table 6.2.3.1-1 provides an overview of the resources and applicable HTTP
methods.

               Table 6.2.3.1-1: Resources and methods overview

|Resource |Resource URI                  |HTTP    |Description              |
|name     |                              |method  |                         |
|         |                              |or      |                         |
|         |                              |custom  |                         |
|         |                              |operatio|                         |
|         |                              |n       |                         |
|Subscript|.../subscriptions             |POST    |Mapped to the service    |
|ions     |                              |        |operation Subscribe, when|
|collectio|                              |        |to create a subscription |
|n        |                              |        |                         |
|Individua|…                             |PATCH   |Mapped to the service    |
|l        |/subscriptions/{subscriptionId|        |operation Subscribe, when|
|subscript|}                             |        |to modify                |
|ion      |                              |        |                         |
|         |                              |DELETE  |Mapped to the service    |
|         |                              |        |operation Unsubscribe    |



6.2.3.2  Resource: Subscriptions collection


6.2.3.2.1   Description

This resource represents a collection of subscriptions created by NF
service consumers of Namf_EventExposure service.

This resource is modelled as the Collection resource archetype (see
subclause C.2 of 3GPP TS 29.501 [5]).


6.2.3.2.2   Resource Definition

Resource URI: {apiRoot}/namf-evts/v1/subscriptions

This resource shall support the resource URI variables defined in
table 6.2.3.2.2-1.

         Table 6.2.3.2.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.2.1                                         |



6.2.3.2.3   Resource Standard Methods


6.2.3.2.3.1 POST

This method shall support the URI query parameters specified in table
6.2.3.2.3.1-1.

  Table 6.2.3.2.3.1-1: URI query parameters supported by the POST method on
                                this resource

|Name       |Data type |P |Cardinal|Description                            |
|           |          |  |ity     |                                       |


This method shall support the request data structures specified in table
6.2.3.2.3.1-2 and the response data structures and response codes specified
in table 6.2.3.2.3.1-3.

 Table 6.2.3.2.3.1-2: Data structures supported by the POST Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|AmfCreateEve|M |1        |Describes of an AMF Event Subscription to be     |
|ntSubscripti|  |         |created                                          |
|on          |  |         |                                                 |


 Table 6.2.3.2.3.1-3: Data structures supported by the POST Response Body on
                                this resource

|Data type          |P|Cardina|Respons|Description                         |
|                   | |lity   |e      |                                    |
|                   | |       |codes  |                                    |
|ProblemDetails     |M|1      |403    |Indicates the creation of           |
|                   | |       |Forbidd|subscription has failed due to      |
|                   | |       |en     |application error.                  |
|                   | |       |       |                                    |
|                   | |       |       |The "cause" attribute shall be set  |
|                   | |       |       |to:                                 |
|                   | |       |       |- UE_NOT_SERVED_BY_AMF              |



6.2.3.2.4   Resource Custom Operations

None.


6.2.3.3  Resource:  Individual subscription


6.2.3.3.1   Description

This resource represents an individual of subscription created by NF
service consumers of Namf_EventExposure service.

This resource is modelled as the Document resource archetype (see subclause
C.1 of 3GPP TS 29.501 [5]).


6.2.3.3.2   Resource Definition

Resource URI: {apiRoot}/namf-evts/v1/subscriptions/{subscriptionId}

This resource shall support the resource URI variables defined in
table 6.2.3.3.2-1.

         Table 6.2.3.3.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|apiRoot       |See subclause 6.2.1                                         |
|subscriptionId|String identifies an individual subscription to the AMF     |
|              |event exposure service                                      |



6.2.3.3.3   Resource Standard Methods


6.2.3.3.3.1 PATCH

This method shall support the URI query parameters specified in table
6.2.3.3.3.1-1.

 Table 6.2.3.3.3.1-1: URI query parameters supported by the PATCH method on
                                this resource

|Name      |Data type   |P |Cardinal|Description                            |
|          |            |  |ity     |                                       |


This method shall support the request data structures specified in table
6.2.3.3.3.1-2 and the response data structures and response codes specified
in table 6.2.3.3.3.1-3.

 Table 6.2.3.3.3.1-2: Data structures supported by the PATCH Request Body on
                                this resource

|Data type       |P  |Cardinali|Description                                  |
|                |   |ty       |                                             |
|AmfUpdateEventSu|M  |1..N     |Document describes the modification(s) to a  |
|bscriptionItem  |   |         |AMF Event Subscription                       |


  Table 6.2.3.3.3.1-3: Data structures supported by the PATCH Response Body
                              on this resource

|Data type       |P  |Cardinali|Respons|Description                         |
|                |   |ty       |e      |                                    |
|                |   |         |codes  |                                    |
|ProblemDetails  |M  |1        |403    |Indicates the modification of       |
|                |   |         |Forbidd|subscription has failed due to      |
|                |   |         |en     |application error.                  |
|                |   |         |       |                                    |
|                |   |         |       |The "cause" attribute shall be set  |
|                |   |         |       |to:                                 |
|                |   |         |       |- UE_NOT_SERVED_BY_AMF              |
|ProblemDetails  |M  |1        |404 Not|Indicates the modification of       |
|                |   |         |Found  |subscription has failed due to      |
|                |   |         |       |application error.                  |
|                |   |         |       |                                    |
|                |   |         |       |The "cause" attribute shall be set  |
|                |   |         |       |to:                                 |
|                |   |         |       |- SUBSCRIPTION_NOT_FOUND            |



6.2.3.3.3.2 DELETE

This method shall support the URI query parameters specified in table
6.2.3.3.3.2-1.

 Table 6.2.3.3.3.2-1: URI query parameters supported by the DELETE method on
                                this resource

|Name      |Data type   |P |Cardinal|Description                            |
|          |            |  |ity     |                                       |


This method shall support the request data structures specified in table
6.2.3.3.3.2-2 and the response data structures and response codes specified
in table 6.2.3.3.3.2-3.

  Table 6.2.3.3.3.2-2: Data structures supported by the DELETE Request Body
                              on this resource

|Data type       |P  |Cardinali|Description                                  |
|                |   |ty       |                                             |
|n/a             |   |         |                                             |


 Table 6.2.3.3.3.2-3: Data structures supported by the DELETE Response Body
                              on this resource

|Data type       |P  |Cardinali|Respons|Description                         |
|                |   |ty       |e      |                                    |
|                |   |         |codes  |                                    |
|ProblemDetails  |M  |1        |404 Not|Indicates the modification of       |
|                |   |         |Found  |subscription has failed due to      |
|                |   |         |       |application error.                  |
|                |   |         |       |                                    |
|                |   |         |       |The "cause" attribute shall be set  |
|                |   |         |       |to:                                 |
|                |   |         |       |- SUBSCRIPTION_NOT_FOUND.           |



6.2.3.3.4   Resource Custom Operations

None.


6.2.4  Custom Operations without associated resources

There are no custom operations without associated resources supported on
Namf_EventExposure Service.


6.2.5  Notifications


6.2.5.1  General


6.2.5.2   AMF Event Notification

If a NF service consumer has subscribed to an event(s) supported by
Namf_EventExposure service, when AMF aware of a state change of the event,
AMF shall create a notification including the event state report, and shall
deliver the notification to the call-back URI, following Subscribe/Notify
mechanism defined in 3GPP TS 29.501 [2].


6.2.5.2.1   Notification Definition

Call-back URI: {callbackUri}

Call-back URI is provided by NF Service Consumer during creation of the
subscription. If the notification is to inform the change of subscription
ID and if the "subsChangeNotifyUri" was provided in the
AmfEventSubscription, then this callback URI shall be the
"subsChangeNotifyUri" provided in the AmfEventSubscription. Otherwise, this
callback URI shall be the "eventNotifyUri" provided in the
AmfEventSubscription.


6.2.5.2.3   Notification Standard Methods


6.2.5.2.3.1 POST

This method shall support the request data structures specified in table
6.2.5.2.3.1-1 and the response data structures and response codes specified
in table 6.2.5.2.3.1-2.

   Table 6.2.5.2.3.1-2: Data structures supported by the POST Request Body

|Data type       |P  |Cardinali|Description                                  |
|                |   |ty       |                                             |
|AmfEventNotifica|M  |1        |Represents the notification to be delivered  |
|tion            |   |         |                                             |


  Table 6.2.5.2.3.1-3: Data structures supported by the POST Response Body

|Data type       |P  |Cardinali|Respons|Description                         |
|                |   |ty       |e      |                                    |
|                |   |         |codes  |                                    |



6.2.6  Data Model


6.2.6.2  General

This subclause specifies the application data model supported by the API.

Table 6.2.6.2-1 specifies the data types defined for the Namf_EventExposure
service based interface protocol.

           Table 6.2.6.2-1: Namf_EventExposure specific Data Types

|Data type            |Section    |Description                          |
|                     |defined    |                                     |
|AmfEventSubscription |6.2.6.2.2  |Represents an individual event       |
|                     |           |subscription resource on AMF         |
|AmfEvent             |6.2.6.2.3  |Describes an event to be subscribed  |
|AmfEventNotification |6.2.6.2.4  |Represents a notification generated  |
|                     |           |by AMF to be delivered               |
|AmfEventReport       |6.2.6.2.5  |Represents a report triggered by a   |
|                     |           |subscribed event type, except the    |
|                     |           |report triggered by                  |
|                     |           |UES_IN_AREA_REPORT event type        |
|AmfEventMode         |6.2.6.2.6  |Describes how the reports shall be   |
|                     |           |generated by a subscribed event      |
|AmfEventState        |6.2.6.2.7  |Represents the state of a subscribed |
|                     |           |event                                |
|RmInfo               |6.2.6.2.9  |Represents the registration state of |
|                     |           |a UE for an access type              |
|CmInfo               |6.2.6.2.10 |Represents the connectivity state of |
|                     |           |a UE for an access type              |
|SubscribedData       |6.2.6.2.11 |Represents the subscribed data       |
|                     |           |received from UDM                    |
|CommunicationFailure |6.2.6.2.12 |Describes a communication failure    |
|                     |           |detected by AMF                      |
|AmfCreateEventSubscri|6.2.6.2.13 |Describes of an AMF Event            |
|ption                |           |Subscription to be created           |
|AmfCreatedEventSubscr|6.2.6.2.14 |Represents successful creation of an |
|iption               |           |AMF Event Subscription               |
|AmfUpdateEventSubscri|6.2.6.2.15 |Document describes the               |
|ptionItem            |           |modification(s) to an AMF Event      |
|                     |           |Subscription                         |
|AmfUpdatedEventSubscr|6.2.6.2.16 |Represents a successful update on an |
|iption               |           |AMF Event Subscription               |
|AmfEventArea         |6.2.6.2.17 |Represents an area to be monitored by|
|                     |           |an AMF event.                        |
|AmfEventType         |6.2.6.3.3  |Describes the supported event types  |
|                     |           |of Namf_EventExposure Service        |
|AmfEventTrigger      |6.2.6.3.4  |Describes how AMF should generate the|
|                     |           |report for the event                 |
|LocationFilter       |6.2.6.3.5  |Describes the supported filters of   |
|                     |           |LOCATION_REPORT event type           |
|SubscribedDataFilter |6.2.6.3.6  |Describes the supported filters of   |
|                     |           |SUBSCRIBED_DATA_REPORT event type    |
|UeReachability       |6.2.6.3.7  |Describes the reachability of the UE |
|PresenceState        |6.2.6.3.8  |Describes the presence state of the  |
|                     |           |UE to a specified area of interest   |
|RmState              |6.2.6.3.9  |Describes the registration management|
|                     |           |state of a UE                        |
|CmState              |6.2.6.3.10 |Describes the connectivity management|
|                     |           |state of a UE                        |


Table 6.2.6.2-2 specifies data types re-used by the Namf_EventExposure
service based interface protocol from other specifications, including a
reference to their respective specifications and when needed, a short
description of their use within the Namf_EventExposure service based
interface.

           Table 6.2.6.2-2: Namf_EventExposure re-used Data Types

|Data type      |Reference    |Comments                                 |
|Supi           |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|GroupId        |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|DurationSec    |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Gpsi           |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Uri            |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Pei            |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|UserLocation   |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|TaI            |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|GlobalRanNodeId|6.1.6.2.51   |                                         |
|TimeZone       |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|AccessType     |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|Ecgi           |3GPP TS 29.57|EUTRA Cell Identifier                    |
|               |1 [6]        |                                         |
|Ncgi           |3GPP TS 29.57|NR Cell Identifier                       |
|               |1 [6]        |                                         |
|NfInstanceId   |3GPP TS 29.57|                                         |
|               |1 [6]        |                                         |
|ProblemDetails |3GPP TS 29.57|Problem Details                          |
|               |1 [6]        |                                         |
|SupportedFeatur|3GPP TS 29.57|Supported Features                       |
|es             |1 [6]        |                                         |
|NgApCause      |6.1.6.3.2    |                                         |



6.2.6.2  Structured data types


6.2.6.2.1   Introduction

Structured data types used in Namf_EventExposure service are specified in
this clause.


6.2.6.2.2   Type: AmfEventSubscription

         Table 6.2.6.2.2-1: Definition of type AmfEventSubscription

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|notifyUri      |Uri        |M |1       |Identifies the recipient of      |
|               |           |  |        |notifications sent by AMF for    |
|               |           |  |        |this subscription                |
|notifyCorelatio|string     |M |1       |Identifies the notification      |
|nId            |           |  |        |co-relation ID. The AMF shall    |
|               |           |  |        |include this ID in the           |
|               |           |  |        |notifications.                   |
|nfId           |NfInstanceI|M |1       |Indicates the instance identity  |
|               |d          |  |        |of the network function creating |
|               |           |  |        |the subscription.                |
|subsChangeNotif|Uri        |C |1       |This IE shall be present if the  |
|yUri           |           |  |        |subscription is created by an NF |
|               |           |  |        |service consumer on behalf of    |
|               |           |  |        |another NF (e.g UDM creating     |
|               |           |  |        |event subscription at AMF for    |
|               |           |  |        |event notifications towards NEF).|
|               |           |  |        |When present, this IE Identifies |
|               |           |  |        |the recipient of notifications   |
|               |           |  |        |sent by AMF for change of        |
|               |           |  |        |subscription ID (e.g during      |
|               |           |  |        |mobility procedures involving AMF|
|               |           |  |        |change).                         |
|supi           |Supi       |C |0..1    |Subscription Permanent Identifier|
|               |           |  |        |(NOTE)                           |
|groupId        |GroupId    |C |0..1    |Identifies a group of UEs. (NOTE)|
|gpsi           |Gpsi       |C |0..1    |Generic Public Subscription      |
|               |           |  |        |Identifier (NOTE)                |
|pei            |Pei        |C |0..1    |Permanent Equipment Identifier   |
|               |           |  |        |(NOTE)                           |
|anyUE          |boolean    |C |0..1    |This IE shall be present if the  |
|               |           |  |        |event subscription is applicable |
|               |           |  |        |to any UE.  Default value "FALSE"|
|               |           |  |        |is used, if not present (NOTE)   |
|NOTE:  Either information about a single UE (i.e. SUPI, GPSI, PEI) or     |
|groupId, or anyUE set to "TRUE" shall be included.                        |



6.2.6.2.3   Type: AmfEvent

               Table 6.2.6.2.3-1: Definition of type AmfEvent

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|options        |AmfEventMod|M |1       |Describes how the reports of the |
|               |e          |  |        |event to be generated.           |
|immediateFlag  |boolean    |O |0..1    |Indicates if an immediate event  |
|               |           |  |        |report in the subscription       |
|               |           |  |        |response indicating current value|
|               |           |  |        |/ status of the event is required|
|               |           |  |        |or not. If the flag is not       |
|               |           |  |        |present then immediate reporting |
|               |           |  |        |shall not be done.               |
|area           |array(AmfEv|O |0..N    |Identifiers the area to be       |
|               |entArea)   |  |        |applied to PRESENT_IN_AOI_REPORT |
|               |           |  |        |and UES_IN_AREA_REPORT event     |
|               |           |  |        |types. More than one instance of |
|               |           |  |        |AmfEventArea IE shall be used    |
|               |           |  |        |only when the AmfEventArea is    |
|               |           |  |        |provided during event            |
|               |           |  |        |subscription for Presence        |
|               |           |  |        |Reporting Area subscription.     |
|locationFilters|LocationFil|O |0..N    |Describes the filters to be      |
|               |ter        |  |        |applied for LOCATION_REPORT event|
|               |           |  |        |type.                            |
|subscribedDataF|SubscribedD|O |0..N    |Describes the filters to be      |
|ilters         |ataFilter  |  |        |applied for                      |
|               |           |  |        |SUBSCRIBED_DATA_REPORT event     |
|               |           |  |        |type.                            |



6.2.6.2.4   Type: AmfEventNotification

         Table 6.2.6.2.4-1: Definition of type AmfEventNotification

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|notifCorelation|string     |M |1       |Indicates the notification       |
|Id             |           |  |        |co-relation ID provided by the NF|
|               |           |  |        |service consumer during event    |
|               |           |  |        |subscription. This parameter can |
|               |           |  |        |be useful if the NF service      |
|               |           |  |        |consumer uses a common call-back |
|               |           |  |        |URI for multiple subscriptions.  |
|reports        |array(AmfEv|C |1..N    |This IE shall be present if a    |
|               |entReport) |  |        |event is reported. When present, |
|               |           |  |        |this IE represents the event     |
|               |           |  |        |reports to be delivered.         |



6.2.6.2.5   Type: AmfEventReport

            Table 6.2.6.2.5-1: Definition of type AmfEventReport

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|state          |AmfEventSta|M |1       |Describes the state of the event |
|               |te         |  |        |which triggered the report       |
|anyUe          |boolean    |C |0..1    |This IE shall be included and    |
|               |           |  |        |shall be set to "true", if the   |
|               |           |  |        |event subscription is a bulk     |
|               |           |  |        |subscription for number of UEs   |
|               |           |  |        |and the event reported is for one|
|               |           |  |        |of those UEs.                    |
|supi           |Supi       |C |0..1    |This IE shall be included if the |
|               |           |  |        |event reported is for a          |
|               |           |  |        |particular UE or any UE. This IE |
|               |           |  |        |identifies the UE associated to  |
|               |           |  |        |the report (NOTE).               |
|area           |array(AmfEv|C |0..N    |This IE shall be present when the|
|               |entArea)   |  |        |AMF event type is                |
|               |           |  |        |"PRESENCE_IN_AOI_REPORT". When   |
|               |           |  |        |present, this IE represents the  |
|               |           |  |        |specified Area(s) of Interest the|
|               |           |  |        |UE is currently IN / OUT /       |
|               |           |  |        |UNKNOWN.                         |
|gpsi           |Gpsi       |O |0..1    |This IE may be included if the   |
|               |           |  |        |event reported is for a          |
|               |           |  |        |particular UE or any UE. This IE |
|               |           |  |        |identifies the GPSI of the UE    |
|               |           |  |        |associated to the report (NOTE). |
|pei            |Pei        |O |0..1    |This IE may be included if the   |
|               |           |  |        |event reported is for a          |
|               |           |  |        |particular UE or any UE.  This IE|
|               |           |  |        |identifies the PEI of the UE     |
|               |           |  |        |associated to the report (NOTE). |
|location       |UserLocatio|O |0..1    |Represents the location          |
|               |n          |  |        |information of the UE            |
|timezone       |TimeZone   |O |0..1    |Describes the time zone of the UE|
|accessTypes    |AccessType |O |0..N    |Describes the access type(s) of  |
|               |           |  |        |the UE                           |
|rmInfos        |RmInfo     |O |0..N    |Describes the registration       |
|               |           |  |        |management state of the UE       |
|cmInfos        |CmInfo     |O |0..N    |Describes the connectivity state |
|               |           |  |        |of the UE                        |
|reachability   |UeReachabil|O |0..1    |Describes the reachability of the|
|               |ity        |  |        |UE                               |
|subscribedData |SubscribedD|O |0..1    |Represents the subscribed data of|
|               |ata        |  |        |the UE received from UDM         |
|commFailure    |Communicati|O |0..1    |Describes a communication failure|
|               |onFailure  |  |        |for the UE.                      |
|numberOfUes    |integer    |O |0..1    |Represents the number of UEs in  |
|               |           |  |        |the specified area               |
|NOTE:      If the event report corresponds to an event subscription of a  |
|single UE, then the same UE identifier (i.e. SUPI and/or GPSI and/or PEI) |
|shall be included in the report. If the event report corresponds to an    |
|event subscription for group of UEs or any UE, then the SUPI shall be     |
|included in the event report. SUPI, PEI and GPSI shall not be present in  |
|report for UES_IN_AREA_REPORT event type.                                 |



6.2.6.2.6   Type: AmfEventMode

             Table 6.2.6.2.6-1: Definition of type AmfEventMode

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|maxReports     |integer    |C |0..1    |This IE shall be present if the  |
|               |           |  |        |trigger is set to “CONTINUOUS”.  |
|               |           |  |        |When present, this IE describes  |
|               |           |  |        |the maximum number of reports    |
|               |           |  |        |that can be generated by the     |
|               |           |  |        |subscribed event.                |
|duration       |DurationSec|O |0..1    |Describes the maximum duration   |
|               |           |  |        |after which the subscribed event |
|               |           |  |        |shall stop generating report. If |
|               |           |  |        |not present, the subscribed event|
|               |           |  |        |shall continue generating reports|
|               |           |  |        |until it is unsubscribed.        |



6.2.6.2.7   Type: AmfEventState

             Table 6.2.6.2.7-1: Definition of type AmfEventState

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|remainReports  |integer    |O |0..1    |Represents the number of remain  |
|               |           |  |        |reports to be generated by the   |
|               |           |  |        |subscribed event.                |
|remainDuration |DurationSec|O |0..1    |Represents how long the          |
|               |           |  |        |subscribed event will continue   |
|               |           |  |        |generating reports.              |



6.2.6.2.8   Type: RmInfo

                Table 6.2.6.2.8-1: Definition of type RmInfo

|Attribute name |Data type   |P |Cardinal|Description                      |
|               |            |  |ity     |                                 |
|accessType     |AccessType  |M |1       |Describes the access type of the |
|               |            |  |        |UE that applies to the           |
|               |            |  |        |registration management state    |
|               |            |  |        |reported.                        |



6.2.6.2.9   Type: CmInfo

                Table 6.2.6.2.9-1: Definition of type CmInfo

|Attribute name |Data type   |P |Cardinal|Description                      |
|               |            |  |ity     |                                 |
|accessType     |AccessType  |M |1       |Describes the access type of the |
|               |            |  |        |UE that applies to the           |
|               |            |  |        |Connectivity management state    |
|               |            |  |        |reported.                        |



6.2.6.2.10  Type: SubscribedData

            Table 6.2.6.2.10-1: Definition of type SubscribedData

|Attribute name |Data type   |P |Cardinal|Description                      |
|               |            |  |ity     |                                 |
|rfspIndex      |RfspIndex   |O |0..1    |Represents the RFSP Index of the |
|               |            |  |        |UE received from UDM             |



6.2.6.2.11  Type: CommunicationFailure

         Table 6.2.6.2.11-1: Definition of type CommunicationFailure

|Attribute name |Data type   |P |Cardinal|Description                      |
|               |            |  |ity     |                                 |
|ranReleaseCode |NgApCause   |O |0..1    |Describes the RAN release code   |
|               |            |  |        |for the communication failure. If|
|               |            |  |        |present, this IE shall contain   |
|               |            |  |        |the decimal value of the NG AP   |
|               |            |  |        |cause code values as specified in|
|               |            |  |        |3GPP TS 38.413 [12].             |



6.2.6.2.12  Type: AmfCreateEventSubscription

      Table 6.2.6.2.12-1: Definition of type AmfCreateEventSubscription

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.2.8 is    |
|               |           |  |        |supported.                       |



6.2.6.2.13  Type: AmfCreatedEventSubscription

     Table 6.2.6.2.13-1: Definition of type AmfCreatedEventSubscription

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|reports        |AmfEventRep|O |0..N    |Represents the immediate event   |
|               |ort        |  |        |reports (i.e. the current value /|
|               |           |  |        |status of the events subscribed),|
|               |           |  |        |if available.                    |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.2.8 is    |
|               |           |  |        |supported.                       |



6.2.6.2.14  Type: AmfUpdateEventSubscriptionItem

      Table 6.2.6.2.14-1: Definition of type AmfUpdateEventSubscription

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|path           |string     |M |1       |This IE contains a JSON pointer  |
|               |           |  |        |value (as defined in             |
|               |           |  |        |IETF RFC 6901 [12]) that         |
|               |           |  |        |references a location of a       |
|               |           |  |        |resource on which the patch      |
|               |           |  |        |operation shall be performed.    |
|               |           |  |        |                                 |
|               |           |  |        |This IE shall contain the JSON   |
|               |           |  |        |pointer to a valid index of the  |
|               |           |  |        |"/events" array in the AMF Event |
|               |           |  |        |Subscription, formatted with     |
|               |           |  |        |following pattern:               |
|               |           |  |        |'\/events\/[0-]$|\/events\/[1-9][|
|               |           |  |        |0-9]*$'                          |
|               |           |  |        |                                 |
|               |           |  |        |Example:                         |
|               |           |  |        |"/events/0" stands for the first |
|               |           |  |        |member of the array;             |
|               |           |  |        |"/events/10" stands for the 11th |
|               |           |  |        |member of the array;             |
|               |           |  |        |"/event/-" stands for a new      |
|               |           |  |        |(non-existent) member after the  |
|               |           |  |        |last existing array element. Only|
|               |           |  |        |allowed with "add" operation.    |
|value          |AmfEvent   |C |0..1    |This IE indicates a new AMF event|
|               |           |  |        |to be added or updated value of  |
|               |           |  |        |an existing AMF event to be      |
|               |           |  |        |modified.                        |
|               |           |  |        |It shall be present if the patch |
|               |           |  |        |operation is "add" or "replace"  |



6.2.6.2.15  Type: AmfUpdatedEventSubscription

     Table 6.2.6.2.15-1: Definition of type AmfUpdatedEventSubscription

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |



6.2.6.2.16  Type: AmfEventArea

             Table 6.2.6.2.16-1: Definition of type AmfEventArea

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|areaId         |string     |C |0..1    |Represents an identifier to the  |
|               |           |  |        |specified area. This IE shall be |
|               |           |  |        |present if the Area of Interest  |
|               |           |  |        |subscribed is a Presence         |
|               |           |  |        |Reporting Area. (See NOTE)       |
|ladn           |string     |C |0..1    |Represents the Local Access Data |
|               |           |  |        |Network DNN. This IE shall be    |
|               |           |  |        |present if the Area of Interest  |
|               |           |  |        |subscribed is a LADN service     |
|               |           |  |        |area. The AMF shall identify the |
|               |           |  |        |list of tracking areas           |
|               |           |  |        |corresponding to the LADN DNN    |
|               |           |  |        |based on local configuration.    |
|ecgi           |array(Ecgi)|C |0..N    |This IE shall be present if the  |
|               |           |  |        |Area of Interest subscribed is a |
|               |           |  |        |list of EUTRAN cell Ids.         |
|ncgi           |array(Ncgi)|C |0..N    |This IE shall be present if the  |
|               |           |  |        |Area of Interest subscribed is a |
|               |           |  |        |list of NR cell Ids.             |
|globalRanNodeId|array(Globa|C |0..N    |This IE shall be present if the  |
|               |lRanNodeId)|  |        |Area of Interest subscribed is a |
|               |           |  |        |list of NG RAN node identifiers. |
|NOTE:  When the AmfEventArea is provided during event subscription, then  |
|for UE specific presence reporting area subscription, the areaId along    |
|with what constitutes that UE specific presence reporting area (i.e. set  |
|of Tai and/or set of ecgi and/or set of ncgi and/or set of                |
|globalRanNodeId) shall be provided.                                       |



6.2.6.3  Simple data types and enumerations


6.2.6.3.1   Introduction

This subclause defines simple data types and enumerations that can be
referenced from data structures defined in the previous subclauses.


6.2.6.3.2   Simple data types

The simple data types defined in table 6.2.6.3.2-1 shall be supported.

                    Table 6.2.6.3.2-1: Simple data types

|Type Name    |Type         |Description                             |
|             |Definition   |                                        |
|5gGuti       |string       |5G Global Unique Temporary Identifier,  |
|             |             |defined in subclause 5.9.4 of           |
|             |             |3GPP TS 23.501 [2]                      |
|Sari         |Bytes        |Service Area Restriction information    |
|RfspIndex    |integer      |RFSP Index                              |



6.2.6.3.3   Enumeration: AmfEventType

                 Table 6.2.6.3.3-1: Enumeration AmfEventType

|Enumeration value           |Description                               |
|"LOCATION_REPORT"           |A NF subscribes to this event to receive  |
|                            |the Last Known Location of a UE or a group|
|                            |of UEs, and Updated Location of the UE or |
|                            |any UE in the group when AMF becomes aware|
|                            |of a location change of the UE.           |
|"PRESENCE_IN_AOI_REPORT"    |A NF subscribes to this event to receive  |
|                            |the current present state of a UE in a    |
|                            |specific Area of Interest (AOI), and      |
|                            |notification when a specified UE enters or|
|                            |leaves the specified area. The area could |
|                            |be identified by a TA list, an area ID or |
|                            |specific interest area name like "LADN".  |
|"TIMEZONE_REPORT"           |A NF subscribes to this event to receive  |
|                            |the current time zone of a UE or a group  |
|                            |of UEs, and updated time zone of the UE or|
|                            |any UE in the group when AMF becomes aware|
|                            |of a time zone change of the UE.          |
|"ACCESS_TYPE_REPORT"        |A NF subscribes to this event to receive  |
|                            |the current access type(s) of a UE or a   |
|                            |group of UEs, and updated access type(s)  |
|                            |of the UE or any UE in the group when AMF |
|                            |becomes aware of the access type change of|
|                            |the UE.                                   |
|"REGISTRATION_STATE_REPORT" |A NF subscribes to this event to receive  |
|                            |the current registration state of a UE or |
|                            |a group of UEs, and report for updated    |
|                            |registration state of a UE or any UE in   |
|                            |the group when AMF becomes aware of a     |
|                            |registration state change of the UE.      |
|"CONNECTIVITY_STATE_REPORT" |A NF subscribes to this event to receive  |
|                            |the current connectivity state of a UE or |
|                            |a group of UEs, and report for updated    |
|                            |connectivity state of a UE or any UE in   |
|                            |the group when AMF becomes aware of a     |
|                            |connectivity state change of the UE.      |
|"REACHABILITY_REPORT"       |A NF subscribes to this event to receive  |
|                            |the current reachability of a UE or a     |
|                            |group of UEs, and report for updated      |
|                            |reachability of a UE or any UE in the     |
|                            |group when AMF becomes aware of a         |
|                            |reachability change of the UE.            |
|"SUBSCRIBED_DATA_REPORT"    |A NF subscribes to this event to receive  |
|                            |the current Subscribed Data for the UE(s) |
|                            |received from UDM, and notification when  |
|                            |AMF received updated subscribed data for  |
|                            |the UE(s) from UDM.                       |
|"COMMIUNICATION_FAILURE_REPO|A NF subscribes to this event to receive  |
|RT"                         |the Communication failure report of a UE  |
|                            |or group of UEs or any UE.                |
|"UES_IN_AREA_REPORT"        |A NF subscribes to this event to receive  |
|                            |the number of UEs in a specific area.     |



6.2.6.3.4   Enumeration: AmfEventTrigger

               Table 6.2.6.3.4-1: Enumeration AmfEventTrigger

|Enumeration value         |Description                                |
|"ONE_TIME"                |Defines that AMF should generate report for|
|                          |the event only once. After reporting, the  |
|                          |subscription to this event will be         |
|                          |terminated.                                |
|"CONTINUOUS"              |Defines that AMF should continuously       |
|                          |generate reports for the event, until the  |
|                          |subscription to this event ends, due to end|
|                          |of report duration or the event being      |
|                          |unsubscribed explicitly                    |



6.2.6.3.5   Enumeration: LocationFilter

                Table 6.2.6.3.5-1: Enumeration LocationFilter

|Enumeration value         |Description                                |
|"TAI"                     |Indicates any change of the TA used by the |
|                          |UE should be reported                      |
|"CELL_ID"                 |Indicates any change of the Cell used by   |
|                          |the UE should be reported                  |
|"N3IWF"                   |Indicates any change of the N3IWF node used|
|                          |by the UE should be reported               |
|"UE_IP"                   |Indicates any change of the UE local IP    |
|                          |address should be reported                 |
|"UDP_PORT"                |Indicates any change of local UDP port used|
|                          |by the UE reported                         |



6.2.6.3.6   Enumeration: SubscribedDataFilter

             Table 6.2.6.3.6-1: Enumeration SubscribedDataFilter

|Enumeration value         |Description                                |
|"SARI"                    |Indicates any change of the Service Area   |
|                          |Restriction Information for the UE received|
|                          |from UDM should be reported                |
|"RFSP_INDEX"              |Indicates any change of the RFSP Index for |
|                          |the UE received from UDM should be reported|



6.2.6.3.7   Enumeration: UeReachability

                Table 6.2.6.3.7-1: Enumeration UeReachability

|Enumeration value         |Description                                |
|"UNREACHABLE"             |Indicates the UE is not reachable          |
|"REACHABLE"               |Indicates the UE is reachable for services |
|"REGULATORY_ONLY"         |Indicates the UE is reachable only for     |
|                          |Regulatory Prioritized Service             |



6.2.6.3.8   Enumeration: PresenceState

                Table 6.2.6.3.8-1: Enumeration PresenceState

|Enumeration value         |Description                                |
|"IN"                      |Indicates the UE is in the specified Area  |
|                          |of interest                                |
|"OUT"                     |Indicates the UE is out of the specified   |
|                          |Area of interest                           |
|"UNKNOWN"                 |Indicates it is unknown whether the UE is  |
|                          |in the specified Area of interest or not   |



6.2.6.3.9   Enumeration: RmState

                   Table 6.2.6.3.9-1: Enumeration RmState

|Enumeration value         |Description                                |
|"REGISTERED"              |Indicates the UE in RM-REGISTERED state    |
|"DEREGISTERED"            |Indicates the UE in RM-DEREGISTERED state  |



6.2.6.3.10  Enumeration: CmState

                   Table 6.2.6.3.10-1: Enumeration CmState

|Enumeration value         |Description                                |
|"IDLE"                    |Indicates the UE is in CM-IDLE state       |
|"CONNECTED"               |Indicates the UE is in CM-CONNECTED state  |



6.2.6.4  Binary data

None.


6.2.7  Error Handling


6.2.7.1  General

HTTP error handling shall be supported as specified in subclause 5.2.4 of
3GPP TS 29.500 [4].


6.2.7.2  Protocol Errors

Protocol Error Handling shall be supported as specified in subclause 5.2.7
of 3GPP TS 29.500 [4].


6.2.7.3  Application Errors

The common application errors defined in the Table 5.2.7.2-1 in
3GPP TS 29.500 [4] may also be used for the Namf_EventExposure service, and
the following application errors listed in Table 6.2.7.3-1 are specific for
the Namf_EventExposure service.

                     Table 6.2.7.3-1: Application errors

|Application Error   |HTTP status  |Description                           |
|                    |code         |                                      |
|UE_NOT_SERVED_BY_AMF|403 Forbidden|Indicates the creation or the         |
|                    |             |modification of a subscription has    |
|                    |             |failed due to an application error    |
|                    |             |when the UE is not served by the AMF. |
|SUBSCRIPTION_NOT_FOU|404 Not Found|Indicates the modification of         |
|ND                  |             |subscription has failed due to an     |
|                    |             |application error when the            |
|                    |             |subscription is not found in the AMF. |



6.2.8  Feature Negotiation

The feature negotiation mechanism specified in subclause 6.6 of
3GPP TS 29.500 [4] shall be used to negotiate the optional features
applicable between the AMF and the NF Service Consumer, for the
Namf_EventExposure service, if any.

The NF Service Consumer shall indicate the optional features it supports
for the Namf_EventExposure service, if any, by including the
supportedFeatures attribute in payload of the HTTP Request Message for
subscription resource creation.

The AMF shall determine the supported features for the service operations
as specified in subclause 6.6 of 3GPP TS 29.500 [4] and shall indicate the
supported features by including the supportedFeatures attribute in payload
of the HTTP response for subscription resource creation.

The syntax of the supportedFeatures attribute is defined in subclause 5.2.2
of 3GPP TS 29.571 [13].

The following features are defined for the Namf_EventExposure service:

       Table 6.2.8-1: Features of supportedFeatures attribute used by
                         Namf_EventExposure service

|Feature|Feature|M/O |Description                                       |
|Number |       |    |                                                  |
|       |       |    |                                                  |
|Feature number: The order number of the feature within the             |
|supportedFeatures attribute (starting with 1).                         |
|Feature: A short name that can be used to refer to the bit and to the  |
|feature.                                                               |
|M/O: Defines if the implementation of the feature is mandatory ("M") or|
|optional ("O").                                                        |
|Description: A clear textual description of the feature.               |



6.2.9  Security

As indicated in 3GPP TS 33.501 [27], the access to the Namf_EventExposure
API shall be authorized by means of the OAuth2 protocol (see
IETF RFC 6749 [28]), using the "Client Credentials" authorization grant,
where the NRF (see 3GPP TS 29.510 [29]) plays the role of the authorization
server.

An NF Service Consumer, prior to consuming services offered by the
Namf_EventExposure API, shall obtain a "token" from the authorization
server, by invoking the Access Token Request service, as described in
3GPP TS 29.510 [29], subclause 5.4.2.2.

  NOTE:  When multiple NRFs are deployed in a network, the NRF used as
         authorization server is the same NRF that the NF Service Consumer
         used for discovering the Namf_EventExposure service.

The Namf_EventExposure API does not define any scopes for OAuth2
authorization.


6.3  Namf_MT Service API


6.3.1  API URI

URIs of this API shall have the following root:

{apiRoot}/{apiName}/{apiVersion}/

where the "apiName" shall be set to "namf-mt" and the "apiVersion" shall be
set to "v1" for the current version of this specification.


6.3.2  Usage of HTTP


6.3.2.1  General

HTTP/2, as defined in IETF RFC 7540 [19], shall be used as specified in
clause 5 of 3GPP TS 29.500 [4].

HTTP/2 shall be transported as specified in subclause 5.3 of
3GPP TS 29.500 [4].

HTTP messages and bodies for the Namf_MT service shall comply with the
OpenAPI [23] specification contained in Annex A.


6.3.2.2  HTTP standard headers


6.3.2.2.1   General

The usage of HTTP standard headers shall be supported as specified in
subclause 5.2.2 of 3GPP TS 29.500 [4].


6.3.2.2.2   Content type

The JSON format shall be supported. The use of the JSON format
(IETF RFC 8259 [8]) shall be signalled by the content type
"application/json". See also subclause 5.4 of 3GPP TS 29.500 [4].


6.3.2.3  HTTP custom headers


6.3.2.3.1   General

In this release of this specification, no custom headers specific to the
Namf_MT service are defined. For 3GPP specific HTTP custom headers used
across all service based interfaces, see clause 5.2.3 of
3GPP TS 29.500 [4].


6.3.3  Resources


6.3.3.1  Overview

                                    [pic]

     Figure 6.3.3.1-1: Resource URI structure of the Namf_MT Service API

Table 6.3.3.1-1 provides an overview of the resources and applicable HTTP
methods.

               Table 6.3.3.1-1: Resources and methods overview

|Resource|Resource URI                          |HTTP  |Description        |
|name    |                                      |method|                   |
|        |                                      |or    |                   |
|        |                                      |custom|                   |
|        |                                      |operat|                   |
|        |                                      |ion   |                   |
|ueReachI|{apiRoot}/namf-mt/v1/ue-contexts/{ueCo|PUT   |Update the         |
|nd      |ntextId}/ue-reachind                  |      |ueReachInd to UE   |
|        |                                      |      |Reachable          |
|ueContex|{apiRoot}/namf-mt/v1/ue-contexts/{ueCo|GET   |Map to following   |
|t       |ntextId}                              |      |service operation: |
|        |                                      |      |-                  |
|        |                                      |      |ProvideDomainSelect|
|        |                                      |      |ionInfo            |



6.3.3.2  Resource: ueReachInd


6.3.3.2.1   Description

This resource represents the ueReachInd for a SUPI.

This resource is modelled as the Document resource archetype (see subclause
C.1 of 3GPP TS 29.501 [5]).


6.3.3.2.2   Resource Definition

Resource URI: {apiRoot}/namf-mt/v1/ue-contexts/{ueContextId}ue-reachind

This resource shall support the resource URI variables defined in
table 6.3.3.2.2-1.

         Table 6.3.3.2.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|ueContextId   |Represents the Subscription Permanent Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.2)                            |
|              |pattern: "(imsi-[0-9]{5,15}|nai-.+)"                        |



6.3.3.2.3   Resource Standard Methods


6.3.3.2.3.1 PUT

This method shall support the URI query parameters specified in table
6.3.3.2.3.1-1.

  Table 6.3.3.2.3.1-1: URI query parameters supported by the PUT method on
                                this resource

|Name       |Data type |P |Cardinal|Description                            |
|           |          |  |ity     |                                       |


This method shall support the request data structures specified in table
6.3.3.2.3.1-2 and the response data structures and response codes specified
in table 6.3.3.2.3.1-3.

  Table 6.3.3.2.3.1-2: Data structures supported by the PUT Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|EnableUeReac|M |1        |Contain the State of the UE, the value shall be  |
|habilityReqD|  |         |set to UE Reachable.                             |
|ata         |  |         |                                                 |


 Table 6.3.3.2.3.1-3: Data structures supported by the PUT Response Body on
                                this resource

|Data type          |P|Cardina|Respons|Description                        |
|                   | |lity   |e      |                                   |
|                   | |       |codes  |                                   |
|ProblemDetails     |M|1      |307    |This represents the case when the  |
|                   | |       |Tempora|related UE context is not fully    |
|                   | |       |ry     |available at the target NF Service |
|                   | |       |Redirec|Consumer (e.g. AMF) during a       |
|                   | |       |t      |planned maintenance case (e.g. AMF |
|                   | |       |       |planned maintenance without UDSF   |
|                   | |       |       |case). The "cause" attribute shall |
|                   | |       |       |be set to one of the following     |
|                   | |       |       |application error:                 |
|                   | |       |       |- NF_CONSUMER_REDIRECT_ONE_TXN     |
|                   | |       |       |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of these errors        |
|                   | |       |       |The Location header of the response|
|                   | |       |       |shall be set to the target NF      |
|                   | |       |       |Service Consumer (e.g. AMF) to     |
|                   | |       |       |which the request is redirected.   |
|ProblemDetails     |M|1      |400 Bad|The "cause" attribute shall be set |
|                   | |       |Request|to one of the following application|
|                   | |       |       |errors:                            |
|                   | |       |       |- INVALID_MSG_FORMAT               |
|                   | |       |       |- MANDAT_IE_INCORRECT              |
|                   | |       |       |- MANDAT_IE_MISSING                |
|                   | |       |       |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of these errors.       |
|ProblemDetails     |M|1      |403    |The "cause" attribute shall be set |
|                   | |       |Forbidd|to one of the following application|
|                   | |       |en     |errors:                            |
|                   | |       |       |- UNABLE_TO_PAGE_UE                |
|                   | |       |       |- UNSPECIFIED                      |
|                   | |       |       |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of this error.         |
|ProblemDetails     |M|1      |404 Not|This represents the case when the  |
|                   | |       |Found  |related UE is not found in the NF  |
|                   | |       |       |Service Consumer (e.g. AMF). The   |
|                   | |       |       |"cause" attribute shall be set to  |
|                   | |       |       |one of the following application   |
|                   | |       |       |error:                             |
|                   | |       |       |- CONTEXT_NOT_FOUND                |
|                   | |       |       |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of these errors        |
|                   | |       |       |                                   |
|ProblemDetails     |M|1      |500    |The "cause" attribute shall be set |
|                   | |       |Interna|to the following application error:|
|                   | |       |l      |- SYSTEM_FAILURE                   |
|                   | |       |Server |See table 6.3.7.3-1 for the        |
|                   | |       |Error  |description of this error.         |
|ProblemDetails     |M|1      |503    |The "cause" attribute shall be set |
|                   | |       |Service|to the following application error:|
|                   | |       |Unavail|- NF_CONGESTION                    |
|                   | |       |able   |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of these errors.       |
|                   | |       |       |The HTTP header field "Retry-After"|
|                   | |       |       |shall not be included in this      |
|                   | |       |       |scenario.                          |
|ProblemDetails     |M|1      |504    |The "cause" attribute shall be set |
|                   | |       |Gateway|to the following application error:|
|                   | |       |Timeout|- UE_NOT_RESPONDING                |
|                   | |       |       |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of this error.         |



6.3.3.2.4   Resource Custom Operations

There is no custom operation supported on this resource.


6.3.3.3  Resource: UeContext


6.3.3.3.1   Description

This resource represents the UeContext for a UE.

This resource is modelled as the Document resource archetype (see subclause
C.1 of 3GPP TS 29.501 [5]).


6.3.3.3.2   Resource Definition

Resource URI: {apiRoot}/namf-mt/v1/ue-contexts/{ueContextId}

This resource shall support the resource URI variables defined in
table 6.3.3.3.2-1.

         Table 6.3.3.3.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|ueContextId   |Represents the Subscription Permanent Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.2)                            |
|              |pattern: "(imsi-[0-9]{5,15}|nai-.+)"                        |



6.3.3.3.3   Resource Standard Methods


6.3.3.3.3.1 GET

This method shall support the URI query parameters specified in table
6.3.3.3.3.1-1.

  Table 6.3.3.2.3.1-1: URI query parameters supported by the GET method on
                                this resource

|Name       |Data type    |P |Cardina|Description                           |
|           |             |  |lity   |                                      |
|Supported-f|SupportedFeat|C |0..1   |This IE shall be present if at least  |
|eatures    |ures         |  |       |one optional feature defined in       |
|           |             |  |       |subclause 6.3.8 is supported.         |


This method shall support the request data structures specified in table
6.3.3.3.3.1-2 and the response data structures and response codes specified
in table 6.3.3.3.3.1-3.

  Table 6.3.3.3.3.1-2: Data structures supported by the GET Request Body on
                                this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|n/a         |  |         |                                                 |


 Table 6.3.3.3.3.1-3: Data structures supported by the GET Response Body on
                                this resource

|Data type          |P|Cardina|Respons|Description                        |
|                   | |lity   |e      |                                   |
|                   | |       |codes  |                                   |
|ProblemDetails     |M|1      |307    |This represents the case when the  |
|                   | |       |Tempora|related UE context is not fully    |
|                   | |       |ry     |available at the target NF Service |
|                   | |       |Redirec|Consumer (e.g. AMF) during a       |
|                   | |       |t      |planned maintenance case (e.g. AMF |
|                   | |       |       |planned maintenance without UDSF   |
|                   | |       |       |case). The "detail" attribute shall|
|                   | |       |       |be set to one of the following     |
|                   | |       |       |application error:                 |
|                   | |       |       |- NF_CONSUMER_REDIRECT_ONE_TXN     |
|                   | |       |       |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of these errors        |
|                   | |       |       |The Location header of the response|
|                   | |       |       |shall be set to the target NF      |
|                   | |       |       |Service Consumer (e.g. AMF) to     |
|                   | |       |       |which the request is redirected.   |
|ProblemDetails     |M|1      |404 Not|This represents the case when the  |
|                   | |       |Found  |related UE is not found in the NF  |
|                   | |       |       |Service Consumer (e.g. AMF). The   |
|                   | |       |       |"detail" attribute shall be set to |
|                   | |       |       |one of the following application   |
|                   | |       |       |error:                             |
|                   | |       |       |- CONTEXT_NOT_FOUND                |
|                   | |       |       |See table 6.3.7.3-1 for the        |
|                   | |       |       |description of these errors        |
|ProblemDetails     |M|1      |403    |Indicate the operation is failed as|
|                   | |       |Forbidd|the UE is not reachable, e.g. after|
|                   | |       |en     |paging.                            |



6.3.3.3.4   Resource Custom Operations

There is no custom operation supported on this resource.


6.3.4  Custom Operations without associated resources

There are no custom operations without associated resources supported on
Namf_MT service.


6.3.5  Notifications

There are no notifications supported on Namf_MT service.


6.3.6  Data Model


6.3.6.1  General

This subclause specifies the application data model supported by the API.

Table 6.3.6.3-1 specifies the data types defined for the Namf_MT service
based interface protocol.

                Table 6.3.6.3-1: Namf_MT specific Data Types

|Data type            |Section    |Description                         |
|                     |defined    |                                    |
|EnableUeReachabilityR|6.3.6.2.2  |Contain the UeReachability,         |
|eqData               |           |indicates the desired reachability  |
|                     |           |status of the UE                    |
|EnableUeReachabilityR|6.3.6.2.3  |Indicates the reachability of UE has|
|spData               |           |been changed as requested.          |
|UeContextInfo        |6.3.6.2.4  |Contains the UE Context Information |
|UeContextInfoClass   |6.3.6.3.5  |Indicates the UE Context information|
|                     |           |class                               |


Table 6.3.6.3-2 specifies data types re-used by the Namf_MT service based
interface protocol from other specifications, including a reference to
their respective specifications and when needed, a short description of
their use within the Namf_MT service based interface.

                 Table 6.3.6.3-2: Namf_MT re-used Data Types

|Data type          |Reference      |Comments                           |
|ProblemDetails     |3GPP TS 29.571 |Common data type used in response  |
|                   |[6]            |bodies                             |
|supportedFeatures  |3GPP TS 29.571 |Supported Features                 |
|                   |[6]            |                                   |
|UeReachability     |6.2.6.3.7      |Describes the reachability of the  |
|                   |               |UE                                 |



6.3.6.2  Structured data types


6.3.6.2.1   Introduction

Structured data types used in Namf_MT service are specified in this clause.


6.3.6.2.2   Type: EnableUeReachabilityReqData

      Table 6.3.6.3.2-1: Definition of type EnableUeReachabilityReqData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.3.8 is    |
|               |           |  |        |supported.                       |



6.3.6.2.3   Type: EnableUeReachabilityRspData

      Table 6.3.6.2.3-1: Definition of type EnableUeReachabilityRspData

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.3.8 is    |
|               |           |  |        |supported.                       |



6.3.6.2.4   Type: UeContextInfo

             Table 6.3.6.2.3-1: Definition of type UeContextInfo

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|lastActTime    |DateTime   |C |0..1    |This IE shall be present when    |
|               |           |  |        |following UE Context Information |
|               |           |  |        |class are required:              |
|               |           |  |        |- "TADS"                         |
|               |           |  |        |                                 |
|               |           |  |        |When present, this IE shall      |
|               |           |  |        |indicate the time stamp of the   |
|               |           |  |        |last radio contact with the UE.  |
|ratType        |RatType    |C |0..1    |This IE shall be present when    |
|               |           |  |        |following UE Context Information |
|               |           |  |        |class are required:              |
|               |           |  |        |- "TADS"                         |
|               |           |  |        |                                 |
|               |           |  |        |When present, this IE shall      |
|               |           |  |        |indicate the current RAT type of |
|               |           |  |        |the UE.                          |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.3.8 is    |
|               |           |  |        |supported.                       |



6.3.6.3.5   Enumeration: UeContextInfoClass

              Table 6.3.6.3.x-1: Enumeration UeContextInfoClass

|Enumeration value         |Description                                |
|"TADS"                    |Defines the UE Context Information for     |
|                          |Terminating Domain Selection for IMS Voice |
|                          |over PS.                                   |



6.3.6.3  Simple data types and enumerations


6.3.6.3.1   Introduction

This subclause defines simple data types and enumerations that can be
referenced from data structures defined in the previous subclauses.


6.3.6.3.2   Simple data types

The simple data types defined in table 6.3.6.3.2-1 shall be supported.

                    Table 6.3.6.3.2-1: Simple data types

|Type Name    |Type         |Description                             |
|             |Definition   |                                        |
|             |             |                                        |



6.3.6.4  Binary data

None.


6.3.7  Error Handling


6.3.7.1  General

HTTP error handling shall be supported as specified in subclause 5.2.4 of
3GPP TS 29.500 [4].


6.3.7.2  Protocol Errors

Protocol Error Handling shall be supported as specified in subclause 5.2.7
of 3GPP TS 29.500 [4].


6.3.7.3  Application Errors

The common application errors defined in the Table 5.2.7.2-1 in
3GPP TS 29.500 [4] may also be used for the Namf_MT service, and the
following application errors listed in Table 6.3.7.3-1 are specific for the
Namf_MT service.


                     Table 6.3.7.3-1: Application errors

|Application Error         |HTTP      |Description                        |
|                          |status    |                                   |
|                          |code      |                                   |
|NF_CONSUMER_REDIRECT_ONE_T|307       |The request has been asked to be   |
|XN                        |Temporary |redirected to a specified target.  |
|                          |Redirect  |                                   |
|UNABLE_TO_PAGE_UE         |403       |AMF is unable page the UE,         |
|                          |Forbidden |temporarily.                       |
|CONTEXT_NOT_FOUND         |404 Not   |The related UE is not found in the |
|                          |Found     |NF Service Consumer.               |
|UE_NOT_RESPONDING         |504       |UE is not responding to the request|
|                          |Gateway   |initiated by the network, e.g.     |
|                          |Timeout   |Paging.                            |



6.3.8  Feature Negotiation

The feature negotiation mechanism specified in subclause 6.6 of
3GPP TS 29.500 [4] shall be used to negotiate the optional features
applicable between the AMF and the NF Service Consumer, for the Namf_MT
service, if any.

The NF Service Consumer shall indicate the optional features it supports
for the Namf_MT service, if any, by including the supportedFeatures
attribute in payload of the HTTP Request Message for following service
operations:

  -  EnableUEReachability, as specified in subclause 5.4.2.2;

-  ProvideDomainSelectionInfo, as specified in subclause 5.4.2.3;The AMF
shall determine the supported features for the service operations as
specified in subclause 6.6 of 3GPP TS 29.500 [4] and shall indicate the
supported features by including the supportedFeatures attribute in payload
of the HTTP response for the service operation.

The syntax of the supportedFeatures attribute is defined in subclause 5.2.2
of 3GPP TS 29.571 [13].

The following features are defined for the Namf_MT service.

   Table 6.3.8-1: Features of supportedFeatures attribute used by Namf_MT
                                   service

|Feature|Feature|M/O |Description                                       |
|Number |       |    |                                                  |
|       |       |    |                                                  |
|Feature number: The order number of the feature within the             |
|supportedFeatures attribute (starting with 1).                         |
|Feature: A short name that can be used to refer to the bit and to the  |
|feature.                                                               |
|M/O: Defines if the implementation of the feature is mandatory ("M") or|
|optional ("O").                                                        |
|Description: A clear textual description of the feature.               |



6.3.9  Security

As indicated in 3GPP TS 33.501 [27], the access to the Namf_MT API shall be
authorized by means of the OAuth2 protocol (see IETF RFC 6749 [28]), using
the "Client Credentials" authorization grant, where the NRF (see
3GPP TS 29.510 [29]) plays the role of the authorization server.

An NF Service Consumer, prior to consuming services offered by the Namf_MT
API, shall obtain a "token" from the authorization server, by invoking the
Access Token Request service, as described in 3GPP TS 29.510 [29],
subclause 5.4.2.2.

  NOTE:  When multiple NRFs are deployed in a network, the NRF used as
         authorization server is the same NRF that the NF Service Consumer
         used for discovering the Namf_MT service.

The Namf_MT API does not define any scopes for OAuth2 authorization.


6.4  Namf_Location Service API


6.4.1  API URI

URIs of this API shall have the following root:

{apiRoot}/{apiName}/{apiVersion}/

where the "apiName" shall be set to "namf-location" and the "apiVersion"
shall be set to "v1" for the current version of this specification.


6.4.2  Usage of HTTP


6.4.2.1  General

HTTP/2, as defined in IETF RFC 7540 [19], shall be used as specified in
clause 5 of 3GPP TS 29.500 [4].

HTTP/2 shall be transported as specified in subclause 5.3 of
3GPP TS 29.500 [4].

HTTP messages and bodies for the Namf_Location service shall comply with
the OpenAPI [23] specification contained in Annex A.


6.4.2.2  HTTP standard headers


6.4.2.2.1   General

The usage of HTTP standard headers shall be supported as specified in
subclause 5.2.2 of 3GPP TS 29.500 [4].


6.4.2.2.2   Content type

The JSON format shall be supported. The use of the JSON format
(IETF RFC 8259 [8]) shall be signalled by the content type
"application/json". See also subclause 5.4 of 3GPP TS 29.500 [4].


6.4.2.3  HTTP custom headers


6.4.2.3.1   General

In this release of this specification, no custom headers specific to the
Namf_Location service are defined. For 3GPP specific HTTP custom headers
used across all service based interfaces, see clause 5.2.3 of
3GPP TS 29.500 [4].


6.4.3  Resources


6.4.3.1  Overview

                                    [pic]

  Figure 6.4.3.1-1: Resource URI structure of the Namf_Location Service API

Table 6.4.3.1-1 provides an overview of the resources and applicable HTTP
methods.

               Table 6.4.3.1-1: Resources and methods overview

|Resource name     |Resource URI                     |HTTP      |Descriptio|
|                  |                                 |method or |n         |
|                  |                                 |custom    |          |
|                  |                                 |operation |          |
|Location          |…/ueContextId}/provide           |(POST)    |ProvideLoc|
|Information for   |                                 |provide   |ation     |
|individual UE     |                                 |          |          |
|context           |                                 |          |          |



6.4.3.2  Resource: Individual UE Context


6.4.3.2.1   Description

This resource represents an individual ueContextId.

This resource is modelled with the Document resource archetype (see
subclause C.1 of 3GPP TS 29.501 [5]).


6.4.3.2.2   Resource Definition

Resource URI:{apiRoot}/namf-loc/v1/{ueContextId}

This resource shall support the resource URI variables defined in
table 6.4.3.2.2-1.

         Table 6.4.3.2.2-1: Resource URI variables for this resource

|Name          |Definition                                                  |
|ueContextId   |Represents the Subscription Permanent Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.2)                            |
|              |pattern: "(supi-[0-9]{5,15}|nai-.+)"                        |
|              |Or represents the Permanent Equipment Identifier (see       |
|              |3GPP TS 23.501 [2] clause 5.9.3)                            |
|              |pattern: "(pei-[0-9]{15})"                                  |



6.4.3.2.3   Resource Standard Methods

There are no standard methods supported on this resource.


6.4.3.2.4   Resource Custom Operations


6.4.3.2.4.1 Overview

                   Table 6.4.3.2.4.1-1: Custom operations

|Custom operaration URI   |Mapped HTTP  |Description                   |
|                         |method       |                              |
|{apiRoot}/namf-loc/v1/   |POST         |Request the                   |
|{ueContextId}/provide    |             |locationInformation resource  |
|                         |             |of the UE.                    |
|                         |             |It is used for the Provide    |
|                         |             |Location service operation.   |



6.4.3.2.4.2 Operation: (POST) provide


6.4.3.2.4.2.1 Description

This ueContextId identifies the individual ueContext is composed by
supi.{supi} or the pei.{pei}.


6.4.3.2.4.2.2 Operation Definition

This operation shall support the request data structures specified in table
6.4.3.2.4.2.2-1 and the response data structure and response codes
specified in table 6.4.3.2.4.2.2-2.

   Table 6.4.3.2.4.2.2-1: Data structures supported by the (POST) retrieve
                        Request Body on this resource

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|RequestUELoc|M |1        |The information to request the location of the   |
|ation       |  |         |UE.                                              |


   Table 6.4.3.2.4.2.2-2: Data structures supported by the (POST) retrieve
                       Response Body on this resource

|Data type   |P |Cardinali|Response|Description                             |
|            |  |ty       |codes   |                                        |
|ProblemDetai|M |1        |403     |The "cause" attribute shall be set to   |
|ls          |  |         |Forbidde|one of the following application errors:|
|            |  |         |n       |- UNAUTHORIZED_REQUESTING_NETWORK       |
|            |  |         |        |- USER_UNKNOWN                          |
|            |  |         |        |- DETACHED_USER                         |
|            |  |         |        |- POSITIONING_DENIED                    |
|            |  |         |        |- POSITIONING_FAILED                    |
|            |  |         |        |- UNSPECIFIED                           |
|            |  |         |        |See table 6.4.7.3-1 for the description |
|            |  |         |        |of these errors.                        |
|ProblemDetai|M |1        |500     |The "cause" attribute shall be set to   |
|ls          |  |         |Internal|the following application error:        |
|            |  |         |Server  |- SYSTEM_FAILURE                        |
|            |  |         |Error   |See table 6.4.7.3-1 for the description |
|            |  |         |        |of this error.                          |
|ProblemDetai|M |1        |503     |The "cause" attribute shall be set to   |
|ls          |  |         |Service |the following application error:        |
|            |  |         |Unavaila|- NF_CONGESTION                         |
|            |  |         |ble     |See table 6.4.7.3-1 for the description |
|            |  |         |        |of these errors.                        |
|            |  |         |        |The HTTP header field "Retry-After"     |
|            |  |         |        |shall not be included in this scenario. |
|ProblemDetai|M |1        |504     |The "cause" attribute shall be set to   |
|ls          |  |         |Gateway |one of the following application errors:|
|            |  |         |Timeout |- UNREACHABLE_USER                      |
|            |  |         |        |- PEER_NOT_RESPONDING                   |
|            |  |         |        |See table 6.4.7.3-1 for the description |
|            |  |         |        |of this error.                          |



6.4.4  Custom Operations without associated resources

There are no custom operations without associated resources supported on
Namf_Location service.


6.4.5  Notifications


6.4.5.1  General

This clause provides the definition of the EventNotify notification of the
Namf_Location service.


6.4.5.2  Event Notify


6.4.5.2.1   Description

This resource represents the callback reference provided by the NF Service
Consumer (e.g. GMLC) to receive LCS event notify.


6.4.5.2.2   Notification Definition

Callback URI: {locationNotificationUri}

Callback URI is provided by the NF Service Consumer (e.g. GMLC) during the
ProvideLocation service operation.


6.4.5.2.3   Notification Standard Methods


6.4.5.2.3.1 POST

This method sends an LCS event notify to the NF Service Consumer.

This method shall support the request data structures specified in table
6.4.5.2.3.1-1 and the response data structures and response codes specified
in table 6.4.5.2.3.1-2.

   Table 6.4.5.2.3.1-1: Data structures supported by the POST Request Body

|Data type   |P |Cardinali|Description                                      |
|            |  |ty       |                                                 |
|NotifiedUELo|M |1        |Representation of the LCS event notify.          |
|cation      |  |         |                                                 |


  Table 6.4.5.2.3.1-2: Data structures supported by the POST Response Body

|Data type  |P |Cardinali|Response|Description                             |
|           |  |ty       |codes   |                                        |
|ProblemDeta|M |1        |403     |The "cause" attribute shall be set to   |
|ils        |  |         |Forbidde|one of the following application errors:|
|           |  |         |n       |- INVALID_MSG_FORMAT                    |
|           |  |         |        |- MANDAT_IE_INCORRECT                   |
|           |  |         |        |- MANDAT_IE_MISSING                     |
|           |  |         |        |See table 6.4.7.3-1 for the description |
|           |  |         |        |of these errors.                        |



6.4.6  Data Model


6.4.6.1  General

This subclause specifies the application data model supported by the API.

Table 6.4.6.1-1 specifies the data types defined for the Namf_Location
service based interface protocol.

             Table 6.4.6.1-1: Namf_Location specific Data Types

|Data type      |Section     |Description                              |
|               |defined     |                                         |
|RequestUELocati|6.4.6.2.2   |Information within Provide Location      |
|on             |            |Request                                  |
|ProvideUELocati|6.4.6.2.3   |Information within Provide Location      |
|on             |            |Response                                 |
|NotifiedUELocat|6.4.6.2.4   |Information within EventNotify           |
|ion            |            |notification                             |
|BarometricPress|6.4.6.3.2   |Information within Provide Location      |
|ure            |            |Response and EventNotify notification    |
|LocationType   |6.4.6.3.3   |Information within Provide Location      |
|               |            |Response and EventNotify notification    |
|LocationEvent  |6.4.6.3.4   |Information within EventNotify           |
|               |            |notification                             |


Table 6.4.6.1-2 specifies data types re-used by the Namf_Location service
based interface protocol from other specifications, including a reference
to their respective specifications and when needed, a short description of
their use within the Namf_Location service based interface.

              Table 6.4.6.1-2: Namf_Location re-used Data Types

|Data type                   |Reference      |Comments                  |
|Supi                        |3GPP TS 29.571 |Subscription Permanent    |
|                            |[6]            |Identifier                |
|Gpsi                        |3GPP TS 29.571 |General Public            |
|                            |[6]            |Subscription Identifier   |
|Pei                         |3GPP TS 29.571 |Permanent Equipment       |
|                            |[6]            |Identifier                |
|ExternalClientType          |3GPP TS 29.572 |LCS Client Type           |
|                            |[25]           |(Emergency, Lawful        |
|                            |               |Interception …)           |
|LocationQoS                 |3GPP TS 29.572 |LCS QoS (accuracy,        |
|                            |[25]           |response time)            |
|SupportedGADShapes          |3GPP TS 29.572 |LCS supported GAD shapes  |
|                            |[25]           |                          |
|GeographicArea              |3GPP TS 29.572 |Estimate of the location  |
|                            |[25]           |of the UE                 |
|AccuracyFulfilmentIndicator |3GPP TS 29.572 |Requested accuracy was    |
|                            |[25]           |fulfilled or not          |
|AgeOfLocationEstimate       |3GPP TS 29.572 |Age Of Location Estimate  |
|                            |[25]           |                          |
|PositioningMethodAndUsage   |3GPP TS 29.572 |Usage of each non-GANSS   |
|                            |[25]           |positioning method        |
|VelocityEstimate            |3GPP TS 29.572 |Estimate of the velocity  |
|                            |[25]           |of the target UE          |
|VelocityRequested           |3GPP TS 29.572 |Indication of the Velocity|
|                            |[25]           |requirement               |
|LcsPriority                 |3GPP TS 29.572 |Priority of the LCS client|
|                            |[25]           |                          |
|GnssPositioningMethodAndUsag|3GPP TS 29.572 |Usage of each GANSS       |
|e                           |[25]           |positioning method        |
|CivicAddress                |3GPP TS 29.572 |Civic address             |
|                            |[25]           |                          |
|Ecgi                        |3GPP TS 29.571 |UE EUTRAN cell information|
|                            |[6]            |                          |
|Ncgi                        |3GPP TS 29.571 |UE NR cell information    |
|                            |[6]            |                          |
|SupportedFeatures           |3GPP TS 29.571 |Supported Features        |
|                            |[6]            |                          |



6.4.6.2  Structured data types


6.4.6.2.1   Introduction

Structured data types used in Namf_Location service are specified in this
clause.


6.4.6.2.2   Type: RequestUELocation

           Table 6.4.6.2.2-1: Definition of type RequestUELocation

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|lcsLocation    |LocationTyp|M |1       |This IE shall contain the type of|
|               |e          |  |        |location measurement requested,  |
|               |           |  |        |such as current location, initial|
|               |           |  |        |location, last known location,   |
|               |           |  |        |etc.                             |
|supi           |Supi       |C |0..1    |If the SUPI is available, this IE|
|               |           |  |        |shall be present.                |
|gpsi           |Gpsi       |C |0..1    |If the GPSI is available, this IE|
|               |           |  |        |shall be present.                |
|priority       |LcsPriority|O |0..1    |If present, this IE shall contain|
|               |           |  |        |the priority of the LCS client   |
|               |           |  |        |issuing the positioning request. |
|lcsQoS         |LocationQoS|O |0..1    |If present, this IE shall contain|
|               |           |  |        |the quality of service requested,|
|               |           |  |        |such as the accuracy of the      |
|               |           |  |        |positioning measurement and the  |
|               |           |  |        |response time of the positioning |
|               |           |  |        |operation                        |
|velocityRequest|VelocityReq|O |0..1    |If present, this IE shall contain|
|ed             |uested     |  |        |an indication of whether or not  |
|               |           |  |        |the Velocity of the target UE is |
|               |           |  |        |requested.                       |
|lcsSupportedGAD|SupportedGA|O |0..1    |If present, this IE shall contain|
|Shapes         |DShapes    |  |        |the list of supported GAD shapes |
|               |           |  |        |by the LCS client.               |
|locationNotific|Uri        |O |0..1    |The callback URI on which        |
|ationUri       |           |  |        |location change event            |
|               |           |  |        |notification is reported.        |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.4.8 is    |
|               |           |  |        |supported.                       |



6.4.6.2.3   Type: ProvideUELocation

           Table 6.4.6.2.3-1: Definition of type ProvideUELocation

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|accuracyFulfilm|AccuracyFul|O |0..1    |If present, this IE shall contain|
|entIndicator   |filmentIndi|  |        |an indication of whether the     |
|               |cator      |  |        |requested accuracy (as indicated |
|               |           |  |        |in the LcsQoS in the request     |
|               |           |  |        |message) was fulfilled or not.   |
|ageOfLocationEs|AgeOfLocati|O |0..1    |If present, this IE shall contain|
|timate         |onEstimate |  |        |an indication of how long ago the|
|               |           |  |        |location estimate was obtained.  |
|velocityEstimat|VelocityEst|O |0..1    |If present, this IE shall contain|
|e              |imate      |  |        |an estimate of the velocity of   |
|               |           |  |        |the target UE, composed by       |
|               |           |  |        |horizontal speed, vertical speed,|
|               |           |  |        |and their respective uncertainty.|
|positioningData|array(Posit|O |0..9    |If present, this IE shall        |
|               |ioningMetho|  |        |indicate the usage of each non-  |
|               |dAndUsage) |  |        |GANSS positioning method that was|
|               |           |  |        |attempted to determine the       |
|               |           |  |        |location estimate, either        |
|               |           |  |        |successfully or unsuccessfully.  |
|gnssPositioning|GnssPositio|O |0..9    |If present, this IE shall        |
|Data           |ningMethodA|  |        |indicate the usage of each GANSS |
|               |ndUsage    |  |        |positioning method that was      |
|               |           |  |        |attempted to determine the       |
|               |           |  |        |location estimate, either        |
|               |           |  |        |successfully or unsuccessfully.  |
|ecgi           |Ecgi       |O |0..1    |If present, this IE shall contain|
|               |           |  |        |the current EUTRAN cell location |
|               |           |  |        |of the target UE as delivered by |
|               |           |  |        |the 5G-AN.                       |
|ncgi           |Ncgi       |O |0..1    |If present, this IE shall contain|
|               |           |  |        |the current NR cell location of  |
|               |           |  |        |the target UE as delivered by the|
|               |           |  |        |5G-AN.                           |
|targetServingNo|NfInstanceI|O |0..1    |If present, this IE shall contain|
|de             |d          |  |        |the address of the target side   |
|               |           |  |        |serving node for handover of an  |
|               |           |  |        |IMS Emergency Call.              |
|civicAddress   |CivicAddres|O |0..1    |If present, this IE contains a   |
|               |s          |  |        |location estimate for the target |
|               |           |  |        |UE expressed as a Civic address. |
|barometricPress|BarometricP|O |0..1    |If present, this IE contains the |
|ure            |ressure    |  |        |barometric pressure measurement  |
|               |           |  |        |as reported by the target UE.    |
|supportedFeatur|SupportedFe|C |0..1    |This IE shall be present if at   |
|es             |atures     |  |        |least one optional feature       |
|               |           |  |        |defined in subclause 6.4.8 is    |
|               |           |  |        |supported.                       |



6.4.6.2.4   Type: NotifiedUELocation

          Table 6.4.6.2.4-1: Definition of type NotifiedUELocation

|Attribute name |Data type  |P |Cardinal|Description                      |
|               |           |  |ity     |                                 |
|supi           |Supi       |C |0..1    |This IE shall contain the SUPI if|
|               |           |  |        |available (see NOTE 1).          |
|gpsi           |Gpsi       |C |0..1    |This IE shall contain the GPSI if|
|               |           |  |        |available (see NOTE 1).          |
|pei            |Pei        |C |0..1    |This IE shall contain the PEI if |
|               |           |  |        |available (see NOTE 1).          |
|locationEstimat|GeographicA|O |0..1    |If present, this IE shall contain|
|e              |rea        |  |        |an estimate of the location of   |
|               |           |  |        |the UE in universal coordinates  |
|               |           |  |        |and the accuracy of the estimate.|
|ageOfLocationEs|AgeOfLocati|O |0..1    |If present, this IE shall contain|
|timate         |onEstimate |  |        |an indication of how long ago the|
|               |           |  |        |location estimate was obtained.  |
|velocityEstimat|VelocityEst|O |0..1    |If present, this IE shall contain|
|e              |imate      |  |        |an estimate of the velocity of   |
|               |           |  |        |the target UE, composed by       |
|               |           |  |        |horizontal speed, vertical speed,|
|               |           |  |        |and their respective uncertainty.|
|positioningData|Positioning|O |0..9    |If present, this IE shall        |
|               |MethodAndUs|  |        |indicate the usage of each       |
|               |age        |  |        |non-GANSS positioning method that|
|               |           |  |        |was attempted to determine the   |
|               |           |  |        |location estimate, either        |
|               |           |  |        |successfully or unsuccessfully.  |
|gnssPositioning|GnssPositio|O |0..9    |If present, this IE shall        |
|Data           |ningMethodA|  |        |indicate the usage of each GANSS |
|               |ndUsage    |  |        |positioning method that was      |
|               |           |  |        |attempted to determine the       |
|               |           |  |        |location estimate, either        |
|               |           |  |        |successfully or unsuccessfully.  |
|ecgi           |Ecgi       |O |0..1    |If present, this IE shall contain|
|               |           |  |        |the current EUTRAN cell location |
|               |           |  |        |of the target UE as delivered by |
|               |           |  |        |the 5G-AN.                       |
|ncgi           |Ncgi       |O |0..1    |If present, this IE shall contain|
|               |           |  |        |the current NR cell location of  |
|               |           |  |        |the target UE as delivered by the|
|               |           |  |        |5G-AN.                           |
|servingNode    |NfInstanceI|O |0..1    |If present, this IE shall contain|
|               |d          |  |        |the address of the serving node. |
|               |           |  |        |For handover of an IMS Emergency |
|               |           |  |        |Call, this IE shall contain the  |
|               |           |  |        |address of the target side       |
|               |           |  |        |serving node.                    |
|civicAddress   |CivicAddres|O |0..1    |If present, this IE contains a   |
|               |s          |  |        |location estimate for the target |
|               |           |  |        |UE expressed as a Civic address. |
|barometricPress|BarometricP|O |0..1    |If present, this IE contains the |
|ure            |ressure    |  |        |barometric pressure measurement  |
|               |           |  |        |as reported by the target UE.    |
|NOTE 1:  At least one of these IEs shall be present in the message.       |



6.4.6.3  Simple data types and enumerations


6.4.6.3.1   Introduction

This subclause defines simple data types and enumerations that can be
referenced from data structures defined in the previous subclauses.


6.4.6.3.2   Simple data types

The simple data types defined in table 6.4.6.3.2-1 shall be supported.

                    Table 6.4.6.3.2-1: Simple data types

|Type Name    |Type         |Description                             |
|             |Definition   |                                        |
|BarometricPre|integer      |This IE specifies the measured          |
|ssure        |             |uncompensated atmospheric pressure in   |
|             |             |units of Pascal (Pa).                   |
|             |             |Minimum = 30000. Maximum = 115000.      |



6.4.6.3.3   Enumeration: LocationType

The enumeration LocationType represents the type of location measurement
requested.

                 Table 6.4.6.3.3-1: Enumeration LocationType

|Enumeration value                                |Description          |
|"CURRENT_LOCATION"                               |                     |
|"CURRENT_OR_LAST_KNOWN_LOCATION"                 |                     |
|"INITIAL_LOCATION"                               |                     |



6.4.6.3.4   Enumeration: LocationEvent

The enumeration LocationEvent represents the type of location measurement
requested.

                Table 6.4.6.3.4-1: Enumeration LocationEvent

|Enumeration value               |Description                           |
|"EMERGENCY_CALL_ORIGINATION"    |Emergency session initiation          |
|"EMERGENCY_CALL_RELEASE"        |Emergency session termination         |
|"EMERGENCY_CALL_HANDOVER"       |Handover of an Emergency session      |



6.4.7  Error Handling


6.4.7.1  General

HTTP error handling shall be supported as specified in subclause 5.2.4 of
3GPP TS 29.500 [4].


6.4.7.2  Protocol Errors

Protocol Error Handling shall be supported as specified in subclause 5.2.7
of 3GPP TS 29.500 [4].


6.4.7.3  Application Errors

The common application errors defined in the Table 5.2.7.2-1 in
3GPP TS 29.501 [5] may also be used for the Namf_Location service, and the
following application errors listed in Table 6.4.7.3-1 are specific for the
Namf_Location service.


                     Table 6.4.7.3-1: Application errors

|Application Error            |HTTP     |Description                       |
|                             |status   |                                  |
|                             |code     |                                  |
|UNAUTHORIZED_REQUESTING_NETWO|403      |The requesting GMLC's network is  |
|RK                           |Forbidden|not authorized to request UE      |
|                             |         |location information.             |
|USER_UNKNOWN                 |403      |The user is unknown.              |
|                             |Forbidden|                                  |
|DETACHED_USER                |403      |The user is detached in the AMF.  |
|                             |Forbidden|                                  |
|POSITIONING_DENIED           |403      |The positioning procedure was     |
|                             |Forbidden|denied.                           |
|POSITIONING_FAILED           |403      |The positioning procedure failed. |
|                             |Forbidden|                                  |
|UNREACHABLE_USER             |504      |The user could not be reached in  |
|                             |Gateway  |order to perform positioning      |
|                             |Timeout  |procedure.                        |
|PEER_NOT_RESPONDING          |504      |No response is received from a    |
|                             |Gateway  |remote peer, e.g. from the LMF.   |
|                             |Timeout  |                                  |



6.4.8  Feature Negotiation

The feature negotiation mechanism specified in subclause 6.6 of
3GPP TS 29.500 [4] shall be used to negotiate the optional features
applicable between the AMF and the NF Service Consumer, for the
Namf_Location service, if any.

The NF Service Consumer shall indicate the optional features it supports
for the Namf_Location service, if any, by including the supportedFeatures
attribute in payload of the HTTP Request Message for following service
operations:

  -  ProvideLocation, as specified in subclause 5.5.2.2;

The AMF shall determine the supported features for the service operations
as specified in subclause 6.6 of 3GPP TS 29.500 [4] and shall indicate the
supported features by including the supportedFeatures attribute in payload
of the HTTP response for the service operation.

The syntax of the supportedFeatures attribute is defined in subclause 5.2.2
of 3GPP TS 29.571 [13].

The following features are defined for the Namf_Location service.

       Table 6.1.8-1: Features of supportedFeatures attribute used by
                            Namf_Location service

|Feature|Feature|M/O |Description                                       |
|Number |       |    |                                                  |
|       |       |    |                                                  |
|Feature number: The order number of the feature within the             |
|supportedFeatures attribute (starting with 1).                         |
|Feature: A short name that can be used to refer to the bit and to the  |
|feature.                                                               |
|M/O: Defines if the implementation of the feature is mandatory ("M") or|
|optional ("O").                                                        |
|Description: A clear textual description of the feature.               |



6.4.9  Security

As indicated in 3GPP TS 33.501 [27], the access to the Namf_Location API
shall be authorized by means of the OAuth2 protocol (see
IETF RFC 6749 [28]), using the "Client Credentials" authorization grant,
where the NRF (see 3GPP TS 29.510 [29]) plays the role of the authorization
server.

An NF Service Consumer, prior to consuming services offered by the
Namf_Location API, shall obtain a "token" from the authorization server, by
invoking the Access Token Request service, as described in
3GPP TS 29.510 [29], subclause 5.4.2.2.

  NOTE:  When multiple NRFs are deployed in a network, the NRF used as
         authorization server is the same NRF that the NF Service Consumer
         used for discovering the Namf_Location service.

The Namf_Location API does not define any scopes for OAuth2 authorization.


Annex A (normative):   OpenAPI specification


A.1  General

This Annex specifies the API definition of the service provided by AMF in
this document. The APIs are defined by OpenAPI 3.0.0 specifications in YAML
format, following guidelines in 3GPP TS 29.501 [5].

The APIs for specified for following services:

  -  Namf_Communication Service

  -  Namf_EventExposure Service

  -  Namf_MT Service

  -  Namf_Location Service


A.2  Namf_Communication API

openapi: 3.0.0
info:
  version: 1.R15.0.0
  title: AMF Communication Service
  description: AMF Communication Service
security:
  - oAuth2Clientcredentials: []
externalDocs:
  description: Documentation
  url: 'http://www.3gpp.org/ftp/Specs/archive/29_series/29.518/29518-
120.zip'
servers:
  - url: https://{apiRoot}/namf-comm/v1
    variables:
      apiRoot:
        default: locahhost:8080
paths:
  /ue-contexts/{ueContextId}:
    put:
      summary: Namf_Communication CreateUEContext service Operation
      tags:
        - Create UE Contxt
      operationId: CreateUEContext
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UeContextCreateData'
          multipart/related:  # message with binary body part(s)
            schema:
              type: object
              properties: # Request parts
                jsonData:
                  $ref: '#/components/schemas/UeContextCreateData'
                binaryDataN1Message:
                  type: string
                  format: binary
                binaryDataN2Information:
                  type: string
                  format: binary
            encoding:
              jsonData:
                contentType:  application/json
              binaryDataN1Message:
                contentType:  application/vnd.3gpp.5gnas
                headers:
                  Content-Id:
                    schema:
                      type: string
              binaryDataN2Information:
                contentType:  application/vnd.3gpp.ngap
                headers:
                  Content-Id:
                    schema:
                      type: string
        required: true
      responses:
        '201':
          description: UE context successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UeContextCreatedData'
            multipart/related:  # message with binary body part(s)
              schema:
                type: object
                properties: # Request parts
                  jsonData:
                    $ref: '#/components/schemas/UeContextCreatedData'
                  binaryDataN1Message:
                    type: string
                    format: binary
                  binaryDataN2Information:
                    type: string
                    format: binary
              encoding:
                jsonData:
                  contentType:  application/json
                binaryDataN1Message:
                  contentType:  application/vnd.3gpp.5gnas
                  headers:
                    Content-Id:
                      schema:
                        type: string
                binaryDataN2Information:
                  contentType:  application/vnd.3gpp.ngap
                  headers:
                    Content-Id:
                      schema:
                        type: string
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UeContextCreateError'
        default:
          description: Unexpected error
  /ue-contexts/{ueContextId}/release:
    post:
      summary: Namf_Communication ReleaseUEContext service Operation
      tags:
        - Release UE Contxt
      operationId: ReleaseUEContext
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UEContextRelease'
        required: true
      responses:
        '204':
          description: UE Context successfully released
        '400':
          $ref: 'TS29571_CommonData.yaml#/components/responses/400'
        '403':
          $ref: 'TS29571_CommonData.yaml#/components/responses/403'
        '404':
          $ref: 'TS29571_CommonData.yaml#/components/responses/404'
        '500':
          $ref: 'TS29571_CommonData.yaml#/components/responses/500'
        '503':
          $ref: 'TS29571_CommonData.yaml#/components/responses/503'
        default:
          description: Unexpected error
  /ue-contexts/{ueContextId}/assignEbi:
    post:
      summary: Namf_Communication EBI Assignment service Operation
      tags:
        - EBI Assignment
      operationId: EBIAssignment
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssignEbi'
        required: true
      responses:
        '200':
          description: EBI Assignment successfully performed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssignedEbi'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssignEbiError'
        default:
          description: Unexpected error
  /ue-contexts/{ueContextId}/transfer:
    post:
      summary: Namf_Communication UEContextTransfer service Operation
      tags:
        - UE Context Transfer
      operationId: UEContextTransfer
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UeContextTransferReqData'
          multipart/related:  # message with binary body part(s)
            schema:
              type: object
              properties: # Request parts
                jsonData:
                  $ref: '#/components/schemas/UeContextTransferReqData'
                binaryDataN1Message:
                  type: string
                  format: binary
            encoding:
              jsonData:
                contentType:  application/json
              binaryDataN1Message:
                contentType:  application/vnd.3gpp.5gnas
                headers:
                  Content-Id:
                    schema:
                      type: string
        required: true
      responses:
        '200':
          description: UE context transfer successfully initiated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UeContextTransferRspData'
        '403':
          description: Forbidden
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        default:
          description: Unexpected error
      callbacks:
        onRegistrationCompleteNotify:
          {$response.body#/regCompleteNotifyUri}:
            post:
              summary: Namf_Communication RegistratioComplateNotify service
Operation
              tags:
                - Registration Complete Notify
              operationId: RegistrationCompleteNotify
              requestBody:
                description: Registration Complete Notification
                content:
                  application/json:
                    schema:
                      $ref: '#/components/schemas/UERegCompleteNotifData'
              responses:
                '204':
                  description: Expected response to a successful callback
processing
  /ue-contexts/{ueContextId}/n1-n2-messages:
    post:
      summary: Namf_Communication N1N2 Message Transfer (UE Specific)
service Operation
      tags:
        - N1N2 Message Transfer
      operationId: N1N2MessageTransfer
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/N1N2MessageData'
          multipart/related:  # message with binary body part(s)
            schema:
              type: object
              properties: # Request parts
                jsonData:
                  $ref: '#/components/schemas/N1N2MessageData'
                binaryDataN1Message:
                  type: string
                  format: binary
                binaryDataN2Information:
                  type: string
                  format: binary
            encoding:
              jsonData:
                contentType:  application/json
              binaryDataN1Message:
                contentType:  application/vnd.3gpp.5gnas
                headers:
                  Content-Id:
                    schema:
                      type: string
              binaryDataN2Information:
                contentType:  application/vnd.3gpp.ngap
                headers:
                  Content-Id:
                    schema:
                      type: string
        required: true
      responses:
        '202':
          description: N1N2 Message Transfer accepted.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N1N2MessageTransferRspData'
        '200':
          description: N1N2 Message Transfer successfully initiated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N1N2MessageTransferRspData'
        '307':
          description: Temporary Redirect
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        '404':
          description: Not Found
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        '409':
          description: Conflicts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N1N2MessageTransferError'
        '504':
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N1N2MessageTransferError'
        default:
          description: Unexpected error
      callbacks:
        onN1N2TransferFailure:
          {$request.body#/n1n2FailureTxfNotifURI}:
            post:
              summary: Namf_Communication N1N2MessageTransfer Failure
Notification service Operation
              tags:
                - N1N2MessageTransfer Failure Notification
              operationId: N1N2MessageTransferFailureNotification
              requestBody:
                description: N1N2MessageTransfer Failure Notification
                content:
                  application/json:
                    schema:
                      $ref:
'#/components/schemas/N1N2MsgTxfrFailureNotification'
              responses:
                '204':
                  description: Expected response to a successful callback
processing
  /ue-contexts/{ueContextId}/n1-n2-messages/subscriptions:
    post:
      summary: Namf_Communication N1N2 Message Subscribe (UE Specific)
service Operation
      tags:
        - N1N2 Message Subscribe
      operationId: N1N2MessageSubscribe
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UeN1N2InfoSubscriptionCreateData'
        required: true
      responses:
        '201':
          description: N1N2 Message Subscription successfully created.
          content:
            application/json:
              schema:
                $ref:
'#/components/schemas/UeN1N2InfoSubscriptionCreatedData'
        default:
          description: Unexpected error
      callbacks:
        onN1N2MessageNotify:
          '{$request.body#/n1NotifyCallbackUri}':
            post:
              summary: Namf_Communication N1 Message Notify service
Operation
              tags:
                - N1 Message Notify
              operationId: N1MessageNotify
              requestBody:
                description: N1 Message Notification
                content:
                  multipart/related:  # message with binary body part(s)
                    schema:
                      type: object
                      properties: # Request parts
                        jsonData:
                          $ref:
'#/components/schemas/N1MessageNotification'
                        binaryDataN1Message:
                          type: string
                          format: binary
                    encoding:
                      jsonData:
                        contentType:  application/json
                      binaryDataN1Message:
                        contentType:  application/vnd.3gpp.5gnas
                        headers:
                          Content-Id:
                            schema:
                              type: string
              responses:
                '204':
                  description: Expected response to a successful callback
processing
                '403':
                  description: Forbidden
                  content:
                    application/problem+json:
                      schema:
                        $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
          '{$request.body#/n2NotifyCallbackUri}':
            post:
              summary: Namf_Communication N2 Info Notify (UE Specific)
service Operation
              tags:
                - N2 Info Notify
              operationId: N2InfoNotify
              requestBody:
                description: UE Specific N2 Informaiton Notification
                content:
                  multipart/related:  # message with binary body part(s)
                    schema:
                      type: object
                      properties: # Request parts
                        jsonData:
                          $ref:
'#/components/schemas/N2InformationNotification'
                        binaryDataN1Message:
                          type: string
                          format: binary
                        binaryDataN2Information:
                          type: string
                          format: binary
                    encoding:
                      jsonData:
                        contentType:  application/json
                      binaryDataN1Message:
                        contentType:  application/vnd.3gpp.5gnas
                        headers:
                          Content-Id:
                            schema:
                              type: string
                      binaryDataN2Information:
                        contentType:  application/vnd.3gpp.ngap
                        headers:
                          Content-Id:
                            schema:
                              type: string
              responses:
                '204':
                  description: Expected response to a successful callback
processing
  /ue-contexts/{ueContextId}/n1-n2-messages/subscriptions/{subscriptionId}:
    delete:
      summary: Namf_Communication N1N2 Message UnSubscribe (UE Specific)
service Operation
      tags:
        - N1N2 Message UnSubscribe
      operationId: N1N2MessageUnSubscribe
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
        - name: subscriptionId
          in: path
          description: Subscription Identifier
          required: true
          schema:
            type: string
      responses:
        '204':
          description: N1N2 Message Subscription successfully removed.
  /non-ue-n2-messages/transfer:
    post:
      summary: Namf_Communication Non UE N2 Message Transfer service
Operation
      tags:
        - Non UE N2 Message Transfer
      operationId: NonUeN2MessageTransfer
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/N2InformationTransferReqData'
          multipart/related:  # message with binary body part(s)
            schema:
              type: object
              properties: # Request parts
                jsonData:
                  $ref: '#/components/schemas/N2InformationTransferReqData'
                binaryDataN2Information:
                  type: string
                  format: binary
            encoding:
              jsonData:
                contentType:  application/json
              binaryDataN2Information:
                contentType:  application/vnd.3gpp.ngap
                headers:
                  Content-Id:
                    schema:
                      type: string
        required: true
      responses:
        '200':
          description: Non UE N2 Message Transfer successfully initiated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N2InformationTransferRspData'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N2InformationTransferError'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N2InformationTransferError'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N2InformationTransferError'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N2InformationTransferError'
        '503':
          description: Service Unavailable
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/N2InformationTransferError'
        default:
          description: Unexpected error
  /non-ue-n2-messages/subscriptions:
    post:
      summary: Namf_Communication Non UE N2 Info Subscribe service
Operation
      tags:
        - Non UE N2 Info Subscribe
      operationId: NonUeN2InfoSubscribe
      requestBody:
        content:
          application/json:
            schema:
              $ref:
'#/components/schemas/NonUeN2InfoSubscriptionCreateData'
        required: true
      responses:
        '201':
          description: Non UE N2 Info Subscription successfully created.
          content:
            application/json:
              schema:
                $ref:
'#/components/schemas/NonUeN2InfoSubscriptionCreatedData'
        '403':
          description: Forbidden
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        default:
          description: Unexpected error
      callbacks:
        onN2InfoNotify:
          {$request.body#/n2NotifyCallbackUri}:
            post:
              summary: Namf_Communication Non UE N2 Info Notify service
Operation
              tags:
                - Non UE N2 Info Notify
              operationId: NonUeN2InfoNotify
              requestBody:
                description: Non UE N2 Informaiton Notification
                content:
                  application/json:
                    schema:
                      $ref:
'#/components/schemas/N2InformationNotification'
                  multipart/related:  # message with binary body part(s)
                    schema:
                      type: object
                      properties: # Request parts
                        jsonData:
                          $ref:
'#/components/schemas/N2InformationNotification'
                        binaryDataN2Information:
                          type: string
                          format: binary
                    encoding:
                      jsonData:
                        contentType:  application/json
                      binaryDataN2Information:
                        contentType:  application/vnd.3gpp.ngap
                        headers:
                          Content-Id:
                            schema:
                              type: string
              responses:
                '204':
                  description: Expected response to a successful callback
processing
  /non-ue-n2-messages/subscriptions/{n2NotifySubscriptionId}:
    delete:
      summary: Namf_Communication Non UE N2 Info UnSubscribe service
Operation
      tags:
        - Non UE N2 Info UnSubscribe
      operationId: NonUeN2InfoUnSubscribe
      parameters:
        - name: n2NotifySubscriptionId
          in: path
          description: N2 info Subscription Identifier
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Non UE N2 INfo Subscription successfully removed.
  /subscriptions:
    post:
      summary: Namf_Communication AMF Status Change Subscribe service
Operation
      tags:
        - AMF Status Change Subscribe
      operationId: AMFStatusChangeSubscribe
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscriptionData'
        required: true
      responses:
        '201':
          description: N1N2 Message Subscription successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionData'
        '400':
          $ref: 'TS29571_CommonData.yaml#/components/responses/400'
        '403':
          $ref: 'TS29571_CommonData.yaml#/components/responses/403'
        '500':
          $ref: 'TS29571_CommonData.yaml#/components/responses/500'
        '503':
          $ref: 'TS29571_CommonData.yaml#/components/responses/503'
        default:
          description: Unexpected error
      callbacks:
        onAmfStatusChange:
          {$request.body#/amfStatusUri}:
            post:
              summary: Amf Status Change Notify service Operation
              tags:
                - Amf Status Change Notify
              operationId: AmfStatusChangeNotify
              requestBody:
                description: Amf Status Change Notification
                content:
                  application/json:
                    schema:
                      $ref:
'#/components/schemas/AmfStatusChangeNotification'
              responses:
                '204':
                  description: Expected response to a successful callback
processing
                '404':
                  $ref: 'TS29571_CommonData.yaml#/components/responses/404'
  /subscriptions/{subscriptionId}:
    delete:
      summary: Namf_Communication AMF Status Change UnSubscribe service
Operation
      tags:
        - AMF Status Change UnSubscribe
      operationId: AMFStatusChangeUnSubscribe
      parameters:
        - name: subscriptionId
          in: path
          description: AMF Status Change Subscription Identifier
          required: true
          schema:
            type: string
      responses:
        '204':
          description: N1N2 Message Subscription successfully removed.
        '404':
          $ref: 'TS29571_CommonData.yaml#/components/responses/404'
    put:
      summary: Namf_Communication AMF Status Change Subscribe Modify
service Operation
      tags:
        - AMF Status Change Subscribe Modify
      operationId: AMFStatusChangeSubscribeModfy
      parameters:
        - name: subscriptionId
          in: path
          description: AMF Status Change Subscription Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscriptionData'
        required: true
      responses:
        '202':
          description: N1N2 Message Subscription successfully updated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionData'
        '403':
          description: Forbidden
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        default:
          description: Unexpected error
      callbacks:
        OnAmfStatusChange:
          {$request.body#/amfStatusUri}:
            post:
              summary: Amf Status Change Notify service Operation
              tags:
                - Amf Status Change Notify
              operationId: AmfStatusChangeNOtify
              requestBody:
                description: Amf Status Change Notification
                content:
                  application/json:
                    schema:
                      $ref:
'#/components/schemas/AmfStatusChangeNotification'
              responses:
                '204':
                  description: Expected response to a successful callback
processing
                '403':
                  description: Forbidden
                  content:
                    application/problem+json:
                      schema:
                        $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
components:
  securitySchemes:
    oAuth2ClientCredentials:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: '{nrfApiRoot}/oauth2/token'
          scopes: {}
  schemas:
    SubscriptionData:
      type: object
      properties:
        amfStatusUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        guamis:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Guami'
      required:
        - amfStatusUri
    AmfStatusChangeNotification:
      type: object
      properties:
        amfStatusInfo:
          $ref: '#/components/schemas/AmfStatusInfo'
      required:
        - amfStatusInfo
    AmfStatusInfo:
      type: object
      properties:
        guamis:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Guami'
        statusChange:
          $ref: '#/components/schemas/StatusChange'
# TODO: To be fixed. Suggest NfInstanceId
#        targetamfName:
#          $ref: '#/components/schemas/AmfName'
      required:
        - guamis
        - statusChange
    AssignEbi:
      type: object
      properties:
        pduSessionId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/PduSessionId'
        arps:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Arp'
          minItems: 1
        releasedEbiList:
          type: array
          items:
            $ref: '#/components/schemas/EpsBearerId'
          minItems: 0
      required:
        - pduSessionId
    AssignedEbi:
      type: object
      properties:
        pduSessionId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/PduSessionId'
        assignedEbis:
          type: array
          items:
            $ref:
'TS29502_Nsmf_PDUSession.yaml#/components/schemas/EbiArpMapping'
          minItems: 0
        failedArpList:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Arp'
          minItems: 0
        releasedEbiList:
          type: array
          items:
            $ref: '#/components/schemas/EpsBearerId'
          minItems: 0
      required:
        - pduSessionId
        - assignedEbis
    AssignEbiFailed:
      type: object
      properties:
        pduSessionId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/PduSessionId'
        failedArpList:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Arp'
          minItems: 0
      required:
        - pduSessionId
    UEContextRelease:
      type: object
      properties:
        supi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'
        unauthenticatedSupi:
          type: boolean
          default: false
        ngapCause:
          $ref: '#/components/schemas/NgApCause'
      required:
        - ngapCause
    N2InformationTransferReqData:
      type: object
      properties:
        tai:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Tai'
        ecgi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ecgi'
        ncgi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ncgi'
        globalRanNodeId:
          type: array
          items:
            $ref: '#/components/schemas/GlobalRanNodeId'
        n2Information:
          $ref: '#/components/schemas/N2InfoContainer'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - n2Information
    NonUeN2InfoSubscriptionCreateData:
      type: object
      properties:
        globalRanNodeId:
          type: array
          items:
            $ref: '#/components/schemas/GlobalRanNodeId'
        anType:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
        n2InformationClass:
          $ref: '#/components/schemas/N2InformationClass'
        n2NotifyCallbackUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        lmfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - n2InformationClass
        - n2NotifyCallbackUri
    NonUeN2InfoSubscriptionCreatedData:
      type: object
      properties:
        n2NotifySubscriptionId:
          type: string
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - n2NotifySubscriptionId
    UeN1N2InfoSubscriptionCreateData:
      type: object
      properties:
        n2InformationClass:
          $ref: '#/components/schemas/N2InformationClass'
        n2NotifyCallbackUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        n1MessageClass:
          $ref: '#/components/schemas/N1MessageClass'
        n1NotifyCallbackUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        lmfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
    UeN1N2InfoSubscriptionCreatedData:
      type: object
      properties:
        n1n2NotifySubscriptionId:
          type: string
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - n1n2NotifySubscriptionId
    N2InformationNotification:
      type: object
      properties:
        n2NotifySubscriptionId:
          type: string
        n2InfoContainer:
          $ref: '#/components/schemas/N2InfoContainer'
        lcsCorrelationId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/CorrelationID'
      required:
        - n2NotifySubscriptionId
        - n2InfoContainer
    N2InfoContainer:
      type: object
      properties:
        n2InformationClass:
          $ref: '#/components/schemas/N2InformationClass'
        smInfo:
          type: array
          items:
            $ref: '#/components/schemas/N2SmInformation'
          minItems: 0
        nrppaInfo:
          $ref: '#/components/schemas/NrppaInformation'
        pwsInfo:
          $ref: '#/components/schemas/PwsInformation'
        areaOfValidity:
          $ref: '#/components/schemas/AreaOfValidity'
      required:
        - n2InformationClass
    N1MessageNotification:
      type: object
      properties:
        n1NotifySubscriptionId:
          type: string
        n1MessageContainer:
          $ref: '#/components/schemas/N1MessageContainer'
        lcsCorrelationId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/CorrelationID'
        registrationCtxtContainer:
          $ref: '#/components/schemas/RegistrationContextContainer'
      required:
        - n1NotifySubscriptionId
        - n1MessageContainer
    N1MessageContainer:
      type: object
      properties:
        n1MessageClass:
          $ref: '#/components/schemas/N1MessageClass'
        n1MessageContent:
          $ref: '#/components/schemas/RefToBinaryData'
        lmfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
      required:
        - n1MessageClass
        - n1MessageContent
    N1N2MessageData:
      type: object
      properties:
        n1MessageContainer:
          $ref: '#/components/schemas/N1MessageContainer'
        n2InfoContainer:
          $ref: '#/components/schemas/N2InfoContainer'
        lastMsgIndication:
          type: boolean
        sessionId:
          type: string
        anType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
        ppi:
          $ref: '#/components/schemas/Ppi'
        arp:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Arp'
        5qi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/5qi'
        n1n2FailureTxfNotifURI:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
    N1N2MessageTransferRspData:
      type: object
      properties:
        cause:
          $ref: '#/components/schemas/N1N2MessageTransferCause'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - cause
    RegistrationContextContainer:
      type: object
      properties:
        ueContext:
          $ref: '#/components/schemas/UeContext'
        localTimeZone:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/TimeZone'
        anType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
        anN2IPv4Address:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv4Addr'
        anN2IPv6Addr:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ipv6Addr'
        allowedNssai:
          $ref:
'TS29531_Nnssf_NSSelection.yaml#/components/schemas/AllowedNssai'
      required:
        - ueContext
        - anType
    AreaOfValidity:
      type: object
      properties:
        taList:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Tai'
      required:
        - taList
    RefToBinaryData:
      type: object
      properties:
        contentId:
          type: string
      required:
        - contentId
    UeContextTransferReqData:
      type: object
      properties:
        reason:
          $ref: '#/components/schemas/TransferReason'
        regRequest:
          $ref: '#/components/schemas/N1MessageContainer'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - reason
    UeContextTransferRspData:
      type: object
      properties:
        ueContext:
          $ref: '#/components/schemas/UeContext'
        regCompleteNotifyUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - ueContext
        - regCompleteNotifyUri
    UeContext:
      type: object
      properties:
        supi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'
        supiUnauthInd:
          type: boolean
        gpsi:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Gpsi'
          minItems: 0
        pei:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Pei'
        groups:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/GroupId'
          minItems: 0
        drxParameter:
          $ref: '#/components/schemas/DrxParameter'
        subRfsp:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/RfspIndex'
        usedRfsp:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/RfspIndex'
        smsSupport:
          $ref: '#/components/schemas/SmsSupport'
        smsfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        seafData:
          $ref: '#/components/schemas/SeafData'
        pcfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        hpcfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        eventSubscriptions:
          type: array
          items:
            $ref:
'TS29518_Namf_EventExposure.yaml#/components/schemas/AmfEventSubscription'
          minItems: 0
        mmContexts:
          type: array
          items:
            $ref: '#/components/schemas/MmContext'
          minItems: 0
          maxItems: 2
        sessionContexts:
          type: array
          items:
            $ref: '#/components/schemas/PduSessionContext'
          minItems: 0
      required:
        - smsSupport
    N2SmInformation:
      type: object
      properties:
        pduSessionId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/PduSessionId'
        n2InfoContent:
          $ref: '#/components/schemas/N2InfoContent'
        nasPdu:
          $ref: '#/components/schemas/N1MessageContainer'
        sNssai:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'
        subjectToHo:
          type: boolean
      required:
        - pduSessionId
    N2InfoContent:
      type: object
      properties:
        ngapMessageType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
        ngapIeType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
        ngapData:
          $ref: '#/components/schemas/RefToBinaryData'
      required:
        - ngapIeType
        - ngapData
    NrppaInformation:
      type: object
      properties:
        lmfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        nrppaPdu:
          $ref: '#/components/schemas/N2InfoContent'
      required:
        - routingId
        - nrppaPdu
    PwsInformation:
      type: object
      properties:
        messageIdentifier:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uint16'
        serialNumber:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uint16'
        pwsContainer:
          $ref: '#/components/schemas/N2InfoContent'
        sendN2Container:
          type: boolean
        omcId:
          $ref: '#/components/schemas/OmcIdentifier'
      required:
        - messageIdentifier
        - serialNumber
        - pwsContainer
    N1N2MsgTxfrFailureNotification:
      type: object
      properties:
        cause:
          $ref: '#/components/schemas/N1N2MessageTransferCause'
        n1n2MsgDataUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
      required:
        - cause
        - n1n2MsgDataUri
    N1N2MessageTransferError:
      type: object
      properties:
        error:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        errInfo:
          $ref: '#/components/schemas/N1N2MsgTxfrErrDetail'
      required:
        - error
    N1N2MsgTxfrErrDetail:
      type: object
      properties:
        retryAfter:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
        highestPrioArp:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Arp'
    N2InformationTransferRspData:
      type: object
      properties:
        result:
          $ref: '#/components/schemas/N2InformationTransferResult'
        pwsRspData:
          $ref: '#/components/schemas/PWSResponseData'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - result
    MmContext:
      type: object
      properties:
        accessType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
        nasSecurityMode:
          $ref: '#/components/schemas/NasSecurityMode'
        nasDownlinkCount:
          $ref: '#/components/schemas/NasCount'
        nasUplinkCount:
          $ref: '#/components/schemas/NasCount'
        5gmmCapability:
          $ref: '#/components/schemas/5gmmCapability'
        mobilityRestrictions:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/MobilityRestrictions'
        ueSecurityCapability:
          $ref: '#/components/schemas/UeSecurityCapability'
        s1UeNetworkCapability:
          $ref: '#/components/schemas/S1UeNetworkCapability'
        allowedNssai:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'
          minItems: 0
        nssaiMapping:
          type: array
          items:
            $ref: '#/components/schemas/NssaiMapping'
          minItems: 0
        nsInstances:
          type: array
          items:
            $ref:
'TS29531_Nnssf_NSSelection.yaml#/components/schemas/NsiId'
          minItems: 0
      required:
        - accessType
    SeafData:
      type: object
      properties:
        ngKsi:
          $ref: '#/components/schemas/NgKsi'
        nh:
          type: string
        ncc:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
        keyAmf:
          $ref: '#/components/schemas/KeyAmf'
        keyAmfChangeInd:
          type: boolean
# TODO: To be defined
#        Input:
#          $ref: '#/components/schemas/Input'
      required:
        - ngKsi
        - nh
        - ncc
        - keyAmf
    NasSecurityMode:
      type: object
      properties:
        integrityAlgorithm:
          $ref: '#/components/schemas/IntegrityAlgorithm'
        cipheringAlgorithm:
          $ref: '#/components/schemas/CipheringAlgorithm'
      required:
        - integrityAlgorithm
        - cipheringAlgorithm
    PduSessionContext:
      type: object
      properties:
        pduSessionId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/PduSessionId'
        smContextRef:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        sNssai:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'
        dnn:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Dnn'
        accessType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
        allocatedEbiList:
          type: array
          items:
            $ref:
'TS29502_Nsmf_PDUSession.yaml#/components/schemas/EbiArpMapping'
          minItems: 1
        hsmfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        vsmfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        nsInstance:
          $ref: 'TS29531_Nnssf_NSSelection.yaml#/components/schemas/NsiId'
      required:
        - pduSessionId
        - smContextRef
        - sNssai
        - dnn
        - accessType
        - allocatedEbiList
    NssaiMapping:
      type: object
      properties:
        mappedSnssai:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'
        hSnssai:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'
      required:
        - mappedSnssai
        - hSnssai
    UERegCompleteNotifData:
      type: object
      properties:
        transferStatus:
          $ref: '#/components/schemas/UeContextTransferStatus'
      required:
        - transferStatus
    AssignEbiError:
      type: object
      properties:
        error:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        failureDetails:
          $ref: '#/components/schemas/AssignEbiFailed'
      required:
        - error
        - failureDetails
    UeContextCreateData:
      type: object
      properties:
        ueContext:
          $ref: '#/components/schemas/UeContext'
        targetId:
          $ref: '#/components/schemas/NgRanTargetId'
        sourceToTargetData:
          $ref: '#/components/schemas/N2InfoContainer'
        pduSessions:
          $ref: '#/components/schemas/N2SmInformation'
        ngapCause:
          $ref: '#/components/schemas/NgApCause'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - ueContext
        - targetId
        - sourceToTargetData
        - pduSessions
    UeContextCreatedData:
      type: object
      properties:
        ueContext:
          $ref: '#/components/schemas/UeContext'
        targetToSourceData:
          $ref: '#/components/schemas/N2InfoContainer'
        pduSessions:
          type: array
          items:
            $ref: '#/components/schemas/N2SmInformation'
          minItems: 1
        ngapCause:
          $ref: '#/components/schemas/NgApCause'
        failedSessions:
          type: array
          items:
            $ref:
'TS29571_CommonData.yaml#/components/schemas/PduSessionId'
          minItems: 0
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - ueContext
        - targetToSourceData
        - pduSessions
    UeContextCreateError:
      type: object
      properties:
        error:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        ngapCause:
          $ref: '#/components/schemas/NgApCause'
      required:
        - error
    NgRanTargetId:
      type: object
      properties:
        ranNodeId:
          $ref: '#/components/schemas/NgRanIdentifier'
        tai:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Tai'
      required:
        - plmnId
        - ranNodeId
        - tai
    PWSResponseData:
      type: object
      properties:
        ngapMessageType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
        serialNumber:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uint16'
        messageIdentifier:
          type: integer
        unknownTaiList:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Tai'
      required:
        - ngapMessageType
        - serialNumber
        - messageIdentifier
    PWSErrorData:
      type: object
      properties:
        namfCause:
          type: integer
      required:
        - namfCause
    N2InformationTransferError:
      type: object
      properties:
        error:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        pwdErrorInfo:
          $ref: '#/components/schemas/PWSErrorData'
      required:
        - error
    GlobalRanNodeId:
      type: object
      properties:
        plmnId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnId'
        n3IwfId:
          type: string
        ngRanNodeId:
          $ref: '#/components/schemas/NgRanIdentifier'
      required:
        - plmnId
    NgKsi:
      type: object
      properties:
        tsc:
          $ref: '#/components/schemas/ScType'
        ksi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
      required:
        - tsc
        - ksi
    KeyAmf:
      type: object
      properties:
        keyType:
          $ref: '#/components/schemas/KeyAmfType'
        keyVal:
          type: string
      required:
        - keyType
        - keyVal
    EpsBearerId:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
    NgApCause:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
    NgRanIdentifier:
      type: string
      pattern: 'gNB-[A-Fa-f0-9]{6,8}|Macro-[A-Fa-f0-9]{5}|LMacro-[A-Fa-f0-
9]{6}|SMacro-[A-Fa-f0-9]{5}'
    Ppi:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
    NasCount:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Uinteger'
    5gmmCapability:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'
    UeSecurityCapability:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'
    S1UeNetworkCapability:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'
    DrxParameter:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'
    OmcIdentifier:
      type: string
    StatusChange:
      anyOf:
      - type: string
        enum:
          - "AMF_UNAVAILABLE"
          - "AMF_AVAILABLE"
      - type: string
    N2InformationClass:
      anyOf:
      - type: string
        enum:
          - "SM"
          - "NRPPa"
          - "PWS"
          - "PWS-BCAL"
          - "PWS-RF"
      - type: string
    N1MessageClass:
      anyOf:
      - type: string
        enum:
          - "5GMM"
          - "SM"
          - "LPP"
          - "SMS"
      - type: string
    N1N2MessageTransferCause:
      anyOf:
      - type: string
        enum:
          - "ATTEMPTING_TO_REACH_UE"
          - "N1_N2_TRANSFER_INITIATED"
          - "WAITING_FOR_ASYNCHRONOUS_TRANSFER"
      - type: string
    UeContextTransferStatus:
      anyOf:
      - type: string
        enum:
          - "TRANSFERRED"
          - "NOT_TRANSFERRED"
      - type: string
    N2InformationTransferResult:
      anyOf:
      - type: string
        enum:
          - "N2_INFO_TRANSFER_INITIATED"
      - type: string
    CipheringAlgorithm:
      anyOf:
      - type: string
        enum:
          - "NEA0"
          - "NEA1"
          - "NEA2"
          - "NEA3"
      - type: string
    IntegrityAlgorithm:
      anyOf:
      - type: string
        enum:
          - "NIA0"
          - "NIA1"
          - "NIA2"
          - "NIA3"
      - type: string
    SmsSupport:
      anyOf:
      - type: string
        enum:
          - "3GPP"
          - "NON_3GPP"
          - "BOTH"
          - "NONE"
      - type: string
    ScType:
      anyOf:
      - type: string
        enum:
          - "NATIVE"
          - "MAPPED"
      - type: string
    KeyAmfType:
      anyOf:
      - type: string
        enum:
          - "KAMF"
          - "KPRIMEAMF"
      - type: string
    TransferReason:
      anyOf:
      - type: string
        enum:
          - "INIT_REG"
          - "MOBI_REG"
          - "MOBI_REG_UE_VALIDATED"
      - type: string

A.3  Namf_EventExposure API

openapi: 3.0.0
info:
  version: 1.R15.0.0
  title: Namf_EventExposure Service
  description: AMF Event Exposure Service
security:
  - oAuth2Clientcredentials: []
externalDocs:
  description: Documentation
  url: 'http://www.3gpp.org/ftp/Specs/archive/29_series/29.518/29518-
120.zip'
servers:
  - url: https://{apiRoot}/namf-evts/v1
    variables:
      apiRoot:
        default: locahhost:8080
paths:
  /subscriptions:
    post:
      summary: Namf_EventExposure Subscribe service Operation
      tags:
        - Create Subscription
      operationId: CreateSubscription
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AmfCreateEventSubscription'
        required: true
      responses:
        '201':
          description: Subsription Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AmfCreatedEventSubscription'
        '403':
          description: Forbidden
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        default:
          description: Unexpected error
      callbacks:
        onEventReport:
          {$request.body#/subscription/notifyUri}:
            post:
              summary: Event Notificaiton Delivery
              requestBody:
                content:
                  application/json:
                    schema:
                      $ref: '#/components/schemas/AmfEventNotification'
                required: true
              responses:
                '204':
                  description: Successful acknowledgement
                default:
                  description: Unexpected error
  /subscriptions/{subscriptionId}:
    patch:
      summary: Namf_EventExposure Subscribe Modify service Operation
      tags:
        - Modify Subscription
      operationId: ModifySubscription
      parameters:
        - name: subscriptionId
          in: path
          required: true
          description: Unique ID of the subscription to be modified
          schema:
            type: string
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/AmfUpdateEventSubscriptionItem'
        required: true
      responses:
        '200':
          description: Subsription modified successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AmfUpdatedEventSubscription'
        '403':
          description: Forbidden
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        '404':
          description: Not Found
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        default:
          description: Unexpected error
    delete:
      summary: Namf_EventExposure Unsubscribe service Operation
      tags:
        - Delete Subscription
      operationId: DeleteSubscription
      parameters:
        - name: subscriptionId
          in: path
          required: true
          description: Unique ID of the subscription to be deleted
          schema:
            type: string
      responses:
        '200':
          description: Subsription deleted successfully
        '404':
          $ref: 'TS29571_CommonData.yaml#/components/responses/404'
        default:
          description: Unexpected error
components:
  securitySchemes:
    oAuth2ClientCredentials:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: '{nrfApiRoot}/oauth2/token'
          scopes: {}
  schemas:
    AmfEventSubscription:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: '#/components/schemas/AmfEvent'
        eventNotifyUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        notifyCorrelationId:
          type: string
        nfId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        subsChangeNotifyUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        supi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'
        groupId:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/GroupId'
        gpsi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Gpsi'
        pei:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Pei'
        anyUE:
          type: boolean
      required:
        - events
        - eventNotifyUri
        - notifyCorrelationId
        - nfId
    AmfEvent:
      type: object
      properties:
        type:
          $ref: '#/components/schemas/AmfEventType'
        options:
          $ref: '#/components/schemas/AmfEventMode'
        immediateFlag:
          type: boolean
        area:
          type: array
          items:
            $ref: '#/components/schemas/AmfEventArea'
          minItems: 0
        locationFilters:
          $ref: '#/components/schemas/LocationFilter'
        subscribedDataFilters:
          $ref: '#/components/schemas/SubscribedDataFilter'
      required:
        - type
        - options
    AmfEventNotification:
      type: object
      properties:
        subscriptionId:
          type: string
        notifCorelationId:
          type: string
        reports:
          type: array
          items:
            $ref: '#/components/schemas/AmfEventReport'
          minItems: 1
      required:
        - subscriptionId
        - notifCorelationId
    AmfEventReport:
      type: object
      properties:
        type:
          $ref: '#/components/schemas/AmfEventType'
        state:
          $ref: '#/components/schemas/AmfEventState'
        anyUe:
          type: boolean
        supi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'
        area:
          type: array
          items:
            $ref: '#/components/schemas/AmfEventArea'
        gpsi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Gpsi'
        pei:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Pei'
        location:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/UserLocation'
        timezone:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/TimeZone'
        accessTypes:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
        rmInfos:
          $ref: '#/components/schemas/RmInfo'
        cmInfos:
          $ref: '#/components/schemas/CmInfo'
        reachability:
          $ref: '#/components/schemas/UeReachability'
        subscribedData:
          $ref: '#/components/schemas/SubscribedData'
        commFailure:
          $ref: '#/components/schemas/CommunicationFailure'
        numberOfUes:
          type: integer
      required:
        - type
        - state
    AmfEventMode:
      type: object
      properties:
        trigger:
          $ref: '#/components/schemas/AmfEventTrigger'
        maxReports:
          type: integer
        duration:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSec'
      required:
        - trigger
    AmfEventState:
      type: object
      properties:
        active:
          type: boolean
        remainReports:
          type: integer
        remainDuration:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/DurationSec'
      required:
        - active
    RmInfo:
      type: object
      properties:
        rmState:
          $ref: '#/components/schemas/RmState'
        accessType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
      required:
        - rmState
        - accessType
    CmInfo:
      type: object
      properties:
        cmState:
          $ref: '#/components/schemas/CmState'
        accessType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/AccessType'
      required:
        - cmState
        - accessType
    SubscribedData:
      type: object
      properties:
        sari:
          $ref: '#/components/schemas/Sari'
        rfspIndex:
          $ref: '#/components/schemas/RfspIndex'
    CommunicationFailure:
      type: object
      properties:
        nasReleaseCode:
          type: string
        ranReleaseCode:
          $ref:
'TS29518_Namf_Communication.yaml#/components/schemas/NgApCause'
    AmfCreateEventSubscription:
      type: object
      properties:
        subscription:
          $ref: '#/components/schemas/AmfEventSubscription'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - subscription
    AmfCreatedEventSubscription:
      type: object
      properties:
        subscription:
          $ref: '#/components/schemas/AmfEventSubscription'
        reports:
          $ref: '#/components/schemas/AmfEventReport'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - subscription
    AmfUpdateEventSubscriptionItem:
      type: array
      items:
        type: object
        properties:
          op:
            type: string
            enum:
              - add
              - remove
              - replace
          path:
            type: string
            pattern: '\/events\/[0-]$|\/events\/[1-9][0-9]*$'
          value:
            $ref: '#/components/schemas/AmfEvent'
        required:
          - op
          - path
      minItems: 1
    AmfUpdatedEventSubscription:
      type: object
      properties:
        subscription:
          $ref: '#/components/schemas/AmfEventSubscription'
      required:
        - subscription
    AmfEventArea:
      type: object
      properties:
        presence:
          $ref: '#/components/schemas/PresenceState'
        trackingAreas:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Tai'
        areaId:
          type: string
        ladn:
          type: string
        ecgi:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Ecgi'
          minItems: 0
        ncgi:
          type: array
          items:
            $ref: 'TS29571_CommonData.yaml#/components/schemas/Ncgi'
          minItems: 0
        globalRanNodeId:
          type: array
          items:
            $ref:
'TS29518_Namf_Communication.yaml#/components/schemas/GlobalRanNodeId'
    5gGuti:
      type: string
    Sari:
      $ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'
    RfspIndex:
      type: integer
    AmfEventType:
      anyOf:
      - type: string
        enum:
          - "LOCATION_REPORT"
          - "PRESENCE_IN_AOI_REPORT"
          - "TIMEZONE_REPORT"
          - "ACCESS_TYPE_REPORT"
          - "REGISTRATION_STATE_REPORT"
          - "CONNECTIVITY_STATE_REPORT"
          - "REACHABILITY_REPORT"
          - "SUBSCRIBED_DATA_REPORT"
          - "COMMIUNICATION_FAILURE_REPORT"
          - "UES_IN_AREA_REPORT"
      - type: string
    AmfEventTrigger:
      anyOf:
      - type: string
        enum:
          - "ONE_TIME"
          - "CONTINUOUS"
      - type: string
    LocationFilter :
      anyOf:
      - type: string
        enum:
          - "TAI"
          - "CELL_ID"
          - "N3IWF"
          - "UE_IP"
          - "UDP_PORT"
      - type: string
    SubscribedDataFilter:
      anyOf:
      - type: string
        enum:
          - "SARI"
          - "RFSP_INDEX"
      - type: string
    UeReachability:
      anyOf:
      - type: string
        enum:
          - "UNREACHABLE"
          - "REACHABLE"
          - "REGULATORY_ONLY"
      - type: string
    PresenceState:
      anyOf:
      - type: string
        enum:
          - "IN"
          - "OUT"
          - "UNKNOWN"
      - type: string
    RmState:
      anyOf:
      - type: string
        enum:
          - "REGISTERED"
          - "DEREGISTERED"
      - type: string
    CmState:
      anyOf:
      - type: string
        enum:
          - "IDLE"
          - "CONNECTED"
      - type: string

A.4  Namf_MT

openapi: 3.0.0
info:
  version: 1.R15.0.0
  title: AMF MT Service
  description: AMF Mobile Termination Service
security:
  - oAuth2Clientcredentials: []
externalDocs:
  description: Documentation
  url: 'http://www.3gpp.org/ftp/Specs/archive/29_series/29.518/29518-
120.zip'
servers:
  - url: https://{apiRoot}/namf-mt/v1
    variables:
      apiRoot:
        default: locahhost:8080
paths:
  '/ue-contexts/{ueContextId}':
    get:
      summary: Namf_MT Provide Domain Selection Info service Operation
      tags:
        - Provide Domain Selection Info
      operationId: Provide Domain Selection Info
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
        - name: info-class
          in: query
          description: UE Context Information Class
          schema:
            $ref: '#/components/schemas/UeContextInfoClass'
        - name: supported-features
          in: query
          description: Supported Features
          schema:
            $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      responses:
        '200':
          description: Requested UE Context Information returned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UeContextInfo'
        '307':
          description: Temporary Redirect
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        '403':
          $ref: 'TS29571_CommonData.yaml#/components/responses/403'
        '404':
          $ref: 'TS29571_CommonData.yaml#/components/responses/404'
        default:
          description: Unexpected error
  /ue-contexts/{ueContextId}/ue-reachind:
    post:
      summary: Namf_MT EnableUEReachability service Operation
      tags:
        - Enable UE Reachability
      operationId: EnableUeReachability
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnableUeReachabilityReqData'
        required: true
      responses:
        '200':
          description: UE has become reachable as desired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnableUeReachabilityRspData'
        '307':
          description: Temporary Redirect
          content:
            application/problem+json:
              schema:
                $ref:
'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'
        '400':
          $ref: 'TS29571_CommonData.yaml#/components/responses/400'
        '403':
          $ref: 'TS29571_CommonData.yaml#/components/responses/403'
        '404':
          $ref: 'TS29571_CommonData.yaml#/components/responses/404'
        '500':
          $ref: 'TS29571_CommonData.yaml#/components/responses/500'
        '503':
          $ref: 'TS29571_CommonData.yaml#/components/responses/503'
        '504':
          $ref: 'TS29571_CommonData.yaml#/components/responses/504'
        default:
          description: Unexpected error
components:
  securitySchemes:
    oAuth2ClientCredentials:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: '{nrfApiRoot}/oauth2/token'
          scopes: {}
  schemas:
    EnableUeReachabilityReqData:
      type: object
      properties:
        reachability:
          $ref:
'TS29518_Namf_EventExposure.yaml#/components/schemas/UeReachability'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - reachability
    EnableUeReachabilityRspData:
      type: object
      properties:
        reachability:
          $ref:
'TS29518_Namf_EventExposure.yaml#/components/schemas/UeReachability'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - reachability
    UeContextInfo:
      type: object
      properties:
        supportVoPS:
          type: boolean
        lastActTime:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/DateTime'
        ratType:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/RatType'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
    UeContextInfoClass:
      anyOf:
      - type: string
        enum:
          - "TADS"
      - type: string

A.5  Namf_Location

openapi: 3.0.0
info:
  version: 1.R15.0.0
  title: AMF Location Service
  description: AMF Location Service
security:
  - oAuth2Clientcredentials: []
externalDocs:
  description: Documentation
  url: 'http://www.3gpp.org/ftp/Specs/archive/29_series/29.518/29518-
120.zip'
servers:
  - url: https://{apiRoot}/namf-loc/v1
    variables:
      apiRoot:
        default: locahhost:8080
paths:
  /{ueContextId}/provide:
    post:
      summary: Namf_Location ProvideLocation service Operation
      tags:
        - Provide Location
      operationId: ProvideLocation
      parameters:
        - name: ueContextId
          in: path
          description: UE Context Identifier
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestUELocation'
        required: true
      responses:
        '200':
          description: Expected response to a valid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProvideUELocation'
        '403':
          $ref: 'TS29571_CommonData.yaml#/components/responses/403'
        '500':
          $ref: 'TS29571_CommonData.yaml#/components/responses/500'
        '503':
          $ref: 'TS29571_CommonData.yaml#/components/responses/503'
        '504':
          $ref: 'TS29571_CommonData.yaml#/components/responses/504'
        default:
          description: Unexpected error
      callbacks:
        onUELocationNotification:
          {$request.body#/locationNotificationUri}:
            post:
              requestBody:
                description: UE Location Event Notification
                content:
                  application/json:
                    schema:
                      $ref: '#/components/schemas/NotifiedUELocation'
              responses:
                '204':
                  description: Expected response to a successful callback
processing
                '403':
                  $ref: 'TS29571_CommonData.yaml#/components/responses/504'
components:
  securitySchemes:
    oAuth2ClientCredentials:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: '{nrfApiRoot}/oauth2/token'
          scopes: {}
  schemas:
    RequestUELocation:
      type: object
      properties:
        lcsClientType:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/ExternalClientType'
        lcsLocation:
          $ref: '#/components/schemas/LocationType'
        supi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'
        gpsi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Gpsi'
        priority:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/LcsPriority'
        lcsQoS:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/LocationQoS'
        velocityRequested:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/VelocityRequested'
        lcsSupportedGADShapes:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/SupportedGADShapes'
        locationNotificationUri:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Uri'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
      required:
        - lcsClientType
        - lcsLocation
    ProvideUELocation:
      type: object
      properties:
        locationEstimate:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/GeographicArea'
        accuracyFulfilmentIndicator:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/AccuracyFulfilmentIndicator'

        ageOfLocationEstimate:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/AgeOfLocationEstimate'
        velocityEstimate:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/VelocityEstimate'
        positioningData:
          type: array
          items:
            $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/PositioningMethodAndUsage'
          minItems: 0
          maxItems: 9
        gnssPositioningData:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/GnssPositioningMethodAndUsag
e'
        ecgi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ecgi'
        ncgi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ncgi'
        targetServingNode:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        civicAddress:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/CivicAddress'
        barometricPressure:
          $ref: '#/components/schemas/BarometricPressure'
        supportedFeatures:
          $ref:
'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'
    NotifiedUELocation:
      type: object
      properties:
        locationEvent:
          $ref: '#/components/schemas/LocationEvent'
        supi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'
        gpsi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Gpsi'
        pei:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Pei'
        locationEstimate:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/GeographicArea'
        ageOfLocationEstimate:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/AgeOfLocationEstimate'
        velocityEstimate:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/VelocityEstimate'
        positioningData:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/PositioningMethodAndUsage'
        gnssPositioningData:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/GnssPositioningMethodAndUsag
e'
        ecgi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ecgi'
        ncgi:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/Ncgi'
        servingNode:
          $ref: 'TS29571_CommonData.yaml#/components/schemas/NfInstanceId'
        civicAddress:
          $ref:
'TS29572_Nlmf_Location.yaml#/components/schemas/CivicAddress'
        barometricPressure:
          $ref: '#/components/schemas/BarometricPressure'
      required:
        - locationEvent
    BarometricPressure:
      type: integer
    LocationType:
      anyOf:
      - type: string
        enum:
          - CURRENT_LOCATION
          - CURRENT_OR_LAST_KNOWN_LOCATION
          - INITIAL_LOCATION
      - type: string
    LocationEvent:
      anyOf:
      - type: string
        enum:
          - EMERGENCY_CALL_ORIGINATION
          - EMERGENCY_CALL_RELEASE
          - EMERGENCY_CALL_HANDOVER
      - type: string




Annex B (informative): Change history



|Change history                                                            |


 Date |Meeting |TDoc |CR |Rev |Cat |Subject/Comment |New version | |2017-10
 |CT4#80 |C4-175297 | | | |TS Skeleton |0.1.0 | |2017-10 |CT4#80 |C4-175397
  | | | |Implementation of pCRs agreed at CT4#80. |0.2.0 | |2017-12 |CT4#81
|C4-176441 | | | |Implementation of pCRs agreed at CT4#81, including C4-
176285, C4-176290, C4-176291, C4-176292, C4-176293, C4-176375, C4-176376,
  C4-176378, C4-176379, C4-176380 and C4-176404. |0.3.0 | |2018-01 |CT4#82
|C4-181393 | | | |Implementation of pCRs agreed at CT4#82, including C4-
181090, C4-181091, C4-181258, C4-181259, C4-181260, C4-181269, C4-181270,
C4-181311, C4-181312, C4-181313, C4-181314, C4-181352, C4-181353 and C4-
181354 |0.4.0 | |2018-03 |CT4#83 |C4-182437 | | | |Implementation of pCRs
agreed at CT4#83, including C4-182287, C4-182288, C4-182290, C4-182292, C4-
182293, C4-182350, C4-182353, C4-182355, C4-182358, C4-182367, C4-182385,
C4-182403, C4-182414, C4-182415 |0.5.0 | |2018-03 |CT#79 |CP-180033 | | |
|Presented for information |1.0.0 | |2018-04 |CT4#84 |C4-183518 | | |
|Implementation of pCRs agreed at CT4#84, including C4-183048, C4-183054,
C4-183055, C4-183064, C4-183073, C4-183074, C4-183161, C4-183166, C4-
183171, C4-183345, C4-183347, C4-183351, C4-183354, C4-183356, C4-183357,
C4-183359, C4-183360, C4-183361, C4-183362, C4-183406, C4-183407, C4-
183408, C4-183409, C4-183410, C4-183411, C4-183412, C4-183413, C4-183414,
C4-183415, C4-183417, C4-183434, C4-183435, C4-183436, C4-183437, C4-
183439, C4-183445, C4-183460, C4-183461, C4-183462, C4-183463, C4-183464,
  C4-183493, C4-183494, C4-183495, C4-183502 |1.1.0 | |2018-05 |CT4#85 |C4-
184629 | | | |Implementation of pCRs agreed at CT4#85, including:
C4-184390, C4-184391, C4-184562, C4-184393, C4-184561,
C4-184395, C4-194052, C4-184396, C4-184399, C4-184404,
C4-184405, C4-184407, C4-184102, C4-184408, C4-184104,
C4-184410, C4-184412, C4-184413, C4-184569, C4-184563,
C4-184124, C4-184418, C4-184565, C4-184127, C4-184566,
C4-184129, C4-184421, C4-184131, C4-184426, C4-184427,
C4-184428, C4-184429, C4-184430, C4-184431, C4-184432,
C4-184433, C4-184434, C4-184435, C4-184436, C4-184437,
C4-184151, C4-184481, C4-184154, C4-184515, C4-184516,
   C4-184568, C4-184485, C4-184486, C4-184487, C4-184488 |1.2.0 | |2018-06
 |CT#80 |CP-181107 | | | |Presented for approval |2.0.0 | |2018-06 |CT#80 |
| | | |Approved in CT#80 |15.0.0 | |

