
                                            3GPP TS 37.340 V15.2.0 (2018-06)
                                                     Technical Specification
                                         3rd Generation Partnership Project;
                         Technical Specification Group Radio Access Network;
                 Evolved Universal Terrestrial Radio Access (E-UTRA) and NR;
                                                         Multi-connectivity;
                                                                     Stage 2
                                                                (Release 15)
[pic]  [pic]

The present document has been developed within the 3rd Generation
Partnership Project (3GPP TM) and may be further elaborated for the
purposes of 3GPP.
The present document has not been subject to any approval process by the
3GPP Organizational Partners and shall not be implemented.
This Specification is provided for future development work within 3GPP
only. The Organizational Partners accept no liability for any use of this
Specification.
Specifications and Reports for implementation of the 3GPP TM system should
be obtained via the 3GPP Organizational Partners' Publications Offices.











                                    3GPP

                               Postal address



                         3GPP support office address
                  650 Route des Lucioles - Sophia Antipolis
                              Valbonne - FRANCE
               Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16

                                  Internet
                             http://www.3gpp.org


                           Copyright Notification

    No part may be reproduced except as authorized by written permission.
  The copyright and the foregoing restriction extend to reproduction in all
                                   media.

  © 2018, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
                                    TTC).
                            All rights reserved.

UMTS™ is a Trade Mark of ETSI registered for the benefit of its members
3GPP™ is a Trade Mark of ETSI registered for the benefit of its Members and
of the 3GPP Organizational Partners
LTE™ is a Trade Mark of ETSI registered for the benefit of its Members and
of the 3GPP Organizational Partners
GSM® and the GSM logo are registered and owned by the GSM Association

         Contents


Foreword 5

1  Scope 6

2  References 6

3  Definitions, symbols and abbreviations  6
3.1  Definitions  6
3.2  Abbreviations  7

4  Multi-RAT Dual Connectivity  7
4.1  General  7
4.1.1  Common MR-DC principles  7
4.1.2  MR-DC with the EPC  8
4.1.3  MR-DC with the 5GC  8
4.1.3.1  E-UTRA-NR Dual Connectivity  8
4.1.3.2  NR-E-UTRA Dual Connectivity  8
4.2  Radio Protocol Architecture  8
4.2.1  Control Plane   8
4.2.2  User Plane 9
4.3  Network interfaces  11
4.3.1  Control Plane   11
4.3.1.1  Common MR-DC principles  11
4.3.1.2  MR-DC with EPC  12
4.3.1.3  MR-DC with 5GC  12
4.3.2  User Plane 12
4.3.2.1  Common MR-DC principles  12
4.3.2.2  MR-DC with EPC  13
4.3.2.3  MR-DC with 5GC  13

5  Layer 1 related aspects 13

6  Layer 2 related aspects 13
6.1  MAC Sublayer 13
6.2  RLC Sublayer 14
6.3  PDCP Sublayer  14
6.4  SDAP Sublayer  14

7  RRC related aspects 14
7.1  System information handling  14
7.2  Measurements 14
7.3  UE capability coordination 15
7.4  Handling of combined MN/SN RRC messages 15
7.5  SRB3   15
7.6  Split SRB  16
7.7  SCG/MCG failure handling   16
7.8  UE identities  16
7.9  Inter-node Resource Coordination 17

8  Bearer handling aspects 17
8.1  QoS aspects  17
8.2  Bearer type selection 18
8.3  Bearer type change  18
8.4  User data forwarding  19

9  Security related aspects  19

10 Multi-Connectivity operation related aspects  19
10.1 General  19
10.2 Secondary Node Addition 19
10.2.1 EN-DC  19
10.2.2 MR-DC with 5GC  21
10.3 Secondary Node Modification (MN/SN initiated)  23
10.3.1 EN-DC  23
10.3.2 MR-DC with 5GC  27
10.4 Secondary Node Release (MN/SN initiated)  30
10.4.1 EN-DC  30
10.4.2 MR-DC with 5GC  32
10.5 Secondary Node Change (MN/SN initiated) 33
10.5.1 EN-DC  33
10.5.2 MR-DC with 5GC  36
10.6 PSCell change  38
10.7 Inter-Master Node handover with/without Secondary Node change 39
10.7.1 EN-DC  39
10.7.2 MR-DC with 5GC  40
10.8 Master Node to eNB/gNB Change  42
10.8.1 EN-DC  42
10.8.2 MR-DC with 5GC  43
10.9 eNB/gNB to Master Node change  44
10.9.1 EN-DC  44
10.9.2 MR-DC with 5GC  45
10.10  RRC Transfer 47
10.10.1  EN-DC  47
10.10.2  MR-DC with 5GC  48
10.11  Secondary RAT data volume reporting 49
10.11.1  EN-DC  49
10.12  Activity Notification 50
10.12.1  EN-DC  50

11 Service related aspects 51
11.1 Roaming and Access Restrictions  51

12 X2/Xn Interface related aspects  51

Annex A (informative): Layer 2 handling for bearer type change 52

Annex B (informative): Change history 53




         Foreword

This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).

The contents of the present document are subject to continuing work within
the TSG and may change following formal TSG approval. Should the TSG modify
the contents of the present document, it will be re-released by the TSG
with an identifying change of release date and an increase in version
number as follows:

  Version x.y.z

  where:

    x  the first digit:

       1  presented to TSG for information;

       2  presented to TSG for approval;

       3  or greater indicates TSG approved document under change control.

    Y  the second digit is incremented for all changes of substance, i.e.
       technical enhancements, corrections, updates, etc.

    Z  the third digit is incremented when editorial only changes have been
       incorporated in the document.



         1  Scope

The present document provides an overview of the multi-connectivity
operation using E-UTRA and NR radio access technologies. Details of the
network and radio interface protocols are specified in companion
specifications of the 36 and 38 series.


2  References

The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.

  -  References are either specific (identified by date of publication,
    edition number, version number, etc.) or non-specific.

  -  For a specific reference, subsequent revisions do not apply.

  -  For a non-specific reference, the latest version applies. In the case
    of a reference to a 3GPP document (including a GSM document), a non-
    specific reference implicitly refers to the latest version of that
    document in the same Release as the present document.

  [1]  3GPP TR 21.905: "Vocabulary for 3GPP Specifications".

  [2]  3GPP TS 36.300: "Evolved Universal Terrestrial Radio Access (E-UTRA)
             and Evolved Universal Terrestrial Radio Access Network (E-
             UTRAN); Overall description; Stage 2".

  [3]  3GPP TS 38.300: "NR; NR and NG-RAN Overall description; Stage 2".

  [4]  3GPP TS 38.331: "NR; Radio Resource Control (RRC) protocol
             specification".

  [5]  3GPP TS 38.423: "NG-RAN; Xn application protocol (XnAP)".

  [6]  3GPP TS 38.425: "NG-RAN; NR user plane protocol".

  [7]  3GPP TS 38.401: "NG-RAN; Architecture description".


3  Definitions, symbols and abbreviations


3.1  Definitions

For the purposes of the present document, the terms and definitions given
in 3GPP TR 21.905 [1] and the following apply. A term defined in the
present document takes precedence over the definition of the same term, if
any, in 3GPP TR 21.905 [1] and 3GPP TS 36.300 [2].

En-gNB:  node providing NR user plane and control plane protocol
terminations towards the UE, and acting as Secondary Node in EN-DC.

Master Cell Group:  in MR-DC, a group of serving cells associated with the
Master Node, comprising of the SpCell (Pcell) and optionally one or more
Scells.

Master node: A Master eNB (in EN-DC), Master ng-eNB (in NGEN-DC) or a
Master gNB (in NE-DC).

MCG bearer: in MR-DC, a radio bearer with an RLC bearer only in the MCG.

MN terminated bearer: in MR-DC, a radio bearer for which PDCP is located in
the MN.

MCG SRB: in MR-DC, a direct SRB between the MN and the UE.

Multi-RAT Dual Connectivity: Dual Connectivity between E-UTRA and NR nodes.

Ng-eNB: as defined in TS 38.300 [3].

PCell: SpCell of a master cell group.

PSCell: SpCell of a secondary cell group.

RLC bearer: RLC and MAC logical channel configuration of a radio bearer in
one cell group.

Secondary Cell Group: in MR-DC, a group of serving cells associated with
the Secondary Node, comprising of the SpCell (PSCell) and optionally one or
more Scells.

Secondary node: An en-gNB (in EN-DC), Secondary ng-eNB (in NE-DC) or a
Secondary gNB (in NGEN-DC).

SCG bearer: in MR-DC, a radio bearer with an RLC bearer only in the SCG.

SN terminated bearer: in MR-DC, a radio bearer for which PDCP is located in
the SN.

SpCell: primary cell of a master or secondary cell group.

SRB3: in EN-DC and NGEN-DC, a direct SRB between the SN and the UE.

Split bearer: in MR-DC, a radio bearer with RLC bearers both in MCG and
SCG.

Split SRB: in MR-DC, a SRB between the MN and the UE with RLC bearers both
in MCG and SCG.


3.2  Abbreviations

For the purposes of the present document, the abbreviations given in 3GPP
TR 21.905 [1] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in 3GPP TR 21.905 [1] and 3GPP TS 36.300 [2].

  DC Intra-E-UTRA Dual Connectivity
  EN-DC  E-UTRA-NR Dual Connectivity
  MCG  Master Cell Group
  MN Master Node
  MR-DC  Multi-RAT Dual Connectivity
  NE-DC  NR-E-UTRA Dual Connectivity
  NGEN-DC  NG-RAN E-UTRA-NR Dual Connectivity
  SCG  Secondary Cell Group
  SN Secondary Node


4  Multi-RAT Dual Connectivity


4.1  General


4.1.1  Common MR-DC principles

Multi-RAT Dual Connectivity (MR-DC) is a generalization of the Intra-E-UTRA
Dual Connectivity (DC) described in 36.300 [2], where a multiple Rx/Tx UE
may be configured to utilise resources provided by two different nodes
connected via non-ideal backhaul, one providing E-UTRA access and the other
one providing NR access. One node acts as the MN and the other as the SN.
The MN and SN are connected via a network interface and at least the MN is
connected to the core network.

  NOTE 1:  MR-DC is designed based on the assumption of non-ideal backhaul
         between the different nodes but can also be used in case of ideal
         backhaul.

  NOTE 2:  All MR-DC normative text and procedures in this version of the
         specification show the aggregated node case. The details about non-
         aggregated node for MR-DC operation are described in TS38.401[7].


4.1.2  MR-DC with the EPC

E-UTRAN supports MR-DC via E-UTRA-NR Dual Connectivity (EN-DC), in which a
UE is connected to one eNB that acts as a MN and one en-gNB that acts as a
SN. The eNB is connected to the EPC via the S1 interface and to the en-gNB
via the X2 interface. The en-gNB might also be connected to the EPC via the
S1-U interface and other en-gNBs via the X2-U interface.

The EN-DC architecture is illustrated in Figure 4.1.2-1 below.

                                    [pic]

                 Figure 4.1.2-1: EN-DC Overall Architecture


4.1.3  MR-DC with the 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.


4.1.3.1  E-UTRA-NR Dual Connectivity

NG-RAN supports NG-RAN E-UTRA-NR Dual Connectivity (NGEN-DC), in which a UE
is connected to one ng-eNB that acts as a MN and one gNB that acts as a SN.
The ng-eNB is connected to the 5GC and the gNB is connected to the ng-eNB
via the Xn interface.


4.1.3.2  NR-E-UTRA Dual Connectivity

NG-RAN supports NR-E-UTRA Dual Connectivity (NE-DC), in which a UE is
connected to one gNB that acts as a MN and one ng-eNB that acts as a SN.
The gNB is connected to 5GC and the ng-eNB is connected to the gNB via the
Xn interface.


4.2  Radio Protocol Architecture


4.2.1  Control Plane

In MR-DC, the UE has a single RRC state, based on the MN RRC and a single C-
plane connection towards the Core Network. Figure 4.2.1-1 illustrates the
Control plane architecture for MR-DC. Each radio node has its own RRC
entity (E-UTRA version if the node is an eNB or NR version if the node is a
gNB) which can generate RRC PDUs to be sent to the UE.

RRC PDUs generated by the SN can be transported via the MN to the UE. The
MN always sends the initial SN RRC configuration via MCG SRB (SRB1), but
subsequent reconfigurations may be transported via MN or SN. When
transporting RRC PDU from the SN, the MN does not modify the UE
configuration provided by the SN.

In EN-DC, at initial connection establishment SRB1 uses E-UTRA PDCP. After
initial connection establishment MCG SRBs (SRB1 and SRB2) can be configured
by the network to use either E-UTRA PDCP or NR PDCP. A PDCP version change
(release of old PDCP and establish of new PDCP) of SRBs can be supported in
either direction (i.e. from E-UTRA PDCP to NR PDCP or viceversa) via a
handover procedure (reconfiguration with mobility) or, for the initial
change from E-UTRA PDCP to NR PDCP, with a reconfiguration without
mobility, when the network knows there is no UL data in buffer and before
the initial security activation. For EN-DC capable UEs, NR PDCP can be
configured for DRBs and SRBs also before EN-DC is configured.

If the SN is a gNB (i.e. for EN-DC and NGEN-DC), the UE can be configured
to establish a SRB with the SN (SRB3) to enable RRC PDUs for the SN to be
sent directly between the UE and the SN. RRC PDUs for the SN can only be
transported directly to the UE for SN RRC reconfiguration not requiring any
coordination with the MN. Measurement reporting for mobility within the SN
can be done directly from the UE to the SN if SRB3 is configured.

Split SRB is supported for all MR-DC options, allowing duplication of RRC
PDUs generated by the MN, via the direct path and via the SN. Split SRB
uses NR PDCP. This version of the specification does not support the
duplication of RRC PDUs generated by the SN via the MN and SN paths.

In EN-DC, the SCG configuration is kept in the UE during suspension. The UE
releases the SCG configuration (but not the radio bearer configuration)
during resumption initiation.

                              [pic]       [pic]

 Figure 4.2.1-1: Control plane architecture for EN-DC (left) and MR-DC with
                                5GC (right).


4.2.2  User Plane

In MR-DC, from a UE perspective, three bearer types exist: MCG bearer, SCG
bearer and split bearer. These three bearer types are depicted in Figure
4.2.2-1 for MR-DC with EPC (EN-DC) and in Figure 4.2.2-2 for MR-DC with 5GC
(NGEN-DC, NE-DC).

For EN-DC, the network can configure either E-UTRA PDCP or NR PDCP for MN
terminated MCG bearers while NR PDCP is always used for all other bearers.

In MR-DC with 5GC, NR PDCP is always used for all bearer types. In NGEN-DC,
E-UTRA RLC/MAC is used in the MN while NR RLC/MAC is used in the SN. In NE-
DC, NR RLC/MAC is used in the MN while E-UTRA RLC/MAC is used in the SN.

                                    [pic]

 Figure 4.2.2-1: Radio Protocol Architecture for MCG, SCG and split bearers
               from a UE perspective in MR-DC with EPC (EN-DC)

                                    [pic]

 Figure 4.2.2-2: Radio Protocol Architecture for MCG, SCG and split bearers
          from a UE perspective in MR-DC with 5GC (NGEN-DC, NE-DC).

From a network perspective, each bearer (MCG, SCG and split bearer) can be
terminated either in MN or in SN. Network side protocol termination options
are shown in Figure 4.2.2-3 for MR-DC with EPC (EN-DC) and in Figure 4.2.2-
4 for MR-DC with 5GC (NGEN-DC, NE-DC).

  NOTE 1:  Even if only SCG bearers are configured for a UE, for SRB1 and
         SRB2 the logical channels are always configured at least in the
         MCG, i.e. this is still an MR-DC configuration and a Pcell always
         exists.

  NOTE 2:  If only MCG bearers are configured for a UE, i.e. there is no
         SCG, this is still considered an MR-DC configuration, as long as at
         least one of the bearers is terminated in the SN.

                                    [pic]

 Figure 4.2.2-3: Network side protocol termination options for MCG, SCG and
                  split bearers in MR-DC with EPC (EN-DC).

                                    [pic]

 Figure 4.2.2-4: Network side protocol termination options for MCG, SCG and
              split bearers in MR-DC with 5GC (NGEN-DC, NE-DC).


4.3  Network interfaces


4.3.1  Control Plane


4.3.1.1  Common MR-DC principles

In MR-DC, there is an interface between the MN and the SN for control plane
signalling and coordination. For each MR-DC UE, there is also one control
plane connection between the MN and a corresponding CN entity. The MN and
the SN involved in MR-DC for a certain UE control their radio resources and
are primarily responsible for allocating radio resources of their cells.

Figure 4.3.1.1-1 shows C-plane connectivity of MN and SN involved in MR-DC
for a certain UE.

                                 [pic][pic]

 Figure 4.3.1.1-1: C-Plane connectivity for EN-DC (left) and MR-DC with 5GC
                                  (right).


4.3.1.2  MR-DC with EPC

In MR-DC with EPC (EN-DC), the involved core network entity is the MME. S1-
MME is terminated in MN and the MN and the SN are interconnected via X2-C.


4.3.1.3  MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

In MR-DC with 5GC (NGEN-DC, NE-DC), the involved core network entity is the
AMF. NG-C is terminated in the MN and the MN and the SN are interconnected
via Xn-C.


4.3.2  User Plane


4.3.2.1  Common MR-DC principles

There are different U-plane connectivity options of the MN and SN involved
in MR-DC for a certain UE, as shown in Figure 4.3.2.2-1. The U-plane
connectivity depends on the bearer option configured:

  -  For MN terminated bearers, the user plane connection to the CN entity
    is terminated in the MN;

  -  For SN terminated bearers, the user plane connection to the CN entity
    is terminated in the SN;

  -  The transport of user plane data over the Uu either involves MCG or
    SCG radio resources or both:

    -  For MCG bearers, only MCG radio resources are involved;

    -  For SCG bearers, only SCG radio resources are involved;

    -  For split bearers, both MCG and SCG radio resources are involved.

  -  For split bearers, MN terminated SCG bearers and SN terminated MCG
    bearers, PDCP data is transferred between the MN and the SN via the MN-
    SN user plane interface.

                                 [pic][pic]

 Figure 4.3.2.1-1: U-Plane connectivity for EN-DC (left) and MR-DC with 5GC
                                  (right).


4.3.2.2  MR-DC with EPC

For MR-DC with EPC (EN-DC), X2-U interface is the user plane interface
between MN and SN, and S1-U is the user plane interface between the MN, the
SN or both and the S-GW.


4.3.2.3  MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

For MR-DC with 5GC (NGEN-DC, NE-DC), Xn-U interface is the user plane
interface between MN and SN, and NG-U is the user plane interface between
the MN, the SN or both and the UPF.


5  Layer 1 related aspects

In MR-DC, two or more Component Carriers (CCs) may be aggregated over two
cell groups. A UE may simultaneously receive or transmit on multiple CCs
depending on its capabilities. The maximum number of configured CCs for a
UE is 32 for DL and UL. Depending on UE's capabilities, up to 31 CCs can be
configured for an E-UTRA cell group when the NR cell group is configured.

In EN-DC, the SN may configure the same Physical Cell ID (PCI) to more than
one NR cell it serves. To avoid PCI confusion for EN-DC, NR PCIs should be
allocated in a way that an NR cell is uniquely identifyable by E-UTRA cell
information. This E-UTRA cell is in the coverage area of an NR cell
included in the EN-DC operation. In addtion, NR PCIs should only be re-used
in NR cells on the same SSB frequency sufficiently distant from each other.
X2-C signalling supports disambiguation of NR PCIs by including the ECGI in
respective X2AP EN-DC messages (e.g. SGNB ADDITION REQUEST).


6  Layer 2 related aspects


6.1  MAC Sublayer

In MR-DC, the UE is configured with two MAC entities: one MAC entity for
the MCG and one MAC entity for the SCG.

In MR-DC, semi-persistent scheduling (SPS) resources can be configured on
both Pcell and PSCell.

In MR-DC, the BSR configuration, triggering and reporting are independently
performed per cell group. For split bearers, the PDCP data is considered in
BSR in the cell group(s) configured by RRC.

In EN-DC, separate DRX configurations are provided for MCG and SCG.


6.2  RLC Sublayer

Both RLC AM and UM can be configured for MR-DC, for all bearer types (MCG,
SCG and split bearers).


6.3  PDCP Sublayer

In EN-DC, CA packet duplication (see [3]) is not applied to CA in the MN.

In EN-DC and NGEN-DC, CA packet duplication can only be configured for SCG
bearer. In NE-DC, CA packet duplication can only be configured for MCG
bearer.

In EN-DC, RoHC can be configured for all the bearer types.


6.4  SDAP Sublayer

In MR-DC with 5GC, the UE can be configured with two SDAP protocol entities
for each individual PDU session, one for MN and another one for SN (see
subclause 8.1).


7  RRC related aspects


7.1  System information handling

In MR-DC, the SN is not required to broadcast system information other than
for radio frame timing and SFN. System information for initial
configuration is provided to the UE by dedicated RRC signalling via the MN.
The UE acquires, at least, radio frame timing and SFN of SCG from the
PSS/SSS and MIB (if the SN is an eNB) / NR-PSS/SSS and PBCH (if the SN is a
gNB) of the PSCell.

Additionally, in EN-DC, upon change of the relevant system information of a
configured Scell, the network releases and subsequently adds the concerned
Scell (with updated system information), via one or more RRC
reconfiguration messages sent on SRB1 or SRB3, if configured.


7.2  Measurements

If the measurement is configured to the UE in preparation for the Secondary
Node Addition procedure described in sub-clause 10.2, the Master node
should configure the measurement to the UE.

In case of the intra-secondary node mobility described in sub-clause 10.3,
the SN should configure the measurement to the UE in coordination with the
MN, if required.

The Secondary Node Change procedure described in sub-clause 10.5 can be
triggered by both the MN (only for inter-frequency secondary node change)
and the SN. For secondary node changes triggered by the SN, the RRM
measurement configuration is maintained by the SN which also processes the
measurement reporting, without providing the measurement results to the MN.

Measurements can be configured independently by the MN (for inter-RAT
measurement) and by the SN (intra-RAT measurements on serving and non-
serving frequencies). The MN indicates the number of frequency layers that
can be used in the SN to ensure that UE capabilities are not exceeded. If
MN and SN both configure measurements on the same carrier frequency then
the configurations need to be consistent (if the network wants to ensure
these are considered as a single measurement layer). Each node (MN and SN)
can configure independently a threshold for the SpCell quality: when the
PCell quality is above the threshold configured by the MN, the UE is still
required to perform inter-RAT measurements configured by the MN on the SN
RAT (while it's not required to perform intra-RAT measurements); when the
PSCell quality is above the threshold configured by the SN, the UE is not
required to perform measurements configured by the SN.

  NOTE:  The SN cannot renegotiate the number of frequency layers allocated
         by the MN in this version of the protocol.

When SRB3 is not configured, reports for measurements configured by the SN
are sent on SRB1. When SRB3 is configured, reports for measurements
configured by the SN are sent on SRB3.

Measurement results related to the target SN can be provided by MN to
target SN at MN initiated SN change procedure. Measurement results of
target SN can be forwarded from source SN to target SN via MN at SN
initiated SN change procedure. Measurement results related to the target SN
can be provided by source MN to target MN at Inter-MN handover with/without
SN change procedure.

In EN-DC, measurement results according to measurement configuration from
the MN are encoded according to NR RRC when they are provided by MN to SN
in SgNB Addition Request message. During SN initiated SN change procedure,
measurement results according to measurement configuration from SN are
encoded according to NR RRC when they are provided by MN to SN in SgNB
Addition Request message.


7.3  UE capability coordination

In MR-DC, the capabilities of a UE supporting both E-UTRA and NR are
provided to both MN and SN. MR-DC band combinations, listing the supported
E-UTRA and NR band combinations, as well as NR PDCP capabilities (included
in both E-UTRA Capability and NR capability) are visible to both the MN and
SN.

Other RAT specific capabilities need not be visible to the node of the
other RAT. For the UE capabilities requiring coordination between E-UTRA
and NR (i.e. band combinations, baseband processing capabilities and the
maximum power for FR1 the UE can use in SCG), it is up to the MN to decide
on how to resolve the dependency between MN and SN configurations. The MN
then provides the resulting UE capabilities usable for SCG configuration to
the SN. As part of an SN initiated SN modification, the SN may indicate the
desired UE capabilities usable for SCG configuration, and it is up to the
MN to make the final decision whether to accept or reject the request.


7.4  Handling of combined MN/SN RRC messages

When both MCG and SCG reconfiguration is required due to the need for
coordination with the MN, the SN RRC reconfiguration message is
encapsulated in an MN RRC message that also carries the corresponding MCG
reconfiguration that ensures that the combined configuration can be jointly
processed by the UE. If the MN terminates a bearer using NR PDCP, the NR
PDCP configuration is generated by the MN itself. If the SN terminates the
bearer, the SN generates the NR PDCP configuration and sends it to the MN
as a separate container.

The UE uses a joint success/failure procedure for messages in an
encapsulating MN RRC message. A failure of the MN RRC messages, including
one encapsulated SN RRC message with or without any MCG reconfiguration
fields, triggers a re-establishment procedure. Each SN RRC reconfiguration
message should have its own RRC response message even when the SN RRC
message is encapsulated in an MN RRC message. The SN RRC response message
is forwarded over X2/Xn to the SN. If a SN RRC reconfiguration message is
contained in a MN RRC message, the UE sends a MN RRC response message that
encapsulates the SN RRC response message.

  NOTE:  If the MN RRC message does not encapsulate an SN RRC
         reconfiguration message (i.e. an SCG configuration) but only
         information elements generated by the SN (e.g. the PDCP
         configuration for an SN terminated bearer), the UE will not send an
         SN RRC response message.


7.5  SRB3

The decision to establish SRB3 is taken by the SN, which provides the SRB3
configuration using an SN RRC message. SRB3 establishment and release can
be done at Secondary Node Addition and Secondary Node Change. SRB3
reconfiguration can be done at Secondary Node Modification procedure.

SRB3 may be used to send SN RRC Reconfiguration, SN RRC Reconfiguration
Complete and SN Measurement Report messages, only in procedures where the
MN is not involved. SN RRC Reconfiguration Complete messages are mapped to
the same SRB as the message initiating the procedure. SN Measurement Report
messages are mapped to SRB3, if configured, regardless of whether the
configuration is received directly from the SN or via the MN. No MN RRC
messages are mapped to SRB3.

SRB3 is modelled as one of the SRBs defined in TS 38.331 [4] and uses the
NR-DCCH logical channel type. RRC PDUs on SRB3 are ciphered and integrity
protected using NR PDCP, with security keys derived from S-KgNB. The SN
selects ciphering and integrity protection algorithms for the SRB3 and
provides them to the MN within the SCG Configuration for transmission to
the UE.

  NOTE:  A NR SCG RRC message sent via E-UTRA MCG SRB is protected by E-
         UTRA MCG SRB security (NR security is not used in this case).

SRB3 is of higher scheduling priority than all DRBs. The default scheduling
priorities of split SRB1 and SRB3 are the same.

There is no requirement on the UE to perform any reordering of RRC messages
between SRB1 and SRB3.

When SCG is released, SRB3 is released.


7.6  Split SRB

Split SRB is supported for both SRB1 and SRB2 (split SRB is not supported
for SRB0 and SRB3). RRC PDUs on split SRB are ciphered and integrity
protected using NR PDCP.

Split SRB can be configured by the MN in Secondary Node Addition and/or
Modification procedure, with SN configuration part provided by the SN. A UE
can be configured with both split SRB and SRB3 simultaneously. SRB3 and the
SCG leg of split SRB can be independently configured.

For the split SRB, the selection of transmission path in downlink depends
on network implementation. For uplink, the UE is configured via MN RRC
signalling whether to use MCG path, SCG path or duplicate the transmission
on both MCG and SCG.


7.7  SCG/MCG failure handling

RLF is declared separately for the MCG and for the SCG.

If radio link failure is detected for MCG, the UE initiates the RRC
connection re-establishment procedure.

In EN-DC and NGEN-DC, the following SCG failure cases are supported:

  -  SCG RLF;

  -  SN change failure;

  -  SCG configuration failure (only for messages on SRB3);

  -  SCG RRC integrity check failure (on SRB3).

In EN-DC and NGEN-DC, upon SCG failure the UE suspends SCG transmissions
for all radio bearers and reports the SCG Failure Information to the MN,
instead of triggering re-establishment.

In all SCG failure cases, the UE maintains the current measurement
configurations from both the MN and the SN and the UE continues
measurements based on configuration from the MN and the SN if possible. The
SN measurements configured to be routed via the MN will continue to be
reported after the SCG failure.

  NOTE:  UE may not continue measurements based on configuration from the
         SN after SCG failure in certain cases (e.g. UE can not maintain the
         timing of PSCell).

The UE includes in the SCG Failure Information message the measurement
results available according to current measurement configuration of both
the MN and the SN.  The MN handles the SCG Failure Information message and
may decide to keep, change, or release the SN/SCG. In all the cases, the
measurement results according to the SN configuration and the SCG failure
type may be forwarded to the old SN and/or to the new SN.


7.8  UE identities

In MR-DC, two C-RNTIs are independently allocated to the UE: one for MCG,
and one for SCG.


7.9  Inter-node Resource Coordination

For EN-DC operation, MN and SN may coordinate their UL and DL radio
resources in semi-static manner via UE associated signalling.


8  Bearer handling aspects


8.1  QoS aspects

In EN-DC, the E-UTRAN QoS framework defined in TS 36.300 [2] applies:

  -  An S1-U bearer is established between the EPC and the SN for SN
    terminated bearers;

  -  An X2-U bearer is established between the MN and the SN for split
    bearers, MN terminated SCG bearers and SN terminated MCG bearers;

  -  MN terminated and SN terminated bearers may have either MCG or SCG
    radio resources or both, MCG and SCG radio resources, established;

  -  The MN decides the split of DL UE AMBR limits and UL UE AMBR limits
    among the MN and the SN respectively, and indicates DL UE AMBR limits
    and UL UE AMBR limits to be respected by the SN;

  -  The node that hosts the PDCP entity enforces the respective DL UE AMBR
    limits;

  -  Each node enforces the respective UL UE AMBR limits. For SN terminated
    bearers, if the node is not configured to serve the uplink, it ignores
    the indicated UL UE-AMBR.

In MR-DC with 5GC:

  -  The NG-RAN QoS framework defined in TS 38.300 [3] applies;

  -  QoS flows belonging to the same PDU session may be mapped to different
    bearer types (see subclause 4.2.2) and as a result there may be two
    different SDAP entities configured for the same PDU session: one at the
    MN and another one at the SN, in which case the MN decides which QoS
    flows are assigned to the SDAP entity in the SN;

  -  The MN or SN node that hosts the SDAP entity for a given QoS flow
    decides how to map the QoS flow to DRBs;

  -  If the SDAP entity for a given QoS flow is hosted by the MN and the MN
    decides that SCG resources are to be configured it provides QoS flow to
    DRB mapping information and the respective per QoS flow information to
    the SN;

  -  If the SDAP entity for a given QoS flow is hosted by the SN, the MN
    provides sufficient QoS related information to enable the SN to
    configure appropriate SCG resources and to request the configuration of
    appropriate MCG resources. The MN may offer MCG resources to the SN and
    may indicate for GBR QoS flows the amount offered to the SN on a per
    QoS flow level.

To support PDU sessions mapped to different bearer types, MR-DC with 5GC
provides the possibility for the MN to request the 5GC:

  -  For some PDU sessions of a UE: Direct the User Plane traffic of the
    whole PDU session either to the MN or to the SN. In that case, there is
    a single NG-U tunnel termination at the NG-RAN for such PDU session.

    -  The MN may request to change this assignment during the life time of
       the PDU session.

  -  For some other PDU sessions of a UE: Direct the User Plane traffic of
    a subset of the QoS flows of the PDU session to the SN (respectively
    MN) while the rest of the QoS flows of the PDU session is directed to
    the MN (respectively SN). In that case, there are two NG-U tunnel
    terminations at the NG-RAN for such PDU session.

    -  The MN may request to change this assignment during the life time of
       the PDU session.


8.2  Bearer type selection

In EN-DC, for each radio bearer the MN decides the location of the PDCP
entity and in which cell group(s) radio resources are to be configured.
Once an SN terminated split bearer is established, e.g. by means of the
Secondary Node Addition procedure or MN initiated Secondary Node
Modification procedure, the SN may remove and later on add SCG resources
for the respective E-RAB, as long as the QoS for the respective E-RAB is
guaranteed.

In MR-DC with 5GC, the following principles apply:

  -  The MN decides per PDU session the location of the SDAP entity, i.e.
    whether it shall be hosted by the MN or the SN or by both;

  -  If the MN decides to host an SDAP entity it may decide some of the
    related QoS flows to be realized as MCG bearer, some as SCG bearer, and
    others to be realized as split bearer;

  -  If the MN decides that an SDAP entity shall be hosted in the SN, some
    of the related QoS flows may be realized as SCG bearer, some as MCG
    bearer, while others may be realized as split bearer. The SN may remove
    or add SCG resources for the respective QoS flows, as long as the QoS
    for the respective QoS flow is guaranteed.


8.3  Bearer type change

In MR-DC, all the possible bearer type change options are supported:

  -  MCG bearer to/from split bearer;

  -  MCG bearer to/from SCG bearer;

  -  SCG bearer to/from split bearer.

Bearer termination point change is supported for all bearer types, and can
be performed with or without bearer type change:

  -  MN terminated bearer to/from SN terminated bearer.

For EN-DC:

  -  when the security key is changed for a bearer, the associated PDCP and
    RLC entities are re-established, while MAC behavior might depend on the
    solution selected by the network, e.g. MAC reset, change of LCID, etc.
    (see Annex A);

  -  for MCG bearer, split bearer and SCG bearer, during handover MCG/SCG
    PDCP and RLC are re-established and MCG/SCG MAC is reset;

  -  if a bearer type change happens through handover procedure then for
    MCG bearer, split bearer and SCG bearer, MCG/SCG PDCP/RLC are re-
    established and MCG/SCG MAC is reset;

  -  if a bearer type change happens through SN change procedure, then SN
    terminated PDCP /RLC are re-established and SCG MAC is reset;

  -  one step (direct) bearer type change between MN terminated bearer
    types without using the handover procedure is supported;

  -  one step (direct) bearer type change between SN terminated bearer
    types without using the handover or SN change procedure is supported;

  -  for bearer type change between MCG bearer and SCG bearer MAC is not
    reset; the original RLC entity is released and new RLC entity is
    established;

  -  PDCP version change for DRB or PDCP SN length change for an AM DRB is
    performed using a release and add of the DRBs (in a single message) or
    full configuration;

  -  One step (direct) bearer type change with PDCP version change is
    supported;

  -  Upon bearer type change from MCG bearer to SCG bearer or from split
    bearer to SCG bearer, the associated LTE RLC entity is first re-
    established and then released:

  NOTE:  L2 handling for bearer type change in EN-DC is also summarized in
         Annex A (the table does not consider the case that PDCP SN length
         is changed).


8.4  User data forwarding

Upon EN-DC specific activities, user data forwarding may be performed for E-
RABs for which the bearer type change from/to MN terminated bearer to/from
SN terminated bearer is performed. The behaviour of the node from which
data is forwarded is the same as specified for the "source eNB" for
handover, the behaviour of the node to which data is forwarded is the same
as specified for the "target eNB" for handover.

For MR-DC with 5GC, user data forwarding may be performed between NG-RAN
nodes whenever the logical node hosting the PDCP entity changes. The
behaviour of the node from which data is forwarded is the same as specified
for the "source NG-RAN node" for handover, the behaviour of the node to
which data is forwarded is the same as specified for the "target NG-RAN
node" for handover.


9  Security related aspects

EN-DC can only be configured after security activation in the MN.

In EN-DC, for bearers terminated in the MN the network configures the UE
with KeNB; for bearers terminated in the SN the network configures the UE
with S-KgNB.

For mobility scenarios that involve only a change of the SCG (i.e. no Pcell
handover and hence no KeNB change), S-KgNB key refresh is not required if
the PDCP termination point of the SN is not changed.

In EN-DC, the UE supports the NR security algorithms corresponding to the E-
UTRA security algorithms signalled at NAS level and the UE NR AS Security
capability is not signalled to the MN over RRC. Mapping from E-UTRA
security algorithms to the corresponding NR security algorithms, where
necessary, is performed at the MN.

For MR-DC with 5GC, UP integrity protection can be configured on a per
radio bearer basis.


10 Multi-Connectivity operation related aspects


10.1 General

Similar procedures as defined under section 10.1.2.8 (Dual Connectivity
operation) in TS 36.300 [2] apply for MR-DC.


10.2 Secondary Node Addition


10.2.1 EN-DC

The Secondary Node Addition procedure is initiated by the MN and is used to
establish a UE context at the SN to provide radio resources from the SN to
the UE. For bearers requiring SCG radio resources, this procedure is used
to add at least the first cell of the SCG. This procedure can also be used
to configure an SN terminated MCG bearer (where no SCG configuration is
needed). Figure 10.2.1-1 shows the Secondary Node Addition procedure.

                                    [pic]

             Figure 10.2.1-1: Secondary Node Addition procedure

  1. The MN decides to request the SN to allocate radio resources for a
    specific E-RAB, indicating E-RAB characteristics (E-RAB parameters, TNL
    address information corresponding to bearer type). In addition, for
    bearers requiring SCG radio resources, MN indicates the requested SCG
    configuration information, including the entire UE capabilities and the
    UE capability coordination result. In this case, the MN also provides
    the latest measurement results for SN to choose and configure the SCG
    cell(s). The MN may request the SN to allocate radio resources for
    split SRB operation. The MN always provides all the needed security
    information to the SN (even if no SN terminated bearers are setup) to
    enable SRB3 to be setup based on SN decision. In case of bearer options
    that require X2-U resources between the MN and the SN, the MN provides
    X2-U TNL address information for the respective E-RAB, X2-U DL TNL
    address information for SN terminated bearers, X2-U UL TNL address
    information for MN terminated bearers. In case of SN terminated split
    bearers the MN provides the maximum QoS level that it can support. The
    SN may reject the request.

  NOTE 1:  For split bearers, MCG and SCG resources may be requested of
         such an amount, that the QoS for the respective E-RAB is guaranteed
         by the exact sum of resources provided by the MCG and the SCG
         together, or even more. For MN terminated split bearers, the MNs
         decision is reflected in step 1 by the E-RAB parameters signalled
         to the SN, which may differ from E-RAB parameters received over S1.

  NOTE 2:  For a specific E-RAB, the MN may request the direct
         establishment of an SCG or a split bearer, i.e., without first
         having to establish an MCG bearer. It is also allowed that all E-
         RABs can be configured as SN terminated bearers, i.e. there is no E-
         RAB established as an MN terminated bearer.

  2. If the RRM entity in the SN is able to admit the resource request, it
    allocates respective radio resources and, dependent on the bearer
    option, respective transport network resources. For bearers requiring
    SCG radio resources, the SN triggers Random Access so that
    synchronisation of the SN radio resource configuration can be
    performed. The SN decides the Pscell and other SCG Scells and provides
    the new SCG radio resource configuration to the MN in a NR RRC
    configuration message contained in the SgNB Addition Request
    Acknowledge message. In case of bearer options that require X2-U
    resources between the MN and the SN, the SN provides X2-U TNL address
    information for the respective E-RAB, X2-U UL TNL address information
    for SN terminated bearers, X2-U DL TNL address information for MN
    terminated bearers. For SN terminated bearers, the SN provides the S1-U
    DL TNL address information for the respective E-RAB and security
    algorithm. If SCG radio resources have been requested, the SCG radio
    resource configuration is provided.

  NOTE 3:  For the SN terminated split bearer option, the SN may either
         decide to request resources from the MN of such an amount, that the
         QoS for the respective E-RAB is guaranteed by the exact sum of
         resources provided by the MN and the SN together, or even more. The
         SNs decision is reflected in step 2 by the E-RAB parameters
         signalled to the MN, which may differ from E-RAB parameters
         received in step 1. The QoS level requested from the MN shall not
         exceed the level that the MN offered when setting up the split
         bearer in step 1.

  NOTE 4:  In case of MN terminated bearers, transmission of user plane
         data may take place after step 2.

  NOTE 5:  In case of SN terminated bearers , data forwarding and the SN
         Status Transfer may take place after step 2.

  3. The MN sends to the UE the RRCConnectionReconfiguration message
    including the NR RRC configuration message, without modifying it.

  4. The UE applies the new configuration and replies to MN with
    RRCConnectionReconfigurationComplete message, including a NR RRC
    response message, if needed. In case the UE is unable to comply with
    (part of) the configuration included in the
    RRCConnectionReconfiguration message, it performs the reconfiguration
    failure procedure.

  5. The MN informs the SN that the UE has completed the reconfiguration
    procedure successfully via SgNB ReconfigurationComplete message,
    including the encoded NR RRC response message, if received from the UE.

  6. If configured with bearers requiring SCG radio resources, the UE
    performs synchronisation towards the PSCell of the SN. The order the UE
    sends the RRCConnectionReconfigurationComplete message and performs the
    Random Access procedure towards the SCG is not defined. The successful
    RA procedure towards the SCG is not required for a successful
    completion of the RRC Connection Reconfiguration procedure.

  7. In case of SN terminated bearers using RLC AM, the MN sends SN Status
    Transfer.

  8. In case of SN terminated bearers using RLC AM, and dependent on the
    bearer characteristics of the respective E-RAB, the MN may take actions
    to minimise service interruption due to activation of EN-DC (Data
    forwarding).

  9-12.  For SN terminated bearers, the update of the UP path towards the
    EPC is performed.


10.2.2 MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

The Secondary Node (SN) Addition procedure is initiated by the MN and is
used to establish a UE context at the SN in order to provide radio
resources from the SN to the UE. For bearers requiring SCG radio resources,
this procedure is used to add at least the initial SCG serving cell of the
SCG. This procedure can also be used to configure an SN terminated MCG
bearer (where no SCG configuration is needed). Figure 10.2.2-1 shows the SN
Addition procedure.

                                    [pic]

                   Figure 10.2.2-1: SN Addition procedure

  1. The MN decides to request the target SN to allocate radio resources
    for one or more specific PDU Sessions/QoS Flows, indicating QoS Flows
    characteristics (QoS Flow Level QoS parameters, PDU session level TNL
    address information, and PDU session level Network Slice info). In
    addition, for bearers requiring SCG radio resources, MN indicates the
    requested SCG configuration information, including the entire UE
    capabilities and the UE capability coordination result. In this case,
    the MN also provides the latest measurement results for SN to choose
    and configure the SCG cell(s). The MN may request the SN to allocate
    radio resources for split SRB operation. The MN always provides all the
    needed security information to the SN (even if no SN terminated bearers
    are setup) to enable SRB3 to be setup based on SN decision. For bearer
    options that require Xn-U resources between the MN and the SN, MN needs
    to provide Xn-U TNL address information, Xn-U DL TNL address
    information for SN terminated bearers and Xn-U UL TNL address
    information for MN terminated bearers. The SN may reject the request.

  NOTE 1:  For split bearers, MCG and SCG resources may be requested of
         such an amount, that the QoS for the respective QoS Flow is
         guaranteed by the exact sum of resources provided by the MCG and
         the SCG together, or even more. For MN terminated split bearers,
         the MN decision is reflected in step 1 by the QoS Flow parameters
         signalled to the SN, which may differ from QoS Flow parameters
         received over NG.

  NOTE 2:  For a specific QoS flow, the MN may request the direct
         establishment of SCG and/or split bearers, i.e. without first
         having to establish MCG bearers. It is also allowed that all QoS
         flows can be mapped to SN terminated bearers, i.e. there is no QoS
         flow mapped to an MN terminated bearer.

  2. If the RRM entity in the SN is able to admit the resource request, it
    allocates respective radio resources and, dependent on the bearer type
    options, respective transport network resources. For bearers requiring
    SCG radio resources the SN triggers UE Random Access so that
    synchronisation of the SN radio resource configuration can be
    performed. The SN decides for the PScell and other SCG Scells and
    provides the new SCG radio resource configuration to the MN in a SN RRC
    configuration message contained in the SN Addition Request Acknowledge
    message. In case of bearer options that require Xn-U resources between
    the MN and the SN, the SN provides Xn-U TNL address information for the
    respective E-RAB, Xn-U UL TNL address information for SN terminated
    bearers, Xn-U DL TNL address information for MN terminated bearers.
    For SN terminated bearers, the SN provides the NG-U DL TNL address
    information for the respective PDU Session and security algorithm. If
    SCG radio resources have been requested, the SCG radio resource
    configuration is provided.

  NOTE 3:  In case of MN terminated bearers, transmission of user plane
         data may take place after step 2.

  NOTE 4:  In case of SN terminated bearers, data forwarding and the SN
         Status Transfer may take place after step 2.

  3. The MN sends the MN RRC reconfiguration message to the UE including
    the SN RRC configuration message, without modifying it.

  4. The UE applies the new configuration and replies to MN with MN RRC
    reconfiguration complete message, including a SN RRC response message
    for SN, if needed. In case the UE is unable to comply with (part of)
    the configuration included in the MN RRC reconfiguration message, it
    performs the reconfiguration failure procedure.

  5. The MN informs the SN that the UE has completed the reconfiguration
    procedure successfully via SN Reconfiguration Complete message,
    including the encoded SN RRC response message, if received from the UE.

  6. If configured with bearers requiring SCG radio resources, the UE
    performs synchronisation towards the PSCell configured by the SN. The
    order the UE sends the MN RRC reconfiguration complete message and
    performs the Random Access procedure towards the SCG is not defined.
    The successful RA procedure towards the SCG is not required for a
    successful completion of the RRC Connection Reconfiguration procedure.

  7. In case of SN terminated bearers using RLC AM, the MN sends SN Status
    Transfer.

  8. In case of SN terminated bearers using RLC AM, and dependent on the
    bearer characteristics of the respective QoS Flows, the MN may take
    actions to minimise service interruption due to activation of MR-DC
    (Data forwarding).

  9-12.  For SN terminated bearers, the update of the UP path towards the
    5GC is performed via PDU Session Path Update procedure.


10.3 Secondary Node Modification (MN/SN initiated)


10.3.1 EN-DC

The Secondary Node Modification procedure may be initiated either by the MN
or by the SN and be used to modify, establish or release bearer contexts,
to transfer bearer contexts to and from the SN or to modify other
properties of the UE context within the same SN. It may also be used to
transfer an NR RRC message from the SN to the UE via the MN and the
response from the UE via MN to the SN (e.g. when SRB3 is not used).

The Secondary Node modification procedure does not necessarily need to
involve signalling towards the UE.

MN initiated SN Modification

                                    [pic]

          Figure 10.3.1-1: SN Modification procedure - MN initiated

The MN uses the procedure to initiate configuration changes of the SCG
within the same SN, e.g. the addition, modification or release of SCG
bearer(s) and the SCG RLC bearer of split bearer(s), as well as
configuration changes for SN terminated MCG bearers. Bearer type change may
result in adding the new bearer configuration and releasing the old bearer
configuration within a single MN initiated SN Modification procedure for
the respective E-RAB. The MN uses this procedure to perform handover within
the same MN while keeping the SN. The MN also uses the procedure to query
the current SCG configuration, e.g. when delta configuration is applied in
a MN initiated SN change. MN may not use the procedure to initiate the
addition, modification or release of SCG Scells. The SN may reject the
request, except if it concerns the release of SN terminated bearer(s) or
the SCG RLC bearer of MN terminated bearer(s), or if it is used to perform
handover within the same MN while keeping the SN. Figure 10.3.1-1 shows an
example signalling flow for a MN initiated SN Modification procedure.

  1. The MN sends the SgNB Modification Request message, which may contain
    bearer context related or other UE context related information, data
    forwarding address information (if applicable) and the requested SCG
    configuration information, including the UE capability coordination
    result to be used as basis for the reconfiguration by the SN. In case a
    security key update in the SN is required, a new SgNB Security Key is
    included. In case of SCG RLC re-establishment for E-RABs configured
    with an MN terminated bearer with an SCG RLC bearer for which no bearer
    type change is performed, the MN provides a new UL GTP TEID to the SN.
    The SN shall continue sending UL PDCP PDUs to the MN with the previous
    UL GTP TEID until it re-establishes the RLC and use the new UL GTP TEID
    after re-establishment. In case of PDCP re-establishment for E-RABs
    configured with an SN terminated bearer with an MCG RLC bearer for
    which no bearer type change is performed, the MN provides a new DL GTP
    TEID to the SN. The SN shall continue sending DL PDCP PDUs to the MN
    with the previous DL GTP TEID until it performs PDCP re-establishment
    and use the new DL GTP TEID starting with the PDCP re-establishment.

  2. The SN responds with the SgNB Modification Request Acknowledge
    message, which may contain SCG radio resource configuration information
    within a NR RRC configuration message and data forwarding address
    information (if applicable).  In case of a PSCell change with security
    key update, for E-RABs configured with the MN terminated bearer option
    that require X2-U resources between the MN and the SN, for which no
    bearer type change is performed, the SN provides a new DL GTP TEID to
    the MN. The MN shall continue sending DL PDCP PDUs to the SN with the
    previous DL GTP TEID until it performs PDCP re-establishment or PDCP
    data recovery, and use the new DL GTP TEID starting with the PDCP re-
    establishment or data recovery. In case of a PSCell change with
    security key update, for E-RABs configured with the SN terminated
    bearer option that require X2-U resources between the MN and the SN,
    for which no bearer type change is performed, the SN provides a new UL
    GTP TEID to the MN. The MN shall continue sending UL PDCP PDUs to the
    SN with the previous UL GTP TEID until it re-establishes the RLC and
    use the new UL GTP TEID after re-establishment.

  3-5. The MN initiates the RRC connection reconfiguration procedure,
    including the NR RRC configuration message. The UE applies the new
    configuration, synchronizes to the MN (if instructed, in case of intra-
    MN handover) and replies with RRCConnectionReconfigurationComplete,
    including a NR RRC response message, if needed. In case the UE is
    unable to comply with (part of) the configuration included in the
    RRCConnectionReconfiguration message, it performs the reconfiguration
    failure procedure.

  6. Upon successful completion of the reconfiguration, the success of the
    procedure is indicated in the SgNB Reconfiguration Complete message.

  7. If instructed, the UE performs synchronisation towards the PSCell of
    the SN as described in SgNB addition procedure. Otherwise, the UE may
    perform UL transmission after having applied the new configuration.

  8. If PDCP termination point is changed for bearers using RLC AM, and
    when RRC full configuration is not used, the MN sends the SN Status
    transfer.

  9. If applicable, data forwarding between MN and the SN takes place
    (Figure 10.3.1-1 depicts the case where a bearer context is transferred
    from the MN to the SN).

  10.  The SN sends the Secondary RAT Data Volume Report message to the MN
    and includes the data volumes delivered to the UE over the NR radio for
    the E-RABs to be released.

  NOTE 1:  The order the SN sends the Secondary RAT Data Volume Report
         message and performs data forwarding with MN is not defined. The SN
         may send the report when the transmission of the related bearer is
         stopped.

  11.  If applicable, a path update is performed.

SN initiated SN Modification with MN involvement

                                    [pic]

      Figure 10.3.1-2: SN Modification procedure - SN initiated with MN
                                 involvement

The SN uses the procedure to perform configuration changes of the SCG
within the same SN, e.g. to trigger the release of SCG bearer(s) and the
SCG RLC bearer of split bearer(s) (upon which the MN may release the bearer
or maintain current bearer type or reconfigure it to an MCG bearer, either
MN terminated or SN terminated), and to trigger PSCell change (e.g. when a
new security key is required or when the MN needs to perform PDCP data
recovery). The MN cannot reject the release request of SCG bearer and the
SCG RLC bearer of a split bearer. Figure 10.3.1.-2 shows an example
signalling flow for an SN initiated SgNB Modification procedure, with MN
involvement.

  1. The SN sends the SgNB Modification Required message including a NR RRC
    configuration message, which may contain bearer context related, other
    UE context related information and the new SCG radio resource
    configuration. For bearer release or modification, a corresponding E-
    RAB list is included in the SgNB Modification Required message. In case
    of change of security key, the PDCP Change Indication indicates that a
    S-KgNB update is required. In case the MN needs to perform PDCP data
    recovery, the PDCP Change Indication indicates that PDCP data recovery
    is required.

    The SN can decide whether the change of security key is required.

  2/3. If data forwarding and/or SN security key change needs to be
    applied, the MN triggers the preparation of the MN initiated SN
    Modification procedure and provides forwarding address and/or a new SN
    security key information within the SgNB Modification Request message,
    respectively.

  NOTE 2:  If only SN security key is provided in step 2, the MN does not
         need to wait for the reception of step 3 to initiate the RRC
         connection reconfiguration procedure.

  4. The MN sends the RRCConnectionReconfiguration message including a NR
    RRC configuration message to the UE including the new SCG radio
    resource configuration.

  5. The UE applies the new configuration and sends the
    RRCConnectionReconfigurationComplete message, including an encoded NR
    RRC response message, if needed. In case the UE is unable to comply
    with (part of) the configuration included in the
    RRCConnectionReconfiguration message, it performs the reconfiguration
    failure procedure.

  6. Upon successful completion of the reconfiguration, the success of the
    procedure is indicated in the SgNB Modification Confirm message
    containing the encoded NR RRC response message, if received from the
    UE.

  7. If instructed, the UE performs synchronisation towards the PSCell of
    the SN as described in SN addition procedure. Otherwise, the UE may
    perform UL transmission after having applied the new configuration.

  8. If PDCP termination point is changed for bearers using RLC AM, and
    when RRC full configuration is not used, the SN sends the MN Status
    transfer.

  9. If applicable, data forwarding between MN and the SN takes place
    (Figure 10.3.1-2 depicts the case where a bearer context is transferred
    from the SN to the MN).

  10.  The SN sends the Secondary RAT Data Volume Report message to the MN
    and includes the data volumes delivered to the UE over the NR radio for
    the E-RABs to be released.

  NOTE 3:  The order the SN sends the Secondary RAT Data Volume Report
         message and performs data forwarding with MN is not defined. The SN
         may send the report when the transmission of the related bearer is
         stopped.

  11.  If applicable, a path update is performed.

SN initiated SN Modification without MN involvement

                                    [pic]

   Figure 10.3.1-3: SN modification - SN initiated without MN involvement

The SN initiated modification without  MN  involved  procedure  is  used  to
modify the configuration within SN  in  case  no  coordination  with  MN  is
required, including  the  addition/modification/release  of  SCG  Scell  and
PSCell change (e.g. when the security key does not need to  be  changed  and
the MN does not need to be  involved  in  PDCP  recovery).  Figure  10.3.1-3
shows  an  example  signalling  flow  for  SN  initiated   SN   modification
procedure, without MN involvement. The SN  can  decide  whether  the  Random
Access procedure is required.

  1. The SN sends the RRCConnectionReconfiguration message to the UE
    through SRB3. The UE applies the new configuration. In case the UE is
    unable to comply with (part of) the configuration included in the
    RRCConnectionReconfiguration message, it performs the reconfiguration
    failure procedure.

  2. If instructed, the UE performs synchronisation towards the PSCell of
    the SN.

  3. The UE replies with the RRCConnectionReconfigurationComplete message.

Transfer of an NR RRC message to/from the UE (when SRB3 is not used)

                                    [pic]

        Figure 10.3.1-4: Transfer of an NR RRC message to/from the UE

The SN initiates the procedure when it needs to transfer an NR  RRC  message
to the UE and SRB3 is not used.

  1. The SN initiates the procedure by sending the SgNB Modification
    Required to the MN.

  2. The MN forwards the NR RRC message to the UE in the
    RRCConnectionReconfiguration message.

  3. The UE applies the new configuration and replies with the
    RRCConnectionReconfigurationComplete message.

  4. The MN forwards the NR RRC response message, if received from the UE,
    to the SN in the SgNB Modification Confirm message.


10.3.2 MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

The SN Modification procedure may be initiated either by the MN or by the
SN and be used to modify, establish or release PDU session/QoS Flow
contexts, to transfer PDU session/QoS Flow contexts to and from the SN or
to modify other properties of the UE context within the same SN. It may
also be used to transfer an NR RRC message from the SN to the UE via the MN
and the response from the UE via MN to the SN (e.g. when SRB3 is not used).

The SN modification procedure does not necessarily need to involve
signalling towards the UE.

MN initiated SN Modification

                                    [pic]

          Figure 10.3.2-1: SN Modification procedure - MN initiated

The MN uses the procedure to initiate configuration changes of the SCG
within the same SN, including addition, modification or release PDU
session/QoS Flows mapped onto SN terminated bearer(s) and MN terminated
bearers with an SCG RLC bearer. The MN uses the procedure to query the
current SCG configuration, e.g. when delta configuration is applied in a MN
initiated SN change. MN may not use the procedure to initiate the addition,
modification or release of SCG Scells. The SN may reject the request,
except if it concerns the release of PDU session/QoS flow. Figure 10.3.2-1
shows an example signalling flow for a MN initiated SN Modification
procedure.

  1. The MN sends the SN Modification Request message, which may contain
    PDU session/QoS Flow context related or other UE context related
    information, data forwarding address information (if applicable), PDU
    session level Network Slice info and the requested SCG configuration
    information, including the UE capabilities coordination result to be
    used as basis for the reconfiguration by the SN.

  2. The SN responds with the SN Modification Request Acknowledge message,
    which may contain new SCG radio configuration information within a SN
    RRC configuration message, and data forwarding address information (if
    applicable).

  3/4. The MN initiates the RRC connection reconfiguration procedure,
    including SN RRC configuration message. The UE applies the new
    configuration and replies with MN RRC reconfiguration complete message,
    including a SN RRC response message, if needed. In case the UE is
    unable to comply with (part of) the configuration included in the MN
    RRC reconfiguration message, it performs the reconfiguration failure
    procedure.

  5. Upon successful completion of the reconfiguration, the success of the
    procedure is indicated in the SN Reconfiguration Complete message.

  6. If instructed, the UE performs synchronisation towards the PSCell of
    the SN as described in SN addition procedure. Otherwise, the UE may
    perform UL transmission after having applied the new configuration.

  7. If PDCP termination point is changed for bearers using RLC AM, and
    when RRC full configuration is not used, the MN sends the SN Status
    transfer.

  8. If applicable, data forwarding between MN and the SN takes place
    (Figure 10.3.2-1 depicts the case where a PDU session/QoS Flow context
    is transferred from the MN to the SN).

  9. If applicable, a PDU Session path update procedure is performed.

SN initiated SN Modification with MN involvement

                                    [pic]

      Figure 10.3.2-2: SN Modification procedure - SN initiated with MN
                                 involvement

The SN uses the procedure to perform configuration changes of the SCG
within the same SN, e.g. to trigger the modification/release of PDU
session/QoS flows and to trigger PSCell changes (when MN involvement is
needed for this). The MN cannot reject the release request of PDU
session/QoS flows. Figure 10.3.2-2 shows an example signalling flow for SN
initiated SN Modification procedure.

  1. The SN sends the SN Modification Required message including a SN RRC
    configuration message, which may contain PDU session/QoS Flow context
    related, other UE context related information and the new radio
    resource configuration of SCG. For the release or modification of PDU
    session/QoS flow, a corresponding PDU session/QoS Flows list is
    included in the SN Modification Required message.

     The SN can decide whether the change of security key is required.

  2/3. The MN initiated SN Modification procedure may be triggered by SN
    Modification Required message.

  4. The MN sends the MN RRC reconfiguration message to the UE including
    the SN RRC configuration message the new SCG radio resource
    configuration.

  5. The UE applies the new configuration and sends the MN RRC
    reconfiguration complete message, including an encoded SN RRC response
    message, if needed. In case the UE is unable to comply with (part of)
    the configuration included in the MN RRC reconfiguration message, it
    performs the reconfiguration failure procedure.

  6. Upon successful completion of the reconfiguration, the success of the
    procedure is indicated in the SN Modification Confirm message
    containing the encoded SN RRC response message, if received from the
    UE.

  7. If instructed, the UE performs synchronisation towards the PSCell
    configured by the SN as described in SN Addition procedure. Otherwise,
    the UE may perform UL transmission directly after having applied the
    new configuration.

  8. If PDCP termination point is changed for bearers using RLC AM, and
    when RRC full configuration is not used, the SN sends the MN Status
    transfer.

  9. If applicable, data forwarding between MN and the SN takes place
    (Figure 10.3.2-2 depicts the case where a PDU session/QoS Flow context
    is transferred from the SN to the MN).

  10.  If applicable, a PDU Session path update procedure is performed.

SN initiated SN Modification without MN involvement

This procedure is not supported for NE-DC.

                                    [pic]

   Figure 10.3.2-3: SN Modification – SN initiated without MN involvement

The SN initiated SN modification procedure without MN involvement is used
to modify the configuration within SN in case no coordination with MN is
required, including the addition/modification/release of SCG Scell and
PSCell change (when MN involvement is not needed for this). Figure 10.3.2-3
shows an example signalling flow for SN initiated SN modification procedure
without MN involvement. The SN can decide whether the Random Access
procedure is required.

  1. The SN sends the SN RRC reconfiguration message to the UE through
    SRB3.

  2. The UE applies the new configuration and replies with the SN RRC
    reconfiguration complete message. In case the UE is unable to comply
    with (part of) the configuration included in the SN RRC reconfiguration
    message, it performs the reconfiguration failure procedure.

  3. If instructed, the UE performs synchronisation towards the PSCell of
    the SN as described in SN Addition procedure. Otherwise the UE may
    perform UL transmission after having applied the new configuration.

Transfer of an NR RRC message to/from the UE (when SRB3 is not used)

                                    [pic]

        Figure 10.3.2-4: Transfer of an NR RRC message to/from the UE

The SN initiates the procedure when it needs to transfer an NR  RRC  message
to the UE and SRB3 is not used.

  1. The SN initiates the procedure by sending the SN Modification Required
    to the MN.

  2. The MN forwards the NR RRC message to the UE in the RRC
    reconfiguration message.

  3. The UE applies the new configuration and replies with the RRC
    reconfiguration complete message.

  4. The MN forwards the NR RRC response message, if received from the UE,
    to the SN in the SN Modification Confirm message.


10.4 Secondary Node Release (MN/SN initiated)


10.4.1 EN-DC

The Secondary Node Release procedure may be initiated either by the MN or
by the SN and is used to initiate the release of the UE context at the SN.
The recipient node of this request can reject it, e.g., if a SN change
procedure is triggered by the SN.

It does not necessarily need to involve signalling towards the UE, e.g., in
case of the RRC connection re-establishment due to Radio Link Failure in
MN.

MN initiated SN Release

                                    [pic]

            Figure 10.4.1-1: SN Release procedure – MN initiated

Figure 10.4.1-1 shows an example signalling flow for the MN initiated
Secondary Node Release procedure when SN Release is confirmed by SN.

  1. The MN initiates the procedure by sending the SgNB Release Request
    message. If data forwarding is requested, the MN provides data
    forwarding addresses to the SN.

  2. The SN confirms SN Release by sending the SgNB Release Request
    Acknowledge message. If appropriate, the SN may reject SN Release, e.g.
    if the SN change procedure is triggered by the SN.

  3/4. If required, the MN indicates in the RRCConnectionReconfiguration
    message towards the UE that the UE shall release the entire SCG
    configuration. In case the UE is unable to comply with (part of) the
    configuration included in the RRCConnectionReconfiguration message, it
    performs the reconfiguration failure procedure.

  NOTE 1:  If data forwarding is applied, timely coordination between steps
         1 and 2 may minimize gaps in service provision, this is however
         regarded to be an implementation matter.

  5. If the released bearers use RLC AM, the SN sends the SN Status
    transfer.

  6. Data forwarding from the SN to the MN takes place.

  7. The SN sends the Secondary RAT Data Volume Report message to the MN
    and includes the data volumes delivered to the UE over the NR radio for
    the related E-RABs.

  NOTE 2:  The order the SN sends the Secondary RAT Data Volume Report
         message and performs data forwarding with MN is not defined. The SN
         may send the report when the transmission of the related bearer is
         stopped.

  8. If applicable, the path update procedure is initiated.

  9. Upon reception of the UE Context Release message, the SN can release
    radio and C-plane related resource associated to the UE context. Any
    ongoing data forwarding may continue.

SN initiated SN Release

                                    [pic]

            Figure 10.4.1-2: SN Release procedure – SN initiated

Figure 10.4.1-2 shows an example signalling flow for the SN initiated
Secondary Node Release procedure.

  1. The SN initiates the procedure by sending the SgNB Release Required
    message which does not contain inter-node message.

  2. If data forwarding is requested, the MN provides data forwarding
    addresses to the SN in the SgNB Release Confirm message. The SN may
    start data forwarding and stop providing user data to the UE as early
    as it receives the SgNB Release Confirm message.

  3/4. If required, the MN indicates in the RRCConnectionReconfiguration
    message towards the UE that the UE shall release the entire SCG
    configuration. In case the UE is unable to comply with (part of) the
    configuration included in the RRCConnectionReconfiguration message, it
    performs the reconfiguration failure procedure.

  NOTE 3:  If data forwarding is applied, timely coordination between steps
         2 and 3 may minimize gaps in service provision. This is however
         regarded to be an implementation matter.

  5. If the released bearers use RLC AM, the SN sends the SN Status
    transfer.

  6. Data forwarding from the SN to the MN takes place.

  7. The SN sends the Secondary RAT Data Volume Report message to the MN
    and includes the data volumes delivered to the UE over the NR radio for
    the related E-RABs.

  NOTE 4:  The order the SN sends the Secondary RAT Data Volume Report
         message and performs data forwarding with MN is not defined. The SN
         may send the report when the transmission of the related bearer is
         stopped.

  8. If applicable, the path update procedure is initiated.

  9. Upon reception of the UE Context Release message, the SN can release
    radio and C-plane related resource associated to the UE context. Any
    ongoing data forwarding may continue.


10.4.2 MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

The SN Release procedure may be initiated either by the MN or by the SN and
is used to initiate the release of the UE context and relevant resources at
the SN. The recipient node of this request can reject it, e.g., if a SN
change procedure is triggered by the SN.

MN initiated SN Release

                                    [pic]

            Figure 10.4.2-1: SN release procedure - MN initiated

Figure 10.4.2-1 shows an example signalling flow for the MN initiated SN
Release procedure.

  1. The MN initiates the procedure by sending the SN Release Request
    message. If data forwarding is requested, the MN provides data
    forwarding addresses to the SN.

  2. The SN confirms SN Release by sending the SN Release Request
    Acknowledge message. If appropriate, the SN may reject SN Release,
    e.g., if the SN change procedure is triggered by the SN.

  3/4. If required, the MN indicates in the MN RRC reconfiguration message
    towards the UE that the UE shall release the entire SCG configuration.
    In case the UE is unable to comply with (part of) the configuration
    included in the MN RRC reconfiguration message, it performs the
    reconfiguration failure procedure.

  NOTE 1:  If data forwarding is applied, timely coordination between steps
         1 and 2 may minimize gaps in service provision, this is however
         regarded to be an implementation matter.

  5. If the released bearers use RLC AM, the SN sends the SN Status
    transfer.

  6. Data forwarding from the SN to the MN takes place.

  7. If applicable, the PDU Session path update procedure is initiated.

  8. Upon reception of the UE Context Release message, the SN can release
    radio and C-plane related resource associated to the UE context. Any
    ongoing data forwarding may continue.

SN initiated SN Release

                                    [pic]

            Figure 10.4.2-2: SN release procedure - SN initiated

Figure 10.4.2-2 shows an example signalling flow for the SN initiated SN
Release procedure.

  1. The SN initiates the procedure by sending the SN Release Required
    message which does not contain any inter-node message.

  2. If data forwarding is requested, the MN provides data forwarding
    addresses to the SN in the SN Release Confirm message. The SN may start
    data forwarding and stop providing user data to the UE as early as it
    receives the SN Release Confirm message.

  3/4. If required, the MN indicates in the MN RRC reconfiguration message
    towards the UE that the UE shall release the entire SCG configuration.
    In case the UE is unable to comply with (part of) the configuration
    included in the MN RRC reconfiguration message, it performs the
    reconfiguration failure procedure.

  NOTE 2:  If data forwarding is applied, timely coordination between steps
         2 and 3 may minimize gaps in service provision. This is however
         regarded to be an implementation matter.

  5. If the released bearers use RLC AM, the SN sends the SN Status
    transfer.

  6. Data forwarding from the SN to the MN takes place.

  7. If applicable, the PDU Session path update procedure is initiated.

  8. Upon reception of the UE Context Release message, the SN can release
    radio and C-plane related resource associated to the UE context. Any
    ongoing data forwarding may continue.


10.5 Secondary Node Change (MN/SN initiated)


10.5.1 EN-DC

The Secondary Node Change procedure is initiated either by MN or SN and
used to transfer a UE context from a source SN to a target SN and to change
the SCG configuration in UE from one SN to another.

  NOTE 1:  Inter-RAT SN change procedure with single RRC reconfiguration is
         not supported in this version of the protocol (i.e. no transition
         from EN-DC to DC).

The Secondary Node Change procedure always involves signalling over MCG SRB
towards the UE.

MN initiated SN Change

                                    [pic]

                  Figure 10.5.1-1: SN Change – MN initiated

Figure 10.5.1-1 shows an example signalling flow for the MN initiated
Secondary Node Change:

  1/2. The MN initiates the SN change by requesting the target SN to
    allocate resources for the UE by means of the SgNB Addition procedure.
    The MN may include measurement results related to the target SN. If
    forwarding is needed, the target SN provides forwarding addresses to
    the MN. The target SN includes the indication of the full or delta RRC
    configuration.

  NOTE 2:  The MN may send the SgNB Modification Request message (to the
         source SN) to request the current SCG configuration before step 1.

  3. If the allocation of target SN resources was successful, the MN
    initiates the release of the source SN resources including a Cause
    indicating SCG mobility. The Source SN may reject the release. If data
    forwarding is needed the MN provides data forwarding addresses to the
    source SN. Reception of the SgNB Release Request message triggers the
    source SN to stop providing user data to the UE and, if applicable, to
    start data forwarding.

  4/5. The MN triggers the UE to apply the new configuration. The MN
    indicates to the UE the new configuration in the
    RRCConnectionReconfiguration message including the NR RRC configuration
    message generated by the target SN. The UE applies the new
    configuration and sends the RRCConnectionReconfigurationComplete
    message, including the encoded NR RRC response message for the target
    SN, if needed. In case the UE is unable to comply with (part of) the
    configuration included in the RRCConnectionReconfiguration message, it
    performs the reconfiguration failure procedure.

  6. If the RRC connection reconfiguration procedure was successful, the MN
    informs the target SN via SgNBReconfigurationComplete message with the
    encoded NR RRC response message for the target SN, if received from the
    UE.

  7. If configured with bearers requiring SCG radio resources, the UE
    synchronizes to the target SN.

  8. For SN terminated bearers using RLC AM, the source SN sends the SN
    Status transfer, which the MN sends then to the target SN.

  9. If applicable, data forwarding from the source SN takes place. It may
    be initiated as early as the source SN receives the SgNB Release
    Request message from the MN.

  10.  The source SN sends the Secondary RAT Data Volume Report message to
    the MN and includes the data volumes delivered to the UE over the NR
    radio for the related E-RABs.

  NOTE 3:  The order the SN sends the Secondary RAT Data Volume Report
         message and performs data forwarding with MN is not defined. The SN
         may send the report when the transmission of the related bearer is
         stopped.

  11-15. If one of the bearer was terminatedat the source SN, path update
    is triggered by the MN.

  16.  Upon reception of the UE Context Release message, the source SN can
    release radio and C-plane related resource associated to the UE
    context. Any ongoing data forwarding may continue.

SN initiated SN Change

                                    [pic]

                  Figure 10.5.1-2: SN Change – SN initiated

Figure 10.5.1-2 shows an example signalling flow for the Secondary Node
Change initiated by the SN:

  1. The source SN initiates the SN change procedure by sending SgNB Change
    Required message which contains target SN ID information and may
    include the SCG configuration (to support delta configuration) and
    measurement results related to the target SN.

  2/3. The MN requests the target SN to allocate resources for the UE by
    means of the SgNB Addition procedure, including the measurement results
    related to the target SN received from the source SN. If forwarding is
    needed, the target SN provides forwarding addresses to the MN. The
    target SN includes the indication of the full or delta RRC
    configuration.

  4/5. The MN triggers the UE to apply the new configuration. The MN
    indicates the new configuration to the UE in the
    RRCConnectionReconfiguration message including the NR RRC configuration
    message generated by the target SN. The UE applies the new
    configuration and sends the RRCConnectionReconfigurationComplete
    message, including the encoded NR RRC response message for the target
    SN, if needed. In case the UE is unable to comply with (part of) the
    configuration included in the RRCConnectionReconfiguration message, it
    performs the reconfiguration failure procedure.

  6. If the allocation of target SN resources was successful, the MN
    confirms the release of the source SN resources. If data forwarding is
    needed the MN provides data forwarding addresses to the source SN.
    Reception of the SgNB Change Confirm message triggers the source SN to
    stop providing user data to the UE and, if applicable, to start data
    forwarding.

  7. If the RRC connection reconfiguration procedure was successful, the MN
    informs the target SN via SgNB Reconfiguration Complete message with
    the encoded NR RRC response message for the target SN, if received from
    the UE.

  8. The UE synchronizes to the target SN.

  9. For SN terminated bearers using RLC AM, the source SN sends the SN
    Status transfer, which the MN sends then to the target SN.

  10.  If applicable, data forwarding from the source SN takes place. It
    may be initiated as early as the source SN receives the SgNB Change
    Confirm message from the MN.

  11.  The source SN sends the Secondary RAT Data Volume Report message to
    the MN and includes the data volumes delivered to the UE over the NR
    radio for the related E-RABs.

  NOTE 4:  The order the source SN sends the Secondary RAT Data Volume
         Report message and performs data forwarding with MN/target SN is
         not defined. The SgNB may send the report when the transmission of
         the related bearer is stopped.

  12-16. If one of the bearer was terminated at the source SN, path update
    is triggered by the MN.

  17.  Upon reception of the UE Context Release message, the source SN can
    release radio and C-plane related resource associated to the UE
    context. Any ongoing data forwarding may continue.


10.5.2 MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

MN initiated SN Change

The MN initiated SN change procedure is used to transfer a UE context from
the source SN to a target SN and to change the SCG configuration in UE from
one SN to another.

The Secondary Node Change procedure always involves signalling over MCG SRB
towards the UE.

                                    [pic]

             Figure 10.5.2-1: SN change procedure - MN initiated

Figure 10.5.2-1 shows an example signalling flow for the SN Change
initiated by the MN:

  1/2. The MN initiates the SN change by requesting the target SN to
    allocate resources for the UE by means of the SN Addition procedure.
    The MN may include measurement results related to the target SN. If
    data forwarding is needed, the target SN provides data forwarding
    addresses to the MN. The target SN includes the indication of the full
    or delta RRC configuration.

  NOTE:  The MN may send the SN Modification Request message (to the source
         SN) to request the current SCG configuration before step 1.

  3. If the allocation of target SN resources was successful, the MN
    initiates the release of the source SN resources including a Cause
    indicating SCG mobility. The Source SN may reject the release. If data
    forwarding is needed the MN provides data forwarding addresses to the
    source SN. Reception of the SN Release Request message triggers the
    source SN to stop providing user data to the UE and, if applicable, to
    start data forwarding.

  4/5. The MN triggers the UE to apply the new configuration. The MN
    indicates the new configuration to the UE in the MN RRC reconfiguration
    message including the target SN RRC configuration message. The UE
    applies the new configuration and sends the MN RRC reconfiguration
    complete message, including the encoded SN RRC response message for the
    target SN, if needed. In case the UE is unable to comply with (part of)
    the configuration included in the MN RRC reconfiguration message, it
    performs the reconfiguration failure procedure.

  6. If the RRC connection reconfiguration procedure was successful, the MN
    informs the target SN via SN Reconfiguration Complete message with the
    encoded SN RRC response message for the target SN, if received from the
    UE.

  7. If configured with bearers requiring SCG radio resources the UE
    synchronizes to the target SN.

  8. For SN terminated bearers using RLC AM, the source SN sends the SN
    Status transfer, which the MN sends then to the target SN.

  9. If applicable, data forwarding from the source SN takes place. It may
    be initiated as early as the source SN receives the SN Release Request
    message from the MN.

  10-14. If one of the PDU session/QoS Flow was terminated at the source
    SN, path update procedure is triggered by the MN.

  15.  Upon reception of the UE Context Release message, the source SN can
    release radio and C-plane related resource associated to the UE
    context. Any ongoing data forwarding may continue

SN initiated SN Change

The SN initiated SN change procedure is used to transfer a UE context from
the source SN to a target SN and to change the SCG configuration in UE from
one SN to another.

                                    [pic]

             Figure 10.5.2-2: SN change procedure - SN initiated

Figure 10.5.2-2 shows an example signalling flow for the SN Change
initiated by the SN:

  1. The source SN initiates the SN change procedure by sending the SN
    Change Required message, which contains a candidate target node ID and
    may include the SCG configuration (to support delta configuration) and
    measurement results related to the target SN.

  2/3. The MN requests the target SN to allocate resources for the UE by
    means of the SN Addition procedure, including the measurement results
    related to the target SN received from the source SN. If data
    forwarding is needed, the target SN provides data forwarding addresses
    to the MN. The target SN includes the indication of the full or delta
    RRC configuration.

  4/5. The MN triggers the UE to apply the new configuration. The MN
    indicates the new configuration to the UE in the MN RRC reconfiguration
    message including the SN RRC configuration message generated by the
    target SN. The UE applies the new configuration and sends the MN RRC
    reconfiguration complete message, including the encoded SN RRC response
    message for the target SN, if needed. In case the UE is unable to
    comply with (part of) the configuration included in the MN RRC
    reconfiguration message, it performs the reconfiguration failure
    procedure.

  6. If the allocation of target SN resources was successful, the MN
    confirms the change of the source SN. If data forwarding is needed the
    MN provides data forwarding addresses to the source SN. Reception of
    the SN Change Confirm message triggers the source SN to stop providing
    user data to the UE and, if applicable, to start data forwarding.

  7. If the RRC connection reconfiguration procedure was successful, the MN
    informs the target SN via SN Reconfiguration Complete message with the
    encoded SN RRC response message for the target SN, if received from the
    UE.

  8. The UE synchronizes to the target SN.

  9. For SN terminated bearers using RLC AM, the source SN sends the SN
    Status transfer, which the MN sends then to the target SN.

  10.  If applicable, data forwarding from the source SN takes place. It
    may be initiated as early as the source SN receives the SN Change
    Confirm message from the MN.

  11-15. If one of the PDU session/QoS Flow was terminated at the source
    SN, path update procedure is triggered by the MN.

  16.  Upon reception of the UE Context Release message, the source SN can
    release radio and C-plane related resource associated to the UE
    context. Any ongoing data forwarding may continue.


10.6 PSCell change

In MR-DC, a PSCell change does not always require a security key change.

If a security key change is required, this is performed through a
synchronous SCG reconfiguration procedure towards the UE involving random
access on PSCell and a security key change, during which the MAC entity
configured for SCG is reset and RLC configured for SCG is re-established
regardless of the bearer type(s) established on SCG. For SN terminated
bearers, PDCP is re-established. In EN-DC, to perform this procedure within
the same SN, the SN Modification procedure as described in section 10.3 is
used, setting the PDCP Change Indication to indicate that a S-KgNB update
is required when the procedure is initiated by the SN or including the SgNB
Security Key when the procedure is initiated by the MN.

If a security key change is not required, this is performed through a
synchronous SCG reconfiguration procedure without security key change
towards the UE involving random access on PSCell, during which the MAC
entity configured for SCG is reset and RLC configured for SCG is re-
established regardless of the bearer type(s) established on SCG. for
bearers using RLC AM mode PDCP data recovery applies, for bearers using RLC
UM no action is performed in PDCP while for SRBs PDCP discards all stored
SDUs and PDUs. In EN-DC, unless MN terminated SCG or split bearers are
configured, this does not require MN involvement. In case of MN terminated
SCG or split bearers, the SN initiated SN Modification procedure as
described in section 10.3 is used, setting the PDCP Change Indication to
indicate that a PDCP data recovery is required.


10.7 Inter-Master Node handover with/without Secondary Node change


10.7.1 EN-DC


Inter-Master Node handover with/without MN initiated Secondary Node change
is used to transfer context data from a source MN to a target MN while the
context at the SN is kept or moved to another SN. During an Inter-Master
Node handover, the target MN decides whether to keep or change the SN (or
release the SN, as described in section 10.8).


  NOTE 1:  Inter-RAT Inter-Master node handover with/without SN change is
         not supported in this version of the protocol (i.e. no transition
         from EN-DC to NR-NR DC).


                                    [pic]


   Figure 10.7.1-1: Inter-MN handover with/without MN initiated SN change


Figure 10.7.1-1 shows an example signaling flow for inter-Master Node
handover with or without MN initiated Secondary Node change:

  NOTE 2:  For an inter-Master Node handover without Secondary Node change,
         the source SN and the target SN shown in Figure 10.7.1-1 are the
         same node.

  1. The source MN starts the handover procedure by initiating the X2
    Handover Preparation procedure including both MCG and SCG
    configuration. The source MN includes the (source) SN UE X2AP ID, SN ID
    and the UE context in the (source) SN in the Handover Request message.

  NOTE 3:  The source MN may send the SgNB Modification Request message (to
         the source SN) to request the current SCG configuration before step
         1.

  2. If the target MN decides to keep the SN, the target MN sends SN
    Addition Request to the SN including the SN UE X2AP ID as a reference
    to the UE context in the SN that was established by the source MN. If
    the target MN decides to change the SN, the target MN sends the SgNB
    Addition Request to the target SN including the UE context in the
    source SN that was established by the source MN.

  3. The (target) SN replies with SN Addition Request Acknowledge.

  4. The target MN includes within the Handover Request Acknowledge message
    a transparent container to be sent to the UE as an RRC message to
    perform the handover, and may also provide forwarding addresses to the
    source MN. The target MN indicates to the source MN that the UE context
    in the SN is kept if the target MN and the SN decided to keep the UE
    context in the SN in step 2 and step 3.

  5. The source MN sends SN Release Request to the (source) SN including a
    Cause indicating MCG mobility. The (source) SN acknowledges the release
    request. The source MN indicates to the (source) SN that the UE context
    in SN is kept, if it receives the indication from the target MN. If the
    indication as the UE context kept in SN is included, the SN keeps the
    UE context.

  6. The source MN triggers the UE to apply the new configuration.

  7/8. The UE synchronizes to the target MN and replies with
    RRCConnectionReconfigurationComplete message.

  9. If configured with bearers requiring SCG radio resources, the UE
    synchronizes to the (target) SN.

  10.  If the RRC connection reconfiguration procedure was successful, the
    target MN informs the (target) SN via SgNB Reconfiguration Complete
    message.

  11a. The SN sends the Secondary RAT Data Volume Report message to the
    source MN and includes the data volumes delivered to the UE over the NR
    radio for the related E-RABs.

  NOTE 4:  The order the source SN sends the Secondary RAT Data Volume
         Report message and performs data forwarding with MN/target SN is
         not defined. The SgNB may send the report when the transmission of
         the related bearer is stopped.

  11b. The source MN sends the Secondary RAT Report message to MME to
    provide information on the used NR resource.

  12.  For bearers using RLC AM, the source MN sends the SN Status transfer
    to the target MN.

  13.  Data forwarding from the source MN takes place. If the SN is kept,
    data forwarding may be omitted for SCG bearers and SCG split bearers.

  14-17. The target MN initiates the S1 Path Switch procedure.

  NOTE 5:  If new UL TEIDs of the S-GW are included, the target MN performs
         MN initiated SN Modification procedure to provide them to the SN.

  18.  The target MN initiates the UE Context Release procedure towards the
    source MN.

  19.  Upon reception of the UE Context Release message, the (source) SN
    can release C-plane related resource associated to the UE context
    towards the source MN. Any ongoing data forwarding may continue. The SN
    shall not release the UE context associated with the target MN if the
    indication was included in the SN Release Request in step 5.


10.7.2 MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.


Inter-MN handover with/without MN initiated SN change is used to transfer
UE context data from a source MN to a target MN while the UE context at the
SN is kept or moved to another SN. During an Inter-Master Node handover,
the target MN decides whether to keep or change the SN (or release the SN,
as described in section 10.8).


                                    [pic]


   Figure 10.7.2-1: Inter-MN handover with/without MN initiated SN change
                                  procedure


Figure 10.7.2-1 shows an example signalling flow for inter-MN handover with
or without MN initiated SN change:

  NOTE 1:  For an inter-Master Node handover without Secondary Node change,
         the source SN and the target SN shown in Figure 10.7.2-1 are the
         same node.

  1. The source MN starts the handover procedure by initiating the Xn
    Handover Preparation procedure including both MCG and SCG
    configuration. The source MN includes the source SN UE XnAP ID, SN ID
    and the UE context in the source SN in the Handover Request message.

  NOTE 2:  The source MN may send the SN Modification Request message (to
         the source SN) to request the current SCG configuration before step
         1.

  2. If the target MN decides to keep the source SN, the target MN sends SN
    Addition Request to the SN including the SN UE XnAP ID as a reference
    to the UE context in the SN that was established by the source MN. If
    the target MN decides to change the SN, the target MN sends the SN
    Addition Request to the target SN including the UE context in the
    source SN that was established by the source MN.

  3. The (target) SN replies with SN Addition Request Acknowledge.

  4. The target MN includes within the Handover Request Acknowledge message
    a transparent container to be sent to the UE as an RRC message to
    perform the handover, and may also provide forwarding addresses to the
    source MN. The target MN indicates to the source MN that the UE context
    in the SN is kept if the target MN and the SN decided to keep the UE
    context in the SN in step 2 and step 3.

  5. The source MN sends SN Release Request message to the (source) SN
    including a Cause indicating MCG mobility. The (source) SN acknowledges
    the release request. The source MN indicates to the (source) SN that
    the UE context in SN is kept, if it receives the indication from the
    target MN. If the indication as the UE context kept in SN is included,
    the SN keeps the UE context.

  6. The source MN triggers the UE to perform handover and apply the new
    configuration.

  7/8. The UE synchronizes to the target MN and replies with MN RRC
    reconfiguration complete message.

  9. If configured with bearers requiring SCG radio resources, the UE
    synchronizes to the (target) SN.

  10.  If the RRC connection reconfiguration procedure was successful, the
    target MN informs the (target) SN via SN Reconfiguration Complete
    message.

  11.  For bearers using RLC AM, the source MN sends the SN Status transfer
    to the target MN.

  12.  Data forwarding from the source MN takes place. If the SN is kept,
    data forwarding may be omitted for SCG bearers and SCG split bearers.

  13-16. The target MN initiates the PDU Session Path Switch procedure.

  NOTE 3:  If new UL TEIDs of the UPF for SN are included, the target MN
         performs MN initiated SN Modification procedure to provide them to
         the SN.

  17.  The target MN initiates the UE Context Release procedure towards the
    source MN.

  18.  Upon reception of the UE Context Release message from source MN, the
    (source) SN can release C-plane related resource associated to the UE
    context towards the source MN. Any ongoing data forwarding may
    continue. The SN shall not release the UE context associated with the
    target MN if the indication was included in the SN Release Request
    message in step 5.


10.8 Master Node to eNB/gNB Change


10.8.1 EN-DC

The Master Node to eNB Change procedure is used to transfer context data
from a source MN/SN to a target eNB.

                                    [pic]

            Figure 10.8.1-1: Master Node to eNB Change procedure

Figure 10.8.1-1 shows an example signalling flow for the Master Node to eNB
Change procedure:

  1. The source MN starts the MN to eNB Change procedure by initiating the
    X2 Handover Preparation procedure, including both MCG and SCG
    configuration.

  NOTE 1:  The source MN may send the SgNB Modification Request message (to
         the source SN) to request the current SCG configuration before step
         1.

  2. The target eNB includes the field in HO command which releases SCG
    configuration, and may also provide forwarding addresses to the source
    MN.

  3. If the allocation of target eNB resources was successful, the MN
    initiates the release of the source SN resources towards the source SN
    including a Cause indicating MCG mobility. The SN acknowledges the
    release request. If data forwarding is needed, the MN provides data
    forwarding addresses to the source SN. Reception of the SgNB Release
    Request message triggers the source SN to stop providing user data to
    the UE and, if applicable, to start data forwarding.

  4. The MN triggers the UE to apply the new configuration. Upon receiving
    the new configuration, the UE releases the entire SCG configuration.

  5/6. The UE synchronizes to the target eNB.

  7. For SN terminated bearers using RLC AM, the SN sends the SN Status
    transfer, which the source MN sends then to the target eNB.

  8. If applicable, data forwarding from the source SN takes place. It may
    start as early as the source SN receives the SgNB Release Request
    message from the MN.

  9a.  The source SN sends the Secondary RAT Data Volume Report message to
    the source MN and includes the data volumes delivered to the UE over
    the NR radio for the related E-RABs.

  NOTE 2:  The order the SN sends the Secondary RAT Data Volume Report
         message and performs data forwarding with MN is not defined. The SN
         may send the report when the transmission of the related bearer is
         stopped.

  9b.  The source MN sends the Secondary RAT Report message to MME to
    provide information on the used NR resource.

  10-14. The target eNB initiates the S1 Path Switch procedure.

  15.  The target eNB initiates the UE Context Release procedure towards
    the source MN.

  16.  Upon reception of the UE CONTEXT RELEASE message, the S-SN can
    release radio and C-plane related resource associated to the UE
    context. Any ongoing data forwarding may continue.


10.8.2 MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

The MN to ng-eNB/gNB Change procedure is used to transfer UE context data
from a source MN/SN to a target ng-eNB/gNB.

                                    [pic]

             Figure 10.8.2-1: MN to ng-eNB/gNB Change procedure

Figure 10.8.2-1 shows an example signalling flow for the MN to ng-eNB/gNB
Change procedure:

  1. The source MN starts the MN to ng-eNB/gNB Change procedure by
    initiating the Xn Handover Preparation procedure, including both MCG
    and SCG configuration.

  NOTE:  The source MN may send the SN Modification Request message (to the
         source SN) to request the current SCG configuration before step 1.

  2. The target ng-eNB/gNB includes the field in HO command which releases
    the SCG configuration, and may also provide forwarding addresses to the
    source MN.

  3. If the resource allocation of target ng-eNB/gNB was successful, the MN
    initiates the release of the source SN resources towards the source SN
    including a Cause indicating MCG mobility. The SN acknowledges the
    release request. If data forwarding is needed, the MN provides data
    forwarding addresses to the source SN. Reception of the SN Release
    Request message triggers the source SN to stop providing user data to
    the UE and, if applicable, to start data forwarding.

  4. The MN triggers the UE to perform HO and apply the new configuration.
    Upon receiving the new configuration, the UE releases the entire SCG
    configuration.

  5/6. The UE synchronizes to the target ng-eNB/gNB.

  7. For SN terminated bearers using RLC AM, the SN sends the SN Status
    transfer, which the source MN sends then to the target ng-eNB/gNB.

  8. If applicable, data forwarding from the source SN takes place. It may
    start as early as the source SN receives the SN Release Request message
    from the MN.

  9-13.  The target ng-eNB/gNB initiates the PDU Session Path Switch
    procedure.

  14.  The target ng-eNB/gNB initiates the UE Context Release procedure
    towards the source MN.

  15.  Upon reception of the UE Context Release message from MN, the source
    SN can release radio and C-plane related resource associated to the UE
    context. Any ongoing data forwarding may continue.


10.9 eNB/gNB to Master Node change


10.9.1 EN-DC

The eNB to Master Node change procedure is used to transfer context data
from a source eNB to a target MN that adds an SN during the handover.

                                    [pic]

                 Figure 10.9.1-1: eNB to Master Node change

Figure 10.9.1-1 shows an example signaling flow for eNB to Master Node
change:

  1. The source eNB starts the handover procedure by initiating the X2
    Handover Preparation procedure.

  2. The target MN sends SgNB Addition Request to the target SN.

  3. The target SN replies with SgNB Addition Request Acknowledge. If data
    forwarding is needed, the target SN provides forwarding addresses to
    the target MN.

  4. The target MN includes within the Handover Request Acknowledge message
    a transparent container to be sent to the UE as an E-UTRA RRC message,
    including a NR RRC configuration message which also includes the SCG
    configuration, to perform the handover, and may also provide forwarding
    addresses to the source eNB.

  5. The source eNB triggers the UE to apply the new configuration.

  6/7. The UE synchronizes to the target MN and replies with
    RRCConnectionReconfigurationComplete message.

  8. The UE synchronizes to the target SN

  9. If the RRC connection reconfiguration procedure was successful, the
    target MN informs the target SN.

  10.  For bearers using RLC AM, the source eNB sends the SN Status
    transfer to the target MN.

  11.  Data forwarding from the source eNB takes place.

  12-15. The target MN initiates the S1 Path Switch procedure.

  NOTE:  If new UL TEIDs of the S-GW are included, the target MN performs
         MN initiated SN Modification procedure to provide them to the
         target SN.

  16.  The target MN initiates the UE Context Release procedure towards the
    source eNB.


10.9.2 MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

The ng-eNB/gNB to MN change procedure is used to transfer UE context data
from a source ng-eNB/gNB to a target MN that adds an SN during the
handover.

                                    [pic]

             Figure 10.9.2-1: ng-eNB/gNB to MN change procedure

Figure 10.9.2-1 shows an example signalling flow for ng-eNB/gNB to MN
change:

  1. The source ng-eNB/gNB starts the handover procedure by initiating the
    Xn Handover Preparation procedure.

  2. The target MN sends SN Addition Request to the target SN.

  3. The target SN replies with SN Addition Request Acknowledge. If data
    forwarding is needed, the target SN provides forwarding addresses to
    the target MN.

  4. The target MN includes within the Handover Request Acknowledge message
    a transparent container to be sent to the UE as an MN RRC message
    including a SN RRC configuration message which also includes the SCG
    configuration, to perform the handover, and may also provide forwarding
    addresses to the source ng-eNB/gNB.

  5. The source ng-eNB/gNB triggers the UE to perform handover and apply
    the new configuration.

  6/7. The UE synchronizes to the target MN and replies with MN RRC
    reconfiguration complete message.

  8. The UE synchronizes to the target SN .

  9. If the RRC connection reconfiguration procedure was successful, the
    target MN informs the target SN via SN Reconfiguration Complete
    message.

  10.  For bearers using RLC AM, the source ng-eNB/gNB sends the SN Status
    transfer to the target MN.

  11.  Data forwarding from the source ng-eNB/gNB takes place.

  12-15. The target MN initiates the PDU Session Path Switch procedure.

  NOTE:  If new UL TEIDs of the UPF are included, the target MN performs MN
         initiated SN Modification procedure to provide them to the target
         SN.

  16.  The target MN initiates the UE Context Release procedure towards the
    source ng-eNb/gNB.


10.10  RRC Transfer


10.10.1  EN-DC

The RRC Transfer procedure is used to exchange RRC messages between the MN
and the UE via the SN (split SRB) and to provide NR measurement reports
from the UE to the SN.

Split SRB:

                                    [pic]

    Figure 10.10.1-1: RRC Transfer procedure for split SRB (DL operation)

Figure 10.10.1-1 shows an example signaling flow for DL RRC Transfer in
case of the split SRB:

  1. The MN, when it decides to use the split SRBs, starts the procedure by
    initiating the RRC Transfer procedure. The MN encapsulates the RRC
    message in a PDCP-C PDU and ciphers with own keys.

  NOTE:  The usage of the split SRBs shall be indicated in the Secondary
         Node Addition procedure.

  2. The SN forwards the RRC message to the UE.

  3. The SN may send PDCP delivery acknowledgement of the RRC message
    forwarded in step 2.

                                    [pic]

    Figure 10.10.1-2: RRC Transfer procedure for split SRB (UL operation)

Figure 10.10.1-2 shows an example signaling flow for UL RRC Transfer in
case of the split SRB:

  1. When the UE provides response to the RRC message, it sends it to the
    SN.

  2. The SN initiates the RRC Transfer procedure, in which it transfers the
    received PDCP-C PDU with encapsulated RRC message.

NR measurement report:

                                    [pic]

     Figure 10.10.1-3: RRC Transfer procedure for NR measurement report

Figure 10.10.1-3 shows an example signaling flow for RRC Transfer in case
of the forwarding of the NR measurement report from the UE:

  1. When the UE sends a measurement report, it sends it to the MN in the
    GenericContainer.

  2. The MN initiates the RRC Transfer procedure, in which it transfers the
    received NR measurement report as an octet string.


10.10.2  MR-DC with 5GC

Editor's note: MR-DC with the 5GC is not complete and is targeted for
completion in December 2018.

The RRC Transfer procedure is used to exchange RRC messages between the MN
and the UE via the SN (split SRB) and to provide NR measurement reports
from the UE to the SN.

Split SRB:



                                    [pic]

    Figure 10.10.2-1: RRC Transfer procedure for split SRB (DL operation)

Figure 10.10.2-1 shows an example signaling flow for DL RRC Transfer in
case of the split SRB:

  1. The MN, when it decides to use the split SRBs, starts the procedure by
    initiating the RRC Transfer procedure. The MN encapsulates the RRC
    message in a PDCP-C PDU and ciphers with own keys.

  NOTE:  The usage of the split SRBs shall be indicated in the Secondary
         Node Addition procedure.

  2. The SN forwards the RRC message to the UE.

  3. The SN may send PDCP delivery acknowledgement of the RRC message
    forwarded in step 2.

                                    [pic]

    Figure 10.10.2-2: RRC Transfer procedure for split SRB (UL operation)

Figure 10.10.2-2 shows an example signaling flow for UL RRC Transfer in
case of the split SRB:

  1. When the UE provides response to the RRC message, it sends it to the
    SN.

  2. The SN initiates the RRC Transfer procedure, in which it transfers the
    received PDCP-C PDU with encapsulated RRC message.

NR measurement report:

                                    [pic]

     Figure 10.10.2-3: RRC Transfer procedure for NR measurement report

Figure 10.10.2-3 shows an example signaling flow for RRC Transfer in case
of the forwarding of the NR measurement report from the UE:

  1. When the UE sends a measurement report, it sends it to the MN in the
    GenericContainer.

  2. The MN initiates the RRC Transfer procedure, in which it transfers the
    received NR measurement report as an octet string.


10.11  Secondary RAT data volume reporting


10.11.1  EN-DC

The secondary RAT data volume reporting function is used to report the data
volume of secondary RAT to CN. In EN-DC, if configured, the MN reports the
uplink and downlink data volumes of SN to the EPC on a per EPS bearer basis
as specified in TS 36.300 [2]. Periodic reporting is performed
by periodically sending the Secondary RAT Data Volume Report messages from
a SN to a MN, and then to a MME.

                                    [pic]

       Figure 10.11.1-1: Secondary RAT data volume periodic reporting

Figure 10.11.1-1 shows an example signalling flow for secondary RAT data
volume periodic reporting:

  1. If the periodic reporting is configured, then the SN periodically
    sends the Secondary RAT Data Volume Report message to the MN and
    includes the data volumes delivered to the UE over the NR radio for the
    related E-RABs.

  2. The MN sends the Secondary RAT Report message to MME to provide
    information on the used NR resource.


10.12  Activity Notification


10.12.1  EN-DC

The Activity Notification function is used to report user plane activity
within SN resources. It can either report inactivity or resumption of
activity after inactivity was reported. In EN-DC the Activity Reporting is
provided from the SN only. The MN may take further actions.

                                    [pic]

         Figure 10.12.1-1: Support of Activity Notification in EN-DC

Support of Activity Notification in EN-DC is used to keep the MN informed
about user traffic activity in resources owned by the SN. The MN may take
appropriate action upon receiving such notification.

  1. The SN informs the MN about user data inactivity of resources owned by
    the SN.

  2. The MN decides to keep SN resources.

  3. After a while the SN reports resumption of user plane activitiy.


11 Service related aspects


11.1 Roaming and Access Restrictions

The principles for conveying roaming and access restriction info for EN-DC
are described in TS 36.300 [2].

For MR-DC with 5GC, SCG (re)selection at the SN is based on roaming and
access restriction information in SN. If roaming and access restriction
information is not available at the SN, the SN shall consider that there is
no restriction for SCG (re)selection. Therefore, MN needs to convey the up-
to-date roaming and access restriction information to SN via XnAP messages.


12 X2/Xn Interface related aspects

Stage 2 specification for X2-C procedures for EN-DC is contained in TS
36.300 [2].

Xn-C procedures for MR-DC with 5GC are specified in TS 38.423 [5].

X2-U procedures for EN-DC and Xn-U procedures for MR-DC with 5GC are
specified in TS 38.425 [6].



Annex A (informative):
Layer 2 handling for bearer type change

This subclause provides for information an overview on L2 handling for
bearer type change in EN-DC, with and without security key change (from
KeNB to S-KgNB and from S-KgNB to KeNB), i.e. with and without a change of
the termination point.

 Table A-1: L2 handling for bearer type change with and without security key
                                   change

|Bearer|MCG                  |Split                |SCG                    |
|type  |                     |                     |                       |
|change|                     |                     |                       |
|from  |                     |                     |                       |
|row   |                     |                     |                       |
|to col|                     |                     |                       |
|      |no key    |with key  |no key    |with key  |no key     |with key   |
|      |change    |change    |change    |change    |change     |change     |
|      |          |(KeNB <-> |          |(KeNB <-> |           |(KeNB <->  |
|      |          |S-KgNB)   |          |S-KgNB)   |           |S-KgNB)    |
|MCG   |N/A       |PDCP:     |PDCP:     |PDCP:     |PDCP:      |PDCP:      |
|      |          |Re-establi|Reconfigur|Re-establi|Recovery   |Re-establis|
|      |          |sh        |e         |sh        |MCG RLC:   |h          |
|      |          |MCG RLC:  |MCG RLC:  |MCG RLC:  |Re-est+rele|MCG RLC:   |
|      |          |Re-establi|No action |Re-establi|ase        |Re-est+rele|
|      |          |sh        |MCG MAC:  |sh        |MCG MAC:   |ase        |
|      |          |MCG MAC:  |No action |MCG MAC:  |Reconfigure|MCG MAC:   |
|      |          |See Note  |SCG RLC:  |See Note  |SCG RLC:   |Reconfigure|
|      |          |SCG RLC:  |Establish |SCG RLC:  |Establish  |SCG RLC:   |
|      |          |No action |SCG MAC:  |Establish |SCG MAC:   |Establish  |
|      |          |SCG MAC:  |Reconfigur|SCG MAC:  |Reconfigure|SCG MAC:   |
|      |          |No action |e         |Reconfigur|           |Reconfigure|
|      |          |          |          |e         |           |           |
|Split |PDCP:     |PDCP:     |N/A       |PDCP:     |PDCP:      |PDCP:      |
|      |Recovery  |Re-establi|          |Re-establi|Recovery   |Re-establis|
|      |MCG RLC:  |sh        |          |sh        |MCG RLC:   |h          |
|      |No action |MCG RLC:  |          |MCG RLC:  |Re-est+rele|MCG RLC:   |
|      |MCG MAC:  |Re-establi|          |Re-establi|ase        |Re-est+rele|
|      |No action |sh        |          |sh        |MCG MAC:   |ase        |
|      |SCG RLC:  |MCG MAC:  |          |MCG MAC:  |Reconfigure|MCG MAC:   |
|      |Release   |See Note  |          |See Note  |SCG RLC:   |Reconfigure|
|      |SCG MAC:  |SCG RLC:  |          |SCG RLC:  |No action  |SCG RLC:   |
|      |Reconfigur|Release   |          |Re-establi|SCG MAC:   |Re-establis|
|      |e         |SCG MAC:  |          |sh        |No action  |h          |
|      |          |Reconfigur|          |SCG MAC:  |           |SCG MAC:   |
|      |          |e         |          |See Note  |           |See Note   |
|SCG   |PDCP:     |PDCP:     |PDCP:     |PDCP:     |N/A        |PDCP:      |
|      |Recovery  |Re-establi|Reconfigur|Re-establi|           |Re-establis|
|      |MCG RLC:  |sh        |e         |sh        |           |h          |
|      |Establish |MCG RLC:  |MCG RLC:  |MCG RLC:  |           |MCG RLC:   |
|      |MCG MAC:  |Establish |Establish |Establish |           |No action  |
|      |Reconfigur|MCG MAC:  |MCG MAC:  |MCG MAC:  |           |MCG MAC:   |
|      |e         |Reconfigur|Reconfigur|Reconfigur|           |No action  |
|      |SCG RLC:  |e         |e         |e         |           |SCG RLC:   |
|      |Release   |SCG RLC:  |SCG RLC:  |SCG RLC:  |           |Re-establis|
|      |SCG MAC:  |Release   |No action |Re-establi|           |h          |
|      |Reconfigur|SCG MAC:  |SCG MAC:  |sh        |           |SCG MAC:   |
|      |e         |Reconfigur|No action |SCG MAC:  |           |See note   |
|      |          |e         |          |See Note  |           |           |


  NOTE:  MAC behaviour depends on the solution selected by the network,
         e.g. MAC reset, change of LCID, etc.




Annex B (informative):
Change history



|Change history                                                            |


 Date |Meeting |Tdoc |CR |Rev |Cat |Subject/Comment |New version | |2017.04
     |RAN2#97bis |R2-1703828 |- |- |- |Draft Skeleton |0.0.1 | |2017.04
    |RAN2#97bis |R2-1703923 |- |- |- |Endorsed Skeleton |0.0.2 | |2017.05
|RAN2#98 |R2-1704898 |- |- |- |Initial version, including:
Agreements from TR38.912
Agreements from RAN2#97bis on:
- System information handling
- Measurements
- UE capability coordination
- Handling of combined MN/SN RRC messages
- SCG SRB
- MCG split SRB
- SN/MN Failure handling
- QoS aspects
- Bearer type configuration
- Security aspects |0.1.0 | |2017.06 |RAN2 NR AdHoc2 |R2-1706418 |- |- |-
|Agreements from RAN3#96 on:
- Network interfaces
- Initial EN-DC operation related aspects
- UP related aspects
Agreements from RAN2#98 on:
- Measurement coordination
- UE capability coordination
- SCG SRB
     Further RAN2 agreements on EN-DC operation related aspects |0.1.1 |
|2017.06 |RAN2 NR AdHoc2 |R2-1707467 |- |- |- |Endorsed version at RAN2 NR
AH2, also including:
Initial description of procedures for MR-DC with 5GC
 Correction to SN initiated SN change procedure for EN-DC |0.2.0 | |2017.08
|RAN2#99 |R2-1708080 |- |- |- |Agreements from RAN3  NR AH2 on:
- Data forwarding for SCG split bearer
- Path Update procedure
Agreements from RAN2  NR AH2 on:
- Bearer type harmonization / bearer type change
- UE capability coordination
- SRB3 (SCG SRB)
- MCG Split SRB
- SN failure handling
- Security handling
- SN Addition procedure
- MN initiated SN Modification/Release procedures
Miscellaneous corrections |0.2.1 | |2017.08 |RAN2#99 |R2-1709831 |- |- |-
|Endorsed version at RAN2#99 |0.3.0 | |2017.08 |RAN2#99 |R2-1709939 |- |- |-
 |Agreements from RAN2#99 on:
- Bearer type harmonization / bearer type change
- SN failure handling
- Measurement result exchange
- Security aspects
- Embedded RRC transport
- Other MR-DC procedures related aspects
RAN3 endorsed TPs on miscellaneous corrections to MR-DC procedures (in R3-
173187, R3-173380, R3-173381, R3-173384, R3-173386, R3-173388 and R3-
173390), |0.4.0 | |2017.09 |RAN#77 |RP-171872 |- |- |- |Provided for
information to RAN |1.0.0 | |2017.09 |RAN#77 |RP-172036 |- |- |-
  |Correction of some auto-formatting issues |1.0.1 | |2017.09 |RAN2#99bis
|R2-1711526 |- |- |- |Alignment to the agreed terminology for the different
nodes:
- introduction of the en-gNB term
- replacement of MeNB and SgNB with MN and SN
Clarification on UE capabilities coordination
Clarification in Figure 4.2.2-2 that there is one SDAP entity per cell
group |1.0.2 | |2017.10 |RAN2#99bis |R2-1711937 |- |- |- |Endorsed version
at RAN2#99bis |1.1.0 | |2017.10 |RAN2#99bis |R2-1712072 |- |- |-
|Agreements from RAN2#99bis on:
- Bearer type harmonization / bearer type change
- SCG change and Pscell change
- MN/SN measurement coordination
- UE capabilities coordination
- MR-DC procedures related aspects
- Security aspects
Agreed Text Proposals in:
- R2-1711929 TP on SN modification without MN involvement
- R2-1711942 TP on inter-MN HO with SN change
Agreements from RAN3#97bis in R3-174254, collecting changes from:
- R3-174214 Text Proposal for QoS Handling in 5GC DC
- R3-174132 Completion of the RRC tunnelling in MR-DC
- R3-174136 Stage 2 TP on bearer type change without MAC reset
- R3-174221 TP for Supporting MN Initiate SN Change
- R3-174194 UE-AMBR enforcement
- R3-174234 Secondary RAT data volume reporting
 -R3-174160 MN and SN role for QoS flow to DRB mapping
     - R3-174101 Clean-up of 37.340 RAN3 Related Part |1.1.1 | |2017.11
  |RAN2#100 |R2-1712301 |- |- |- |Clean version |1.2.0 | |2017.11 |RAN2#100
|R2-1712302 |- |- |- |MR-DC related agreements moved from TS 38.300:
- on two C-RNTIs independently allocated ot the UE
- on RLF declared separately for the MCG and for the SCG
- on roaming and access restrictions for MR-DC with 5GC
- on SPS and BSR configuration, triggering and reporting
Addition of a note on support of ideal backhaul.
Clarification on use of SRB3.
Clarification on security key handling.
Editorial corrections in various Figures
   Removal of FFSs for MR-DC with 5GC (moved to a separate list)  |1.2.1 |
|2017.12 |RAN2#100 |R2-1714080 |- |- |- |Agreed Text Proposals in:
- R2-1713141 TP on 37.340
- R2-1713838 Bearer type change with PDPC version change
- R2-1714176 PSCell change clarification and SCG Change removal
- R2-1714183 Stage 2 TP to update bearer type description
- R2-1714237 Clarification for the MR-DC QoS framework
- R3-174308 Cleanup of reference/definitions for 37.340
- R3-174565 TP for SCG Change related to Bearer Type Change
- R3-174661 TP for querying SCGconfig for MN to eNB/gNB Change
- R3-174763 TP for a unified 5G User Plane protocol
- R3-174876 Further Clean-up of TS37.340 RAN3 Related Part
- R3-174913 Clarifications on Inter-MN handover with SN change
- R3-174916 Clarification on the interface between gNB for Option 3
- R3-174917 Tunnel ID switching in case of reconfiguration
- R3-174921 Introducing bearer harmonization – RAN3 parts
- R3-174923 On security related IE in MN initiated SN modification
- R3-174928 TP on UE-AMBR for EN-DC
- R3-174930 Stage 2 for secondary RAT data volume reporting
- R3-175009 Removing data forwarding from corresponding node
- R3-175048 Stage 2 TP for bearer type change
- R3-174975 Race conditions in case of SN release Other miscellaneous
agreements from RAN2#100 |1.2.2 | |2017.12 |RAN2#100 |R2-1714251 |- |- |-
|RAN2 agreed version |1.3.0 | |2017.12 |RP-78 |RP-172464 |- |- |- |Provided
for approval to RAN |2.0.0 | |2017/12 |RP-78 | | | | |Upgraded to Rel-15
|15.0.0 | |2018/03 |RP-79 |RP-180440 |0004 |1 |F |Miscellaneous corrections
|15.1.0 | | |RP-79 |RP-180440 |0008 |1 |F |Baseline CR for TS 37.340 (RAN3
   part) covering agreements of RAN3 #NR adhoc 1801 and RAN3 #99 |15.1.0 |
|2018/06 |RP-80 |RP-181214 |0012 |2 |F |Further miscellaneus corrections
|15.2.0 | | |RP-80 |RP-181214 |0014 |1 |F |CR on EN-DC bearer type changes
in TS 37.340 |15.2.0 | | |RP-80 |RP-181214 |0015 |1 |F |CR on EN-DC
reconfiguration procedure via SRB3 in TS 37.340 |15.2.0 | | |RP-80 |RP-
181214 |0017 |- |F |Radio Protocol Architecture figure clarification with
SDAP |15.2.0 | | |RP-80 |RP-181215 |0018 |1 |F |Stage 2 CR on combined
bearer type and termination point change |15.2.0 | | |RP-80 |RP-181215
|0021 |1 |F |Correction to TS 37.340 on PDCP version for SRB |15.2.0 | |
|RP-80 |RP-181215 |0024 |1 |F |L2 handling for bearer type change when PDCP
SN length changed |15.2.0 | | |RP-80 |RP-181215 |0025 |1 |F |Correction on
SN configured NR measurements after SCG failure |15.2.0 | | |RP-80 |RP-
181215 |0026 |1 |F |Clarification of the usage of SN Status Transfer
|15.2.0 | | |RP-80 |RP-181215 |0027 |- |F |Addition of the full config
indicator in SN Change |15.2.0 | | |RP-80 |RP-181216 |0028 |2 |F
|Coordination of Inactivity for EN-DC |15.2.0 | | |RP-80 |RP-181216 |0029 |-
 |F |CR on maintaining the bearer type on wrap-around for TS37.340 |15.2.0
| | |RP-80 |RP-181216 |0030 |2 |F |Enabling re-use of NR PCIs in cells
served by the same SN in EN-DC |15.2.0 | |

